{"version":3,"sources":["service/fetch.js","components lazy /^/.*/src/Main/.js$/ groupOptions: {} namespace object","core/utils.js","core/actions/index.js","Core.js","core/reducers/index.js","AppContext.js","core/components/AppTopbar.js","core/components/AppFooter.js","core/components/AppMenu.js","core/components/AppProfile.js","core/components/stats/ViewerVisitsChart.js","core/components/stats/BasicStats.js","core/components/common/Contact.js","core/components/Dashboard.js","service/DataProvider.js","core/components/account/AccountForm.js","core/components/account/AccountEdit.js","core/components/ModuleManager.js","core/components/notifications/NotificationForm.js","core/components/notifications/NotificationEdit.js","core/components/notifications/NotificationList.js","core/components/common/utils.js","core/components/common/PrintGroupChildsEditor.js","core/components/viewers/ViewerForm.js","core/components/viewers/ViewerEdit.js","core/components/viewers/ViewerList.js","core/components/common/MapWrapper.js","core/components/prints/GeometryFilterEditor.js","core/components/common/FormFieldsEditor.js","core/components/prints/PrintLayoutsEditor.js","core/components/prints/PrintForm.js","core/components/prints/PrintEdit.js","core/components/prints/PrintList.js","core/components/prints/PrintGroupForm.js","core/components/prints/PrintGroupEdit.js","core/components/prints/PrintGroupList.js","core/components/prints/PrintElementForm.js","core/components/prints/PrintElementEdit.js","core/components/prints/PrintElementList.js","core/components/security/UserList.js","core/components/security/UserForm.js","core/components/security/UserEdit.js","core/components/security/RoleList.js","core/components/security/RoleForm.js","core/components/security/RoleEdit.js","core/components/security/GroupList.js","core/components/security/GroupForm.js","core/components/security/GroupEdit.js","core/components/settings/ParameterList.js","core/components/settings/ParameterForm.js","core/components/settings/ParameterEdit.js","core/components/settings/CoordinateSystemList.js","core/components/settings/CoordinateSystemForm.js","core/components/settings/CoordinateSystemEdit.js","core/components/Layout.js","core/containers/Layout.js","core/containers/Backoffice.js","core/components/Page404.js","core/components/Page401.js","core/components/LoginWidget.js","core/components/PageLogin.js","core/components/ScrollToTop.js","core/components/SplashScreen.js","core/components/RGPD.js","core/containers/App.js","index.js"],"names":["HttpError","_Error","_inherits","_super","_createSuper","message","status","_this","_classCallCheck","call","Object","setPrototypeOf","_assertThisInitialized","prototype","name","constructor","Error","captureStackTrace","stack","_createClass","_wrapNativeSuper","fetchJson","url","options","arguments","length","undefined","requestHeaders","headers","Headers","Accept","has","method","body","FormData","set","user","authenticated","token","logged","Cookies","get","process","createHeadersFromOptions","fetch","_objectSpread","then","response","text","statusText","_ref","json","JSON","parse","e","Promise","reject","resolve","stringify","webpackEmptyAsyncContext","req","code","keys","module","exports","id","_getAppRootPath","_window","_window2","window","SCALARGIS_ROOT_PATH","_getAppBaseUrl","_window3","_window4","SCALARGIS_ROOT_PATH_BASE_URL","rememberUrl","cookies","type","cookieName","REACT_APP_COOKIE_PREFIX","urlhistory","indexOf","push","generateRGBA","Math","floor","random","join","removeUrlParam","sourceURL","key","param","rtn","split","params_arr","new_params","queryString","i","RegExp","test","getWindowSize","w","d","document","documentElement","g","getElementsByTagName","innerWidth","clientWidth","innerHeight","clientHeight","isUrlAppOrigin","url1","URL","location","href","url2","origin","isAdminOrManager","auth","_auth$response","data","userroles","map","s","toLowerCase","filter","x","includes","getAppRootPath","getAppBaseUrl","root_path","endsWith","getBackofficeBaseUrl","getAppClientUrl","getAppApiUrl","startsWith","protocol","getAppMapProxyUrl","getAppUploadUrl","getCookieAuthName","AUTH_HTTP_LOADING","AUTH_HTTP_ERROR","AUTH_RESPONSE","AUTH_LOGIN","BACKOFFICE_LOAD","BACKOFFICE_LOAD_DONE","BACKOFFICE_SET_CONFIG","BACKOFFICE_LOAD_ERROR","BACKOFFICE_NOT_FOUND","BACKOFFICE_NOT_AUTHORIZED","BACKOFFICE_LOAD_COMPONENTS","BACKOFFICE_UNLOAD_COMPONENTS","LAYOUT_WRAPPER_CLICK","LAYOUT_TOGGLE_OVERLAYMENU","LAYOUT_TOGGLE_STATICMENU","LAYOUT_TOGGLE_MOBILEMENU","LAYOUT_SET_MODE","LAYOUT_SET_COLORMODE","CONFIG_URL","API_URL","cookieAuthName","login_http_loading","login_post","post","history","redirect","dispatch","getState","res","login_response","path","pathname","reload","login_http_error","catch","error","console","log","logout","remove","login","backoffice_set_config","config","backoffice","backoffice_load_components","components","backoffice_unload_components","core","unloadComponents","backoffice_error","action","backoffice_not_found","backoffice_not_authorized","backoffice_load_done","backoffice_load","search","config_json","setConfig","count","forEach","component","addComponent","pitems","c","layout_wrapper_click","overlayMenuActive","mobileMenuActive","layout_toggle_overlaymenu","layout_toggle_staticmenu","layout_toggle_mobilemenu","layout_toggle_menu","isDesktop","layoutMode","layout_set_mode","layout_set_colormode","layoutColorMode","Core","rootReducer","_i","_Object$entries","entries","_Object$entries$_i","_slicedToArray","value","this","actions","store","createStore","applyMiddleware","thunk","__components","__mainmenu","__managers","__secureProps","done","decorators","extend","omit","default","ReactComponent","MainMenu","Manager","err","renderMainMenu","_this2","selected_menu","props","PluginComponent","className","_jsx","React","Fragment","children","record","utils","renderComponentById","_ref2","_ref2$as","as","find","renderComponents","_ref3","_this3","region","_ref3$as","parent","_ref3$separator","separator","_ref3$style","style","_ref3$className","target","_jsxs","renderComponentManager","_ref4","_ref4$as","initialBackoffice","staticMenuInactive","reducer","state","loading","http_error","ROOT_PATH","BASE_URL","CLIENT_URL","MAP_PROXY_URL","UPLOAD_URL","COOKIE_AUTH_NAME","AppContext","createContext","AppTopbar","_ctx$core","_ctx$core$config","_cfg$notifications","ctx","useContext","cfg","onClick","onToggleMenu","NavLink","activeClassName","to","exact","notifications","total","AppFooter","Date","getFullYear","AppSubmenu","_useState","useState","_useState2","activeIndex","setActiveIndex","onMenuItemClick","event","item","index","disabled","preventDefault","link","open","originalEvent","renderLink","content","submenuIcon","items","badge","icon","label","renderLinkContent","active","styleClass","classNames","badgeStyleClass","root","CSSTransition","timeout","enter","exit","in","unmountOnExit","AppMenu","model","AppProfile","_props$auth","_props$auth2","_props$auth3","_core$config","username","email","expanded","setExpanded","fontSize","prevState","ViewerVisitsChart","types","setTypes","_useState3","_useState4","timeranges","setTimeranges","_useState5","_useState6","op_type","set_op_type","_useState7","_useState8","timerange","changeTimeRange","_useState9","_useState10","dates_str","changeDates_str","_useState11","_useState12","data_values","changeData_values","_useState13","_useState14","input_dates_str","set_input_dates_str","_useState15","_useState16","input_data_values","set_input_data_values","_useState17","_useState18","loading_data_chart","set_loading_data_chart","useEffect","_props$stats","_props$stats2","_props$stats3","_props$stats4","stats","_toConsumableArray","selected_type","selected_timerange","httpClient","result","values","input_d","date","input_v","pos","parseInt","new_dates","slice","new_values","labels","datasets","fill","backgroundColor","borderColor","tension","Dropdown","onChange","changeTimeRangeAction","ProgressSpinner","width","height","Line","responsive","plugins","legend","display","position","title","scales","y","beginAtZero","BasicStats","basicstats","set_basicstats","nb_users","nb_groups","nb_viewers","nb_ops","defaults","animation","Contact","src","alt","ContactList","contacts","Panel","header","connect","withRouter","adminOrManager","provider","apiUrl","getSimpleList","resource","concat","getList","params","_params$pagination","pagination","page","perPage","_params$sort","sort","field","order","query","range","per_page","getOne","getMany","ids","getManyReference","_params$pagination2","_params$sort2","_defineProperty","_ref5","update","_ref6","updateMany","_ref7","create","_ref8","delete","_ref9","deleteMany","_ref10","getGeometry","feature_id","_ref11","saveGeometry","_ref12","getDocuments","resource_id","_ref13","getDocument","_ref14","createDocument","_ref15","updateDocument","_ref16","deleteDocument","_ref17","isSaving","setIsSaving","setData","toast","useRef","_useForm","useForm","defaultValues","register","control","handleSubmit","errors","watch","formState","setValue","getFormErrorMessage","onSubmit","formData","new_data","first_name","last_name","password","dataProvider","current","show","life","severity","summary","detail","shouldValidate","shouldDirty","finally","Toast","ref","baseZIndex","htmlFor","InputText","autoFocus","required","Controller","render","Password","feedback","Button","String","uuidV4","placeholder","Calendar","dateFormat","showIcon","showTime","showSeconds","Toolbar","right","useParams","setLoading","setRecord","loadData","auth_token_expire","auth_token","AccountForm","ModuleManager","Models","Utils","goBack","from","searchParams","previousSearchParams","replace","onCheck","checked","checked_date","toISOString","updateNotification","onClose","closed","closed_date","onReopen","onSave","notes","DataTransfer","InputTextarea","rows","autoResize","maxHeight","opacity","DataView","files","layout","emptyMessage","itemTemplate","file","_Fragment","rel","download","filename","size","class","toFixed","viewer","_data$status","_data$status2","_data$status3","icon_","Message","setError","NotificationForm","initialSearchParams","filters","first","sortField","sortOrder","viewersOptions","setViewersOptions","records","setRecords","selectedRecords","setSelectedRecords","setSearchParams","dt","watchAllFields","reset","all","exportCSV","_filter","author","_toast$current","filterViewersFooterTemplate","selectedItems","Accordion","AccordionTab","_searchParams","MultiSelect","optionLabel","optionValue","showClear","showSelectAll","panelFooterTemplate","minHeight","mask","left","DataTable","lazy","selectionMode","selection","onSelectionChange","paginator","totalRecords","onPage","onSort","exportFunction","exportFilename","Column","headerStyle","sortable","rowData","Chip","textAlign","color","editRecord","ReorderFields","list","startIndex","endIndex","f","_result$splice","splice","removed","fields","r","getItemStyle","isDragging","draggableStyle","userSelect","padding","grid","margin","background","getFieldListStyle","isDraggingOver","RecordSelector","availableRecords","setAvailableRecords","filterValue","setFilterValue","p","onFilterValueChange","new_records","v","ListChilds","DragDropContext","onDragEnd","destination","new_list","element","source","Droppable","droppableId","provided","snapshot","innerRef","Draggable","draggableId","toString","marginTop","draggableProps","marginBottom","float","paddingTop","paddingLeft","dragHandleProps","tooltip","tooltipOptions","confirmPopup","currentTarget","acceptLabel","rejectLabel","accept","new_prints","PrintGroupChildsEditor","_Component","printsList","groupsList","showGroupForm","showFieldForm","bind","onPrintsChange","onGroupsChange","setState","groups","prints","Component","sortRolesArray","a","b","tabItems","_props$data","_props$data2","_props$data3","isLoading","setIsLoading","configJson","setConfigJson","manifest_json","manifestJson","setManifestJson","custom_style","customStyle","setCustomStyle","roles","setRoles","availableRoles","setAvailableRoles","_useState19","_useState20","selectedRoles","setSelectedRoles","_useState21","_useState22","removedRoles","setRemovedRoles","_useState23","_useState24","filterRolesValue","setFilterRolesValue","_useState25","_useState26","availableUsers","setAvailableUsers","_useState27","owner","_useState28","selectedOwner","setSelectedOwner","_useState29","_useState30","setPrintsList","_useState31","_useState32","setGroupsList","_useState33","print_groups","_useState34","printChilds","setPrintChilds","_useState35","_useState36","customStyleEditorSearchText","setCustomStyleEditorSearchText","_useState37","_useState38","jsonConfigEditorSearchText","setJsonConfigEditorSearchText","op","jsonManifestEditor","customStyleEditor","jsonConfigEditor","_props$data4","_props$data5","_result$","_result$2","roles_result","rids","u","prints_result","groups_result","BlockUI","blocked","template","TabMenu","onTabChange","description","slug","keywords","is_active","show_help","show_credits","show_contact","on_homepage","img_icon","img_logo","owner_id","ToggleButton","onLabel","offLabel","onIcon","offIcon","toggle","OverlayPanel","showCloseIcon","breakpoints","hide","filterMatchMode","defaultValue","Chips","new_roles","new_available_roles","ListBox","multiple","AceEditor","mode","theme","onLoad","editorInstance","container","setProperty","getElementById","offsetWidth","newValue","editorProps","$blockScrolling","setOptions","tabSize","maxLines","printMargin","editor","undo","redo","backwards","wrap","caseSensitive","wholeWord","regExp","ViewerForm","_searchParams$filters","_searchParams$filters2","_searchParams$filters3","_searchParams$filters4","_searchParams$filters5","_searchParams$filters6","_searchParams$filters7","_searchParams$filters8","loaded","setLoaded","_props$history","_props$history$locati","_props$history$locati2","handler","setTimeout","clearTimeout","newRecord","deleteSelectedRecords","confirmDialog","onFilterChange","onFilterClear","idFilter","nameFilter","titleFilter","descriptionFilter","filterElement","filterPlaceholder","_rowData$owner","elem","MapWrapper","setMap","featuresLayer","setFeaturesLayer","setSelectedCoord","mapElement","mapRef","initalFeaturesLayer","VectorLayer","VectorSource","initialMap","Map","layers","TileLayer","OSM","view","View","projection","center","zoom","controls","on","handleMapClick","features","getSource","addFeatures","getView","fit","getExtent","setSource","clear","clickedCoord","getCoordinateFromPixel","pixel","transormedCoord","transform","GeometryFilterEditor","coordinateSystems","setCoordinateSystems","showForm","setShowForm","setFeatures","clearErrors","geometryWKT","geometrySRID","geom","wkt","format","OlWKT","readGeometry","getGeometryFromWKT","final_geom_wkt","writeGeometry","getWKTFromGeometry","clone","tolerance","onHide","refreshFeatures","geom_data","new_features","feature","readFeature","dataProjection","featureProjection","parser","OL3Parser","inject","Point","LineString","LinearRing","Polygon","MultiPoint","MultiLineString","MultiPolygon","GeometryCollection","jstsGeom","read","jstsBuffer","BufferOp","bufferOp","geomBuffer","write","buffered","OlFeature","geometry","bufferStyle","OlStyle","stroke","OlStroke","OlFill","setStyle","subscription","unsubscribe","srid","projections","OlProj","Proj4","defs","proj4register","newProj","fromLonLat","extent","worldExtent","Number","setWorldExtent","applyTransform","setExtent","addProjections","Dialog","visible","footer","TabView","TabPanel","rules","InputNumber","FieldFormEditor","setField","pattern","Tooltip","autoHide","minWidth","Checkbox","GroupFormEditor","setGroup","_useForm2","GroupFields","group","groupNum","fieldEdition","setFieldEdition","setShowFieldForm","onFieldFormHide","onFieldFormSave","new_fields","groupId","Fields","FormFieldsEditor","onFieldsChange","onGroupFieldsChange","groupEdition","onGroupFormHide","onGroupFormSave","result_array","_result_array$splice","ReorderGroups","LayoutEditor","pageFormatList","val","pageOrientationList","PrintLayoutsEditor","layoutEdition","setLayoutEdition","showLayoutForm","setShowLayoutForm","l","createKey","chars","charAt","_records","_record","findIndexByKey","orientation","_keys","deleteRecord","buildScaleList","list1","list2","Set","_props$data6","_props$data7","_props$data8","restrict_scales_list","scaleList","setScaleList","form_fields","formFields","setFormFields","layouts","setLayouts","geometryFilter","setGeometryFilter","allow_drawing","draw_location","free_printing","free_scale","identification","identification_fields","location_marking","map_scale","multi_geom","payment_reference","print_purpose","restrict_scales","scale","add_title","show_author","restrictScales","crs_result","dismissable","InputMask","keyCode","unmask","autoClear","geom_filter","geom_filter_srid","tolerance_filter","selectedItemsLabel","_props$backoffice","tmp_data","PrintForm","coordinate_systems","printsFilter","apply","onFilter","viewers","_props$data9","_props$data10","groupChilds","setGroupChilds","select_prints","group_prints","show_all_prints","PrintGroupForm","groupsFilter","PrintElementForm","elementsFilter","selectedStatus","setSelectedStatus","_history$location","_history$location$sta","read_only","statusFilter","fontWeight","sortGroupsArray","setGroups","availableGroups","setAvailableGroups","selectedGroups","setSelectedGroups","removedGroups","setRemovedGroups","filterGroupsValue","setFilterGroupsValue","gids","new_groups","new_available_groups","UserForm","RoleForm","sortUsersArray","users","setUsers","selectedUsers","setSelectedUsers","removedUsers","setRemovedUsers","filterUsersValue","setFilterUsersValue","users_result","new_users","new_available_users","GroupForm","parameters_table","parametersTable","displayFieldValue","setDisplayFieldValue","fieldValue","setFieldValue","setting_value","dangerouslySetInnerHTML","__html","_d$data","_d$data2","_d$data3","_d$data4","_d$data5","_d$data5$config_json","_d$data6","_d$data6$config_json","_d$data7","_d$data7$config_json","_d$data8","_d$data8$config_json","_d$data9","_d$data9$config_json","_d$data10","_d$data10$config_json","_d$data11","_d$data11$config_json","_d$data12","_d$data12$config_json","_d$data13","_d$data13$config_json","_d$data14","_d$data14$config_json","_d$data15","_d$data15$config_json","_d$data16","_d$data16$config_json","minx","miny","maxx","maxy","precision","ParameterForm","_rowData$config_json","_rowData$config_json2","min","max","pow","CoordinateSystemForm","Layout","sidebar","onWrapperClick","onSidebarClick","onLayoutModeChange","onLayoutColorModeChange","inputStyle","ripple","logo","wrapperClass","sidebarClassName","menu","cursor","Route","AccountEdit","NotificationEdit","NotificationList","Dashboard","ViewerEdit","ViewerList","PrintEdit","PrintList","PrintGroupEdit","PrintGroupList","PrintElementEdit","PrintElementList","match","UserEdit","UserList","RoleEdit","RoleList","GroupEdit","GroupList","ParameterEdit","ParameterList","CoordinateSystemEdit","CoordinateSystemList","menuClick","LayoutComponent","_core$actions","setUsername","setPassword","useDispatch","cookieData","submit","foundRedirect","exec","LoginWidget","useLocation","scrollTo","cookieValue","cookiePath","cookieExpiresDays","withCookies","cookiergpd","setCookiergpd","CookieConsent","buttonText","buttonStyle","expires","onAccept","_cookies$set","expireDate","setDate","getDate","extraCookieOptions","debug","cookieSecurity","SplashScreen","App","base_url","StrictMode","Provider","Router","basename","ScrollToTop","RGPD","Switch","PageLogin","Page404","Page401","Backoffice","ReactDOM"],"mappings":"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","file":"static/js/main.71b3f047.chunk.js","sourcesContent":["import { stringify } from 'query-string';\r\nimport Cookies from 'universal-cookie'\r\n\r\n/*\r\nexport interface Options extends RequestInit {\r\n    user?: {\r\n        authenticated?: boolean;\r\n        token?: string;\r\n    };\r\n}\r\n*/\r\n\r\nclass HttpError extends Error {\r\n  constructor(message, status,body = null) {\r\n      super(message);\r\n      Object.setPrototypeOf(this, HttpError.prototype);\r\n      this.name = this.constructor.name;\r\n      if (typeof Error.captureStackTrace === 'function') {\r\n          Error.captureStackTrace(this, this.constructor);\r\n      } else {\r\n          this.stack = new Error(message).stack;\r\n      }\r\n      this.stack = new Error().stack;\r\n  }\r\n}\r\n\r\n//export default HttpError;\r\n\r\nexport const createHeadersFromOptions = (options) => {\r\n    const requestHeaders = (options.headers ||\r\n        new Headers({\r\n            Accept: 'application/json',\r\n        }));\r\n    if (\r\n        !requestHeaders.has('Content-Type') &&\r\n        !(options && (!options.method || options.method === 'GET')) &&\r\n        !(options && options.body && options.body instanceof FormData)\r\n    ) {\r\n        requestHeaders.set('Content-Type', 'application/json');\r\n    }\r\n    if (options.user && options.user.authenticated && options.user.token) {\r\n        requestHeaders.set('X-API-KEY', options.user.token);\r\n    } else {\r\n      const cookies = new Cookies();\r\n      const cookieAuthName = process.env.REACT_APP_COOKIE_AUTH_NAME || 'websig_dgt';\r\n      const logged = cookies.get(cookieAuthName);\r\n      if (logged && logged.token) {\r\n        requestHeaders.set('X-API-KEY', logged.token);\r\n      }\r\n    }\r\n\r\n    return requestHeaders;\r\n};\r\n\r\nexport const fetchJson = (url, options = {}) => {\r\n    const requestHeaders = createHeadersFromOptions(options);\r\n\r\n    return fetch(url, { ...options, headers: requestHeaders })\r\n        .then(response =>\r\n            response.text().then(text => ({\r\n                status: response.status,\r\n                statusText: response.statusText,\r\n                headers: response.headers,\r\n                body: text,\r\n            }))\r\n        )\r\n        .then(({ status, statusText, headers, body }) => {\r\n            let json;\r\n            try {\r\n                json = JSON.parse(body);\r\n            } catch (e) {\r\n                // not json, no big deal\r\n            }\r\n            if (status < 200 || status >= 300) {\r\n                return Promise.reject(\r\n                    new HttpError(\r\n                        (json && json.message) || statusText,\r\n                        status,\r\n                        json\r\n                    )\r\n                );\r\n            }\r\n            return Promise.resolve({ status, headers, body, json });\r\n        });\r\n};\r\n\r\nexport const queryParameters = stringify;\r\n\r\nconst isValidObject = value => {\r\n    if (!value) {\r\n        return false;\r\n    }\r\n\r\n    const isArray = Array.isArray(value);\r\n    const isBuffer = typeof Buffer !== 'undefined' && Buffer.isBuffer(value);\r\n    const isObject =\r\n        Object.prototype.toString.call(value) === '[object Object]';\r\n    const hasKeys = !!Object.keys(value).length;\r\n\r\n    return !isArray && !isBuffer && isObject && hasKeys;\r\n};\r\n\r\nexport const flattenObject = (value, path = []) => {\r\n    if (isValidObject(value)) {\r\n        return Object.assign(\r\n            {},\r\n            ...Object.keys(value).map(key =>\r\n                flattenObject(value[key], path.concat([key]))\r\n            )\r\n        );\r\n    } else {\r\n        return path.length ? { [path.join('.')]: value } : value;\r\n    }\r\n};","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 436;","const _getAppRootPath = () => {\r\n  if (window?.SCALARGIS_ROOT_PATH !== '__SCALARGIS_ROOT_PATH__') {\r\n    return window?.SCALARGIS_ROOT_PATH || process.env.REACT_APP_ROOT_PATH || '';\r\n  } else {\r\n    return process.env.REACT_APP_ROOT_PATH || '';\r\n  }\r\n}\r\n\r\nconst _getAppBaseUrl = () => {\r\n  if (window?.SCALARGIS_ROOT_PATH_BASE_URL !== '__SCALARGIS_ROOT_PATH_BASE_URL__') {\r\n    return window?.SCALARGIS_ROOT_PATH_BASE_URL || process.env.REACT_APP_BASE_URL || '';\r\n  } else {\r\n    return process.env.REACT_APP_BASE_URL || '';\r\n  }\r\n}\r\n\r\nexport function rememberUrl(cookies, type, url) {\r\n  const prefix = process.env.REACT_APP_COOKIE_PREFIX || 'sniguserurl';\r\n  const cookieName = prefix + type;\r\n  let urlhistory = cookies.get(cookieName) || [];\r\n  if (urlhistory.indexOf(url) === -1) urlhistory.push(url);\r\n  cookies.set(cookieName, urlhistory);\r\n}\r\n\r\nexport const  generateRGBA = () => {\r\n  const r = Math.floor(Math.random() * 255);\r\n  const g = Math.floor(Math.random() * 255);\r\n  const b = Math.floor(Math.random() * 255);\r\n  return [r, g, b, 1].join(',');\r\n}\r\n\r\nexport const removeUrlParam = (sourceURL, key) => {\r\n  let rtn = sourceURL.split(\"?\")[0],\r\n    param,\r\n    params_arr = [],\r\n    new_params = [],\r\n    queryString = (sourceURL.indexOf(\"?\") !== -1) ? sourceURL.split(\"?\")[1] : \"\";\r\n  if (queryString !== \"\") {\r\n    params_arr = queryString.split(\"&\");\r\n    for (var i = params_arr.length - 1; i >= 0; i -= 1) {\r\n      param = params_arr[i].split(\"=\")[0];\r\n      let regex = new RegExp(key, \"ig\");\r\n      if (!regex.test(param)) {\r\n        new_params.push(params_arr[i]);\r\n      }\r\n    }\r\n    rtn = rtn + \"?\" + new_params.join(\"&\");\r\n  }\r\n  return rtn;\r\n}\r\n\r\nexport const getWindowSize = () => {\r\n  var w = window,\r\n  d = document,\r\n  e = d.documentElement,\r\n  g = d.getElementsByTagName('body')[0],\r\n  x = w.innerWidth || e.clientWidth || g.clientWidth,\r\n  y = w.innerHeight|| e.clientHeight|| g.clientHeight;\r\n  return [x, y];\r\n}\r\n\r\nexport const isUrlAppOrigin = (url) => {\r\n  //Considers it is same origin if is relative path\r\n  if (url.indexOf('http') !== 0) return true;\r\n\r\n  //Check if is same origin\r\n  const url1 = new URL(window.location.href);\r\n  const url2 = new URL(url);\r\n  return (url1.origin === url2.origin);\r\n}\r\n\r\n\r\nexport const isAdminOrManager = (auth) => {\r\n  let retVal = false;\r\n\r\n  const roles = auth?.data ? (auth.data.userroles || []) : (auth?.response?.userroles || []);\r\n\r\n  retVal = roles.map(s => s.toLowerCase()).filter(x => ['admin','manager'].includes(x)).length > 0;\r\n\r\n  return retVal;\r\n}\r\n\r\n// -----------------------------------------------------------------------------\r\n\r\nexport const getAppRootPath = () => {\r\n  return _getAppRootPath();\r\n}\r\n\r\nexport const getAppBaseUrl = () => {\r\n  const root_path = _getAppRootPath();\r\n  let url = root_path + '';\r\n  if (_getAppBaseUrl()) {\r\n    url = root_path + _getAppBaseUrl();\r\n  }\r\n  if (!url.endsWith(\"/\")) {\r\n    url += '/';\r\n  }\r\n  return url;\r\n}\r\n\r\nexport const getBackofficeBaseUrl = () => {\r\n  const base_path = getAppBaseUrl();\r\n  let url = base_path + 'backoffice';\r\n  if (!url.endsWith(\"/\")) {\r\n    url += '/';\r\n  }\r\n  return url;\r\n}\r\n\r\nexport const getAppClientUrl = () => {\r\n  const root_path = _getAppRootPath();\r\n  let url = root_path + '/static/backoffice/';\r\n  if (process.env.REACT_APP_CLIENT_URL) {\r\n    url = root_path + process.env.REACT_APP_CLIENT_URL;\r\n  }\r\n  if (!url.endsWith(\"/\")) {\r\n    url += '/';\r\n  }\r\n  return url;\r\n}\r\n\r\nexport const getAppApiUrl = () => {\r\n  const root_path = _getAppRootPath();\r\n  let url = root_path + '/api';\r\n  if (process.env.REACT_APP_API_URL) {\r\n    url = root_path + process.env.REACT_APP_API_URL;\r\n  }\r\n  if (url.startsWith('//')) {\r\n    url = window.location.protocol + url;\r\n  }\r\n  if (!url.toLowerCase().startsWith('http')) {\r\n    url =  window.location.origin + url;\r\n  }\r\n  return url;\r\n}\r\n\r\nexport const getAppMapProxyUrl = () => {\r\n  const root_path = _getAppRootPath();\r\n  let url = root_path + '/map/proxy?url=';\r\n  if (process.env.REACT_APP_MAP_PROXY) {\r\n    url = root_path + process.env.REACT_APP_MAP_PROXY;\r\n  }\r\n  if (url.startsWith('//')) {\r\n    url = window.location.protocol + url;\r\n  }\r\n  if (!url.toLowerCase().startsWith('http')) {\r\n    url =  window.location.origin + url;\r\n  }\r\n  return url;\r\n}\r\n\r\nexport const getAppUploadUrl = () => {\r\n  const root_path = _getAppRootPath();\r\n  let url = '';\r\n  if (process.env.REACT_APP_UPLOAD_URL) {\r\n    url = root_path + process.env.REACT_APP_UPLOAD_URL;\r\n  }\r\n  if (url.startsWith('//')) {\r\n    url = window.location.protocol + url;\r\n  }\r\n  if (!url.toLowerCase().startsWith('http')) {\r\n    url =  window.location.origin + url;\r\n  }\r\n  return url;\r\n}\r\n\r\nexport const getCookieAuthName = () => {\r\n  return process.env.REACT_APP_COOKIE_AUTH_NAME || 'scalargis_webgis';\r\n}","import Cookies from 'universal-cookie'\r\nimport { getAppApiUrl, getCookieAuthName } from '../utils'\r\n\r\nexport const AUTH_HTTP_LOADING          = 'AUTH_HTTP_LOADING'\r\nexport const AUTH_HTTP_ERROR            = 'AUTH_HTTP_ERROR'\r\nexport const AUTH_RESPONSE              = 'AUTH_RESPONSE'\r\nexport const AUTH_LOGIN                 = 'AUTH_LOGIN'\r\n\r\nexport const BACKOFFICE_LOAD            = 'BACKOFFICE_LOAD'\r\nexport const BACKOFFICE_LOAD_DONE       = 'BACKOFFICE_LOAD_DONE'\r\n\r\nexport const BACKOFFICE_SET_CONFIG      = 'BACKOFFICE_SET_CONFIG'\r\nexport const BACKOFFICE_LOAD_ERROR      = 'BACKOFFICE_LOAD_ERROR'\r\nexport const BACKOFFICE_NOT_FOUND           = 'BACKOFFICE_NOT_FOUND'\r\nexport const BACKOFFICE_NOT_AUTHORIZED      = 'BACKOFFICE_NOT_AUTHORIZED'\r\nexport const BACKOFFICE_LOAD_COMPONENTS     = 'BACKOFFICE_LOAD_COMPONENTS'\r\nexport const BACKOFFICE_UNLOAD_COMPONENTS   = 'BACKOFFICE_UNLOAD_COMPONENTS'\r\n\r\n\r\nexport const LAYOUT_WRAPPER_CLICK       = 'LAYOUT_WRAPPER_CLICK'\r\nexport const LAYOUT_TOGGLE_OVERLAYMENU  = 'LAYOUT_TOGGLE_OVERLAYMENU'\r\nexport const LAYOUT_TOGGLE_STATICMENU   = 'LAYOUT_TOGGLE_STATICMENU'\r\nexport const LAYOUT_TOGGLE_MOBILEMENU   = 'LAYOUT_TOGGLE_MOBILEMENU'\r\n\r\nexport const LAYOUT_SET_MODE   = 'LAYOUT_SET_MODE'\r\nexport const LAYOUT_SET_COLORMODE   = 'LAYOUT_SET_COLORMODE'\r\n\r\n\r\n// Get config URL\r\nconst CONFIG_URL = process.env.REACT_APP_CONFIG_URL || getAppApiUrl() + '/app/backoffice';\r\nconst API_URL = getAppApiUrl();\r\nconst cookieAuthName = getCookieAuthName();\r\n\r\n\r\nexport function login_http_loading() {\r\n  const action = {\r\n    type: AUTH_HTTP_LOADING\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function login_post(post, history, redirect) {\r\n  return function (dispatch, getState) {\r\n    dispatch(login_http_loading());\r\n    \r\n    // Login request\r\n    let options = {\r\n      method: 'POST',\r\n      body: JSON.stringify(post)\r\n    }\r\n\r\n    // Auth url. TODO: check for proxy\r\n    let url = API_URL + '/authentication/authenticate';\r\n    fetch(url, options)\r\n      .then(res => res.json())\r\n      .then(res => {\r\n        dispatch(login_response(res));\r\n        if (res.authenticated) {\r\n          const cookies = new Cookies();\r\n          cookies.set(cookieAuthName, res, { path: '/' });\r\n          if (redirect && history) history.push({ pathname: redirect }); \r\n          else window.location.reload();\r\n        } else {\r\n          dispatch(login_http_error({ status: 401, message: 'Nome de Utilizador ou Palavra-passe inválido'}));\r\n        }\r\n      }).catch(error => {\r\n        console.log('error', error);\r\n        dispatch(login_http_error(null));\r\n      });\r\n  }\r\n}\r\n\r\nexport function logout() {\r\n  const cookies = new Cookies();\r\n  cookies.remove(cookieAuthName, { path: '/' });\r\n  window.location.reload();\r\n}\r\n\r\nexport function login_http_error(res) {\r\n  const action = {\r\n    type: AUTH_HTTP_ERROR,\r\n    res\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function login_response(res) {\r\n  const action = {\r\n    type: AUTH_RESPONSE,\r\n    res\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function login(data) {\r\n  const action = {\r\n    type: AUTH_LOGIN,\r\n    data\r\n  }\r\n  return action\r\n}\r\n\r\nexport function backoffice_set_config(config) {\r\n  const action = {\r\n    type: BACKOFFICE_SET_CONFIG,\r\n    config,\r\n    backoffice: config\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function backoffice_load_components(components) {\r\n  const action = {\r\n    type: BACKOFFICE_LOAD_COMPONENTS,\r\n    components\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function backoffice_unload_components(core) {\r\n  return function (dispatch, getState) {\r\n    core.unloadComponents();\r\n    const action = {\r\n      type: BACKOFFICE_UNLOAD_COMPONENTS\r\n    }\r\n    dispatch(action);\r\n  }\r\n}\r\n\r\nexport function backoffice_error(history) {\r\n  const action = {\r\n    type: BACKOFFICE_LOAD_ERROR,\r\n    redirect: '/not-found'\r\n  }\r\n  if (action.redirect && history) history.push({ pathname: action.redirect })\r\n  return action;\r\n}\r\n\r\nexport function backoffice_not_found(history) {\r\n  const action =  {\r\n    type: BACKOFFICE_NOT_FOUND,\r\n    redirect: '/not-found'\r\n  }\r\n  if (action.redirect && history) history.push({ pathname: action.redirect })\r\n  return action;\r\n}\r\n\r\n\r\nexport function backoffice_not_authorized(history, redirect) {\r\n  const action = {\r\n    type: BACKOFFICE_NOT_AUTHORIZED,\r\n    redirect: redirect ? redirect : '/not-allowed'\r\n  }\r\n  if (action.redirect && history) history.push({ pathname: action.redirect })\r\n  return action;\r\n}\r\n\r\nexport function backoffice_load_done(components) {\r\n  const action = {\r\n    type: BACKOFFICE_LOAD_DONE\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function backoffice_load(core, history) {\r\n  return function (dispatch, getState) {\r\n\r\n    // Get logged user\r\n    const cookies = new Cookies();\r\n    const logged = cookies.get(cookieAuthName);\r\n    \r\n    // Fetch backoffice\r\n    let url = CONFIG_URL ? CONFIG_URL : API_URL + '/app/backoffice' + (history.location.search || '');\r\n    \r\n    const options = { headers: {} };\r\n    \r\n    // Add logged user token\r\n    if (logged) options.headers['X-API-KEY'] = logged.token;\r\n    \r\n    // Make request\r\n    fetch(url, options).then(res => {\r\n\r\n      // Validate response\r\n      if (res.status === 401) throw new Error('Unauthorized');\r\n      else if (res.status !== 200) throw new Error('Not found');\r\n      return res.json();\r\n      \r\n    }).then(data => {      \r\n      const config = { ...data, config_json: data.config };\r\n      delete config.config;\r\n\r\n      // Validate config\r\n      if (!config) return dispatch(backoffice_not_found(history));\r\n      if (!config.config_json) return dispatch(backoffice_not_found(history));\r\n\r\n      // Unload components\r\n      dispatch(backoffice_unload_components(core));\r\n\r\n      // Setup config\r\n      core.setConfig(config);\r\n      dispatch(backoffice_set_config(config));\r\n\r\n      // Load components\r\n      let count = 0;\r\n      let { components } = config.config_json;\r\n      components.forEach(component => {\r\n        core.addComponent(core, component, () => {\r\n          count++;\r\n          if (count === components.length) {\r\n\r\n            // Index by id\r\n            let pitems = {};\r\n            components.forEach(c => pitems[c.id] = c);\r\n\r\n            // Finally, load into redux store\r\n            dispatch(backoffice_load_components(pitems));\r\n            dispatch(backoffice_load_done());\r\n          }\r\n        })\r\n      })\r\n\r\n    }).catch(error => {\r\n\r\n      // Redirect to login or error pages\r\n      if (error.message === 'Unauthorized') {\r\n        if (!logged) {\r\n          //const redirect = 'login?redirect=' + (id || '/');\r\n          const redirect = '/login?redirect=/';\r\n          history.push(redirect);\r\n        } else dispatch(backoffice_not_authorized(history));\r\n      } else dispatch(logout());  //dispatch(backoffice_not_authorized(history));\r\n    })\r\n  }\r\n}\r\n\r\nexport function layout_wrapper_click() {\r\n  const action = {\r\n    type: LAYOUT_WRAPPER_CLICK,\r\n    overlayMenuActive: false,\r\n    mobileMenuActive: false\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function layout_toggle_overlaymenu() {\r\n  const action = {\r\n    type: LAYOUT_TOGGLE_OVERLAYMENU\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function layout_toggle_staticmenu() {\r\n  const action = {\r\n    type: LAYOUT_TOGGLE_STATICMENU\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function layout_toggle_mobilemenu() {\r\n  const action = {\r\n    type: LAYOUT_TOGGLE_MOBILEMENU\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function layout_toggle_menu(isDesktop) {\r\n  return (dispatch, getState) => {\r\n    if (isDesktop) {\r\n      if (getState().backoffice.layoutMode === 'overlay') {\r\n        dispatch(layout_toggle_overlaymenu());\r\n      } else if (getState().backoffice.layoutMode === 'static') {\r\n        dispatch(layout_toggle_staticmenu())\r\n      }\r\n    } else {\r\n      dispatch(layout_toggle_mobilemenu())\r\n    }\r\n  }\r\n}\r\n\r\nexport function layout_set_mode(layoutMode) {\r\n  let action = {\r\n    type: LAYOUT_SET_MODE,\r\n    layoutMode\r\n  }\r\n  return action;\r\n}\r\n\r\nexport function layout_set_colormode(layoutColorMode) {\r\n  let action = {\r\n    type: LAYOUT_SET_COLORMODE,\r\n    layoutColorMode\r\n  }\r\n  return action;\r\n}","import React from 'react'\r\nimport { extend, omit } from 'underscore'\r\nimport thunk from 'redux-thunk'\r\nimport { createStore, applyMiddleware } from 'redux'\r\nimport * as actions from './core/actions'\r\nimport * as utils from './core/utils'\r\n\r\nfunction Core(config, rootReducer) {\r\n\r\n  /**\r\n  * Apply config options\r\n  */\r\n  for (const [key, value] of Object.entries(config)) {\r\n    this[key] = value\r\n  }\r\n\r\n  /**\r\n   * Hold programatic config\r\n   */\r\n  this.config = {};\r\n\r\n  /**\r\n   * Hold redux actions\r\n   */\r\n  this.actions = actions;\r\n\r\n  /**\r\n   * Hold redux store\r\n   */\r\n  this.store = createStore(rootReducer, applyMiddleware(thunk));\r\n\r\n  /**\r\n   * Hold app components\r\n   */\r\n  this.__components = {};\r\n\r\n  /**\r\n   * Hold menu components\r\n   */\r\n  this.__mainmenu = {};\r\n\r\n  /**\r\n   * Hold manager components\r\n   */\r\n   this.__managers = {};\r\n\r\n  /**\r\n   * Secure app props\r\n   */\r\n  this.__secureProps = ['config', 'actions', 'store', 'Renderer', '__components', '__mainmenu', '__managers'];\r\n}\r\n\r\n// Set core config\r\nCore.prototype.setConfig = function(config) {\r\n  this.config = config;\r\n}\r\n\r\n// Add components\r\nCore.prototype.addComponent = function(core, component, done) {\r\n  import('./components/' + component.type + '/src/Main.js').then(c => {\r\n\r\n    // Basic Decorator Pattern: decorates core with additional functionality\r\n    if (c.decorators && typeof c.decorators === 'object') {\r\n      core.actions = extend(core.actions, omit(c.decorators, this.__secureProps ));\r\n    }\r\n\r\n    // TODO: Add plugin redux actions/reducers\r\n    // Hint: replaceReducer https://redux.js.org/api/store#replacereducernextreducer\r\n    // Get current reducer\r\n    // Add plugin reducer\r\n    // Replace reducer\r\n\r\n    // Registry Pattern: register react component in components registry \r\n    if (!!c.default && !this.__components[component.type]) {\r\n      const ReactComponent = c.default;\r\n      this.__components[component.type] = ReactComponent;\r\n    }\r\n\r\n    // Main menu registry\r\n    if (!!c.MainMenu && !this.__mainmenu[component.type]) {\r\n      const MainMenu = c.MainMenu;\r\n      this.__mainmenu[component.type] = MainMenu;\r\n    }\r\n\r\n    // Manager registry\r\n    if (!!c.Manager && !this.__managers[component.type]) {\r\n      const Manager = c.Manager;\r\n      this.__managers[component.type] = Manager;\r\n    }    \r\n    \r\n    done();\r\n  }).catch(err => {\r\n    console.log('Error loading module:', err);\r\n    done();\r\n  })\r\n}\r\n\r\nCore.prototype.unloadComponents = function() {\r\n  this.__components = {}\r\n  this.__managers = {}\r\n}\r\n\r\nCore.prototype.renderMainMenu = function({ selected_menu, props }) {\r\n  \r\n  // Validate not empty components registry\r\n  const keys = Object.keys(this.__mainmenu);\r\n  if (keys.length === 0) return null;\r\n\r\n  // From all components\r\n  let { components } = this.config.config_json;\r\n  \r\n  // Render components\r\n  return components.map(c => {\r\n    let PluginComponent = this.__mainmenu[c.type];\r\n\r\n    // Validate dynamic import is loaded\r\n    if (!PluginComponent) return null;\r\n\r\n    const className = selected_menu === c.id ?\r\n    \"p-button-rounded p-button-raised p-button-sm\" :\r\n    \"p-button-rounded p-button-raised p-button-sm p-button-outlined\";\r\n\r\n    return (\r\n      <React.Fragment key={c.id}>\r\n        <PluginComponent\r\n          className={className}\r\n          record={c}\r\n          config={{ className, ...props, ...c.config_json }}\r\n          core={this}\r\n          actions={this.actions}\r\n          utils={utils}\r\n        />\r\n      </React.Fragment>\r\n    )\r\n  })\r\n}\r\n\r\nCore.prototype.renderComponentById = function({ id, as = '', props, }) {\r\n\r\n  // Validate id\r\n  if (!id) return null;\r\n  \r\n  // Validate not empty components registry\r\n  const keys = Object.keys(this.__components);\r\n  if (keys.length === 0) return null;\r\n\r\n  // From all components\r\n  let { components } = this.config.config_json;\r\n  \r\n  // Filter by id\r\n  let c = components.find(c => c.id === id);\r\n\r\n  // Render components\r\n  let PluginComponent = this.__components[c.type];\r\n\r\n  // Validate dynamic import is loaded\r\n  if (!PluginComponent) return null;\r\n  return (\r\n    <PluginComponent\r\n      record={c}\r\n      config={{ ...props, ...c.config_json }}\r\n      core={this}\r\n      actions={this.actions}\r\n      as={as}\r\n      utils={utils}\r\n    />\r\n  )\r\n}\r\n\r\nCore.prototype.renderComponents = function({ region, as = '', props, parent, separator = '', style = null, className = '' }) {\r\n  \r\n  // Validate not empty components registry\r\n  const keys = Object.keys(this.__components);\r\n  if (keys.length === 0) return null;\r\n\r\n  // From all components\r\n  let { components } = this.config.config_json;\r\n  \r\n  // Filter by parent\r\n  if (parent) components = components.filter(c => parent.children.includes(c.id));\r\n\r\n  // Filter by region\r\n  const regionComponents = components.filter(c => c.target === region);\r\n\r\n  // Render components\r\n  return regionComponents.map(c => {\r\n    let PluginComponent = this.__components[c.type];\r\n\r\n    // Validate dynamic import is loaded\r\n    if (!PluginComponent) return null;\r\n    return (\r\n      <div key={c.id} className={className} style={style ? style(c) : null }>\r\n        <PluginComponent\r\n          record={c}\r\n          config={{ ...props, ...c.config_json }}\r\n          core={this}\r\n          actions={this.actions}\r\n          as={as}\r\n          utils={utils}\r\n        />\r\n        { separator }\r\n      </div>\r\n    )\r\n  })\r\n}\r\n\r\nCore.prototype.renderComponentManager = function({ id, as = '', props }) {\r\n\r\n  // Validate id\r\n  if (!id) return null;\r\n  \r\n  // Validate not empty components registry\r\n  const keys = Object.keys(this.__managers);\r\n  if (keys.length === 0) return null;\r\n\r\n  // From all components\r\n  let { components } = this.config.config_json;\r\n  \r\n  // Filter by id\r\n  let c = components.find(c => c.id === id);\r\n\r\n  // Render components\r\n  let PluginComponent = this.__managers[c.type];\r\n\r\n  // Validate dynamic import is loaded\r\n  if (!PluginComponent) return null;\r\n  return (\r\n    <PluginComponent\r\n      record={c}\r\n      config={{ ...props, ...c.config_json }}\r\n      core={this}\r\n      actions={this.actions}\r\n      as={as}\r\n      utils={utils}\r\n    />\r\n  )\r\n}\r\n\r\nexport default Core;\r\n","import Cookies from 'universal-cookie'\r\nimport {\r\n  LAYOUT_TOGGLE_MOBILEMENU,\r\n  LAYOUT_TOGGLE_OVERLAYMENU,\r\n  LAYOUT_TOGGLE_STATICMENU,\r\n  LAYOUT_WRAPPER_CLICK,\r\n  LAYOUT_SET_MODE,\r\n  LAYOUT_SET_COLORMODE,\r\n  BACKOFFICE_LOAD,\r\n  BACKOFFICE_LOAD_COMPONENTS,\r\n  BACKOFFICE_UNLOAD_COMPONENTS,\r\n  BACKOFFICE_LOAD_DONE,\r\n  BACKOFFICE_SET_CONFIG,\r\n  AUTH_HTTP_ERROR,\r\n  AUTH_HTTP_LOADING,\r\n  AUTH_RESPONSE,\r\n  AUTH_LOGIN,\r\n} from '../actions'\r\nimport { getCookieAuthName } from '../utils'\r\n\r\nconst initialBackoffice = {\r\n  layoutMode: 'static',\r\n  layoutColorMode: 'light',\r\n  staticMenuInactive: false,\r\n  overlayMenuActive: false,\r\n  mobileMenuActive: false,\r\n  config_json: {\r\n  }\r\n}\r\n\r\nconst cookies = new Cookies();\r\nconst cookieAuthName = getCookieAuthName();\r\n\r\n\r\nconst reducer = (state = { loading: true, auth: { data: cookies.get(cookieAuthName)}, config: null, backoffice: initialBackoffice, components: {} }, action) => {\r\n  \r\n  switch (action.type) {\r\n\r\n    // Login loading\r\n    case AUTH_HTTP_LOADING:\r\n      return {\r\n        ...state,\r\n        auth: {\r\n          loading: true,\r\n          http_error: false,\r\n          error: null\r\n        }\r\n      }\r\n\r\n    // Login http error\r\n    case AUTH_HTTP_ERROR:\r\n      return {\r\n        ...state,\r\n        auth: {\r\n          loading: false,\r\n          http_error: true,\r\n          response: action.res\r\n        }\r\n      }\r\n\r\n    // Login response\r\n    case AUTH_RESPONSE:\r\n      return {\r\n        ...state,\r\n        auth: {\r\n          loading: false,\r\n          response: action.res\r\n        }\r\n      }\r\n\r\n    // Login user\r\n    case AUTH_LOGIN:\r\n      return {\r\n        ...state,\r\n        auth: {\r\n          loading: false,\r\n          data: action.data\r\n        }\r\n      }\r\n    \r\n    // Start loading backoffice config\r\n    case BACKOFFICE_LOAD:\r\n      return {\r\n        ...state,\r\n        loading: true\r\n      }\r\n\r\n    // Set viewer config\r\n    case BACKOFFICE_SET_CONFIG:\r\n      return {\r\n        ...state,\r\n        config: action.config,\r\n        backoffice: {\r\n          ...initialBackoffice,\r\n          ...action.backoffice\r\n        }\r\n      }\r\n\r\n    case BACKOFFICE_LOAD_COMPONENTS:\r\n      return {\r\n        ...state,\r\n        components: action.components\r\n      }\r\n\r\n    case BACKOFFICE_UNLOAD_COMPONENTS:\r\n      return {\r\n        ...state,\r\n        components: {}\r\n      }\r\n\r\n    case BACKOFFICE_LOAD_DONE:\r\n      return {\r\n        ...state,\r\n        loading: false\r\n      }\r\n\r\n    // On click layout\r\n    case LAYOUT_WRAPPER_CLICK:\r\n      return {\r\n      ...state,\r\n      backoffice: {\r\n        ...state.backoffice,\r\n        overlayMenuActive: false,\r\n        mobileMenuActive: false\r\n      }\r\n    }\r\n\r\n    // Toggle overlay menu\r\n    case LAYOUT_TOGGLE_OVERLAYMENU:\r\n      return {\r\n      ...state,\r\n      backoffice: {\r\n        ...state.backoffice,\r\n        overlayMenuActive: !state.backoffice.overlayMenuActive\r\n      }\r\n    }\r\n\r\n    // Toggle static menu\r\n    case LAYOUT_TOGGLE_STATICMENU:\r\n      return {\r\n      ...state,\r\n      backoffice: {\r\n        ...state.backoffice,\r\n        staticMenuInactive: !state.backoffice.staticMenuInactive\r\n      }\r\n    }\r\n\r\n    // Toggle mobile menu\r\n    case LAYOUT_TOGGLE_MOBILEMENU:\r\n      return {\r\n      ...state,\r\n      backoffice: {\r\n        ...state.backoffice,\r\n        mobileMenuActive: !state.backoffice.mobileMenuActive\r\n      }\r\n    }\r\n\r\n    // Set layout mode\r\n    case LAYOUT_SET_MODE:\r\n      return {\r\n      ...state,\r\n      backoffice: {\r\n        ...state.backoffice,\r\n        layoutMode: action.layoutMode\r\n      }\r\n    }\r\n\r\n    // Set layout mode\r\n    case LAYOUT_SET_COLORMODE:\r\n      return {\r\n      ...state,\r\n      backoffice: {\r\n        ...state.backoffice,\r\n        layoutColorMode: action.layoutColorMode\r\n      }\r\n    }    \r\n\r\n    // Not state change\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport default reducer;","import React from 'react'\r\nimport Core from './Core'\r\nimport rootReducer from './core/reducers'\r\nimport { getAppRootPath, getAppBaseUrl, getAppClientUrl, getAppApiUrl, getAppMapProxyUrl, getAppUploadUrl, getCookieAuthName } from './core/utils';\r\n\r\nconst ROOT_PATH = getAppRootPath();\r\nconst BASE_URL = getAppBaseUrl();\r\nconst CLIENT_URL = getAppClientUrl();\r\nconst API_URL = getAppApiUrl();\r\nconst MAP_PROXY_URL = getAppMapProxyUrl();\r\nconst UPLOAD_URL = getAppUploadUrl();\r\nconst COOKIE_AUTH_NAME = getCookieAuthName();\r\nexport const core = new Core({ ROOT_PATH, BASE_URL, CLIENT_URL, API_URL, MAP_PROXY_URL, UPLOAD_URL, COOKIE_AUTH_NAME }, rootReducer)\r\n\r\nconst AppContext = React.createContext();\r\n\r\nexport default AppContext;","import React, { useContext } from 'react';\r\nimport { NavLink } from 'react-router-dom';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport AppContext from '../../AppContext';\r\n\r\nexport const AppTopbar = (props) => {\r\n    const ctx = useContext(AppContext);\r\n    const cfg = ctx?.core?.config?.config_json;\r\n\r\n    return (\r\n        <div className=\"layout-topbar clearfix\">\r\n            <button type=\"button\" className=\"p-link layout-menu-button\" onClick={props.onToggleMenu}>\r\n                <span className=\"pi pi-bars\" />\r\n            </button>\r\n            <div className=\"layout-topbar-icons\">\r\n                <NavLink activeClassName=\"active-route\" to={'/notifications/list'} exact target={null}>\r\n                    <button type=\"button\" className=\"p-link\">\r\n                        <span className=\"layout-topbar-item-text\">Events</span>\r\n                        <span className=\"layout-topbar-icon pi pi-inbox\" />\r\n                        <span className=\"layout-topbar-badge\">{cfg?.notifications?.total || 0}</span>\r\n                    </button>\r\n                </NavLink>\r\n                <button type=\"button\" className=\"p-link\">\r\n                    <span className=\"layout-topbar-item-text\">Settings</span>\r\n                    <span className=\"layout-topbar-icon pi pi-cog\" />\r\n                </button>\r\n                <button type=\"button\" className=\"p-link\">\r\n                    <span className=\"layout-topbar-item-text\">User</span>\r\n                    <span className=\"layout-topbar-icon pi pi-user\" />\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}","import React,{ useContext } from 'react';\r\n\r\nexport const AppFooter = () => {\r\n    \r\n    return (\r\n        <div className=\"layout-footer\">\r\n            <span className=\"footer-text\" style={{ 'marginLeft': '5px' }}>&copy; {new Date().getFullYear()} {process.env.REACT_APP_ENTITY_NAME || ''}</span>\r\n        </div>\r\n    );\r\n}","import React, { useState } from 'react';\r\nimport { NavLink } from 'react-router-dom';\r\nimport { CSSTransition } from 'react-transition-group';\r\nimport classNames from 'classnames';\r\n\r\nconst AppSubmenu = (props) => {\r\n\r\n    const [activeIndex, setActiveIndex] = useState(null)\r\n\r\n    const onMenuItemClick = (event, item, index) => {\r\n        //avoid processing disabled items\r\n        if (item.disabled) {\r\n            event.preventDefault();\r\n            return true;\r\n        }\r\n\r\n        //execute command\r\n        /*\r\n        if (item.command) {\r\n            item.command({ originalEvent: event, item: item });\r\n        }\r\n        */\r\n        if (item.link) {\r\n            if (item.target) {\r\n                event.preventDefault();\r\n                window.open(item.link, '_blank');\r\n                return true;\r\n            } else {\r\n                window.location = item.link;\r\n            }\r\n        }\r\n\r\n        if (index === activeIndex)\r\n            setActiveIndex(null);\r\n        else\r\n            setActiveIndex(index);\r\n\r\n        if (props.onMenuItemClick) {\r\n            props.onMenuItemClick({\r\n                originalEvent: event,\r\n                item: item\r\n            });\r\n        }\r\n    }\r\n\r\n    const renderLinkContent = (item) => {\r\n        let submenuIcon = item.items && <i className=\"pi pi-fw pi-angle-down menuitem-toggle-icon\"></i>;\r\n        let badge = item.badge && <span className=\"menuitem-badge\">{item.badge}</span>;\r\n\r\n        return (\r\n            <React.Fragment>\r\n                <i className={item.icon}></i>\r\n                <span>{item.label}</span>\r\n                {submenuIcon}\r\n                {badge}\r\n            </React.Fragment>\r\n        );\r\n    }\r\n\r\n    const renderLink = (item, i) => {\r\n        let content = renderLinkContent(item);\r\n\r\n        if (item.to) {\r\n            return (\r\n                <NavLink activeClassName=\"active-route\" to={item.to} onClick={(e) => onMenuItemClick(e, item, i)} exact target={item.target}>\r\n                    {content}\r\n                </NavLink>\r\n            )\r\n        }\r\n        else {\r\n            return (\r\n                <a href={item.url} onClick={(e) => onMenuItemClick(e, item, i)} target={item.target}>\r\n                    {content}\r\n                </a>\r\n            );\r\n        }\r\n    }\r\n\r\n    let items = props.items && props.items.map((item, i) => {\r\n        let active = activeIndex === i;\r\n        let styleClass = classNames(item.badgeStyleClass, { 'active-menuitem': active && !item.to });\r\n\r\n        return (\r\n            <li className={styleClass} key={i}>\r\n                {item.items && props.root === true && <div className='arrow'></div>}\r\n                {renderLink(item, i)}\r\n                <CSSTransition classNames=\"p-toggleable-content\" timeout={{ enter: 1000, exit: 450 }} in={active} unmountOnExit>\r\n                    <AppSubmenu items={item.items} onMenuItemClick={props.onMenuItemClick} />\r\n                </CSSTransition>\r\n            </li>\r\n        );\r\n    });\r\n\r\n    return items ? <ul className={props.className}>{items}</ul> : null;\r\n}\r\n\r\nexport const AppMenu = (props) => {\r\n    return (\r\n        <div className=\"layout-menu-container\">\r\n            <AppSubmenu items={props.model} className=\"layout-menu\" onMenuItemClick={props.onMenuItemClick} root={true} />\r\n        </div>\r\n    );\r\n}","import React, { useState } from 'react';\r\nimport { NavLink } from 'react-router-dom';\r\nimport classNames from 'classnames';\r\nimport { CSSTransition } from 'react-transition-group';\r\n\r\nexport const AppProfile = (props) => {\r\n\r\n    const { core, dispatch } = props;\r\n    const { logout } = core.actions;\r\n\r\n    const auth = props.auth?.data ? props.auth?.data : props.auth?.response || {};\r\n    const { name, username, email } = auth;\r\n\r\n    const cfg = core?.config?.config_json;\r\n\r\n    const [expanded, setExpanded] = useState(false);\r\n\r\n    const cookieAuthName = core.COOKIE_AUTH_NAME;\r\n\r\n    const CLIENT_URL = core.CLIENT_URL;\r\n\r\n    const onClick = (event) => {\r\n        setExpanded(prevState => !prevState);\r\n        event.preventDefault();\r\n    }\r\n\r\n    return (\r\n        <div className=\"layout-profile\">\r\n            <div className=\"p-mb-2\">\r\n                <i className=\"fas fa-user-circle\" style={{fontSize: \"3rem\"}}></i>                \r\n            </div>\r\n            <button className=\"p-link layout-profile-link\" onClick={onClick}>\r\n                <span className=\"username\">{name || username || ''}</span>\r\n                <i className=\"pi pi-fw pi-cog\" />\r\n            </button>\r\n            <CSSTransition classNames=\"p-toggleable-content\" timeout={{ enter: 1000, exit: 450 }} in={expanded} unmountOnExit>\r\n                <ul className={classNames({ 'layout-profile-expanded': expanded })}>\r\n                    <li>\r\n                        <NavLink activeClassName=\"active-route\" to={'/account'} exact target={null}>\r\n                            <button type=\"button\" className=\"p-link\"><i className=\"pi pi-fw pi-user\" /><span>Conta</span></button>\r\n                        </NavLink>\r\n                    </li>\r\n                    <li>\r\n                        <NavLink activeClassName=\"active-route\" to={'/notifications/list'} exact target={null}>\r\n                            <button type=\"button\" className=\"p-link\"><i className=\"pi pi-fw pi-inbox\" /><span>Notificações</span><span className=\"menuitem-badge\">{cfg?.notifications?.total || 0}</span></button>\r\n                        </NavLink>\r\n                    </li>\r\n                    <li><button type=\"button\" className=\"p-link\" onClick={e => dispatch(logout())}><i className=\"pi pi-fw pi-power-off\" /><span>Sair</span></button></li>\r\n                </ul>\r\n            </CSSTransition>\r\n        </div>\r\n    );\r\n}","import React, { useEffect, useState, useRef } from 'react'\r\nimport { Line } from 'react-chartjs-2'\r\nimport { defaults } from 'react-chartjs-2'\r\nimport { Dropdown } from 'primereact/dropdown'\r\nimport { ProgressSpinner } from 'primereact/progressspinner'\r\n\r\nimport { fetchJson } from  '../../../service/fetch'\r\n\r\n\r\ndefaults.animation = false\r\n\r\nexport default function ViewerVisitsChart(props) {\r\n\r\n    const { core } = props;\r\n\r\n    const API_URL = core.API_URL;\r\n\r\n    const [types, setTypes] = useState([\r\n        { label: 'Visualização de mapas', value: 'VM' },\r\n        { label: 'Emissão de plantas', value: 'EP' }\r\n    ]);\r\n\r\n    const [timeranges, setTimeranges] = useState([\r\n        { label: 'Desde sempre', value: 'all' },\r\n        { label: 'Últimos 7 dias', value: '7' },\r\n        { label: 'Últimos 30 dias', value: '30' },\r\n        { label: 'Últimos 100 dias', value: '100' },\r\n        { label: 'Último ano', value: '365' }\r\n    ]);\r\n\r\n    const [op_type, set_op_type] = useState(\"VM\")\r\n\r\n    const [timerange, changeTimeRange] = useState(\"100\")\r\n\r\n    const [dates_str, changeDates_str] = useState()\r\n    const [data_values, changeData_values] = useState()\r\n\r\n    const [input_dates_str, set_input_dates_str] = useState()\r\n    const [input_data_values, set_input_data_values] = useState()\r\n\r\n    const [loading_data_chart, set_loading_data_chart] = useState(false)\r\n\r\n    useEffect(() => {\r\n        if (props?.stats?.types) {\r\n            setTypes([...props.stats.types]);\r\n        }\r\n        if (props?.stats?.timeranges) {\r\n            setTimeranges([...props.stats.timeranges]);\r\n        }\r\n        if (props?.stats?.selected_type) {\r\n            set_op_type(props.stats.selected_type);\r\n        }\r\n        if (props?.stats?.selected_timerange) {\r\n            changeTimeRange(props.stats.selected_timerange);\r\n        }        \r\n    }, [props.stats]);\r\n\r\n    useEffect(() => {\r\n        set_loading_data_chart(true)\r\n\r\n        const url = API_URL + '/portal/stats/viewer_visits?type_code=' + op_type;\r\n\r\n        const httpClient = fetchJson;\r\n\r\n        httpClient(url).then(({ headers, json }) => json)\r\n        .then (result => {\r\n            set_loading_data_chart(false)\r\n\r\n            if (result.values) {\r\n                const input_d = result.values.map(e => e.date)\r\n                const input_v = result.values.map(e => e.count)\r\n\r\n                set_input_dates_str(input_d)\r\n                set_input_data_values(input_v)\r\n\r\n\r\n                let pos = input_d.length - 1 - parseInt(timerange)\r\n                if (pos < 0) pos = 0\r\n                if (timerange === 'all') {\r\n                    changeDates_str(input_d)\r\n                    changeData_values(input_v)\r\n                    return\r\n                }\r\n                const new_dates = input_d.slice(pos, input_d.length - 1)\r\n                const new_values = input_v.slice(pos, input_v.length - 1)\r\n\r\n                changeDates_str(new_dates)\r\n                changeData_values(new_values)\r\n            } else {\r\n                set_input_dates_str(null);\r\n                set_input_data_values(null);\r\n\r\n                changeDates_str(null);\r\n                changeData_values(null);                \r\n            }          \r\n        })\r\n        .catch(error => {\r\n            console.log(\"fetch error\")\r\n            set_loading_data_chart(false)\r\n        });\r\n    }, [op_type])\r\n\r\n\r\n\r\n    const data = {\r\n        labels: dates_str,\r\n        datasets: [\r\n            {\r\n                // label: 'Nº de Visitas',\r\n                data: data_values,\r\n                fill: false,\r\n                backgroundColor: 'rgb(255, 99, 132)',\r\n                borderColor: 'rgba(255, 99, 132, 0.8)',\r\n                tension: 0.25\r\n                // yAxisID: 'y-axis-1'\r\n            },\r\n        ],\r\n    };\r\n\r\n\r\n    const options = {\r\n        responsive: true,\r\n        plugins: {\r\n            legend: {\r\n                display: false,\r\n                position: 'top',\r\n            },\r\n            title: {\r\n                display: true,\r\n                text: 'Contagem diária'\r\n            }\r\n        },\r\n        scales: {\r\n            y: {\r\n                beginAtZero: true\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    const legend = {\r\n        display: true,\r\n        position: \"top\",\r\n        labels: {\r\n            fontColor: \"#323130\",\r\n            fontSize: 14\r\n        }\r\n    }\r\n\r\n\r\n    function changeTimeRangeAction(value) {\r\n\r\n        changeTimeRange(value)\r\n\r\n        if (value === 'all') {\r\n            changeDates_str(input_dates_str)\r\n            changeData_values(input_data_values)\r\n            return\r\n        }\r\n\r\n        if (input_dates_str) {\r\n            let pos = input_dates_str.length - 1 - parseInt(value)\r\n            if (pos < 0) pos = 0\r\n\r\n            const new_dates = input_dates_str.slice(pos, input_dates_str.length - 1)\r\n            const new_values = input_data_values.slice(pos, input_data_values.length - 1)\r\n\r\n            changeDates_str(new_dates)\r\n            changeData_values(new_values)\r\n        }\r\n    }\r\n\r\n    function changeOpType(value) {\r\n        set_op_type(value)\r\n    }\r\n\r\n\r\n    return (\r\n        <div className=\"card\">\r\n            <div className=\"p-grid p-fluid\">\r\n                <div className=\"p-col-12 p-lg-5\">\r\n                    <Dropdown value={op_type} options={types} onChange={(e) => changeOpType(e.value)} />\r\n                </div>\r\n\r\n                <div className=\"p-col-12 p-lg-5\">\r\n                    <Dropdown value={timerange} options={timeranges} onChange={(e) => changeTimeRangeAction(e.value)} />\r\n                </div>\r\n\r\n                <div className=\"p-col-12 p-lg-2\">\r\n                    {loading_data_chart ? <ProgressSpinner style={{ width: '25px', height: '30px' }} /> : null}\r\n                </div>\r\n\r\n                <Line data={data} options={options} />\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React, { useEffect, useState } from 'react'\r\nimport { defaults } from 'react-chartjs-2'\r\n\r\ndefaults.animation = false\r\n\r\nexport default function BasicStats(props) {\r\n\r\n    const { core } = props;\r\n\r\n    const API_URL = core.API_URL;\r\n\r\n    const [basicstats, set_basicstats] = useState({})\r\n\r\n    useEffect(() => {\r\n        const url = API_URL + '/portal/stats/basicstats'\r\n\r\n        fetch(url).then(res => {\r\n            return res.json();\r\n        }).then(result => {\r\n            console.log(result)\r\n            set_basicstats(result)\r\n\r\n        })\r\n            .catch(error => {\r\n                console.log(\"fetch error\")\r\n            })\r\n    }, [])\r\n\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <div className=\"p-col-12 p-lg-3\">\r\n                <div className=\"card summary\">\r\n                    <span className=\"title\">Utilizadores</span>\r\n                    <span className=\"detail\">Utilizadores registados</span>\r\n                    <span className=\"count blue\">{basicstats?.nb_users}</span>\r\n                </div>\r\n            </div>\r\n            <div className=\"p-col-12 p-lg-3\">\r\n                <div className=\"card summary\">\r\n                    <span className=\"title\">Grupos</span>\r\n                    <span className=\"detail\">Grupos de utilizadores</span>\r\n                    <span className=\"count blue\">{basicstats?.nb_groups}</span>\r\n                </div>\r\n            </div>\r\n            <div className=\"p-col-12 p-lg-3\">\r\n                <div className=\"card summary\">\r\n                    <span className=\"title\">Visualizadores</span>\r\n                    <span className=\"detail\">Incluindo mapas partilhados</span>\r\n                    <span className=\"count orange\">{basicstats?.nb_viewers}</span>\r\n                </div>\r\n            </div>\r\n            <div className=\"p-col-12 p-lg-3\">\r\n                <div className=\"card summary\">\r\n                    <span className=\"title\">Operações</span>\r\n                    <span className=\"detail\">Visitas, plantas, etc...</span>\r\n                    <span className=\"count red\">{basicstats?.nb_ops}</span>\r\n                </div>\r\n            </div>\r\n        </React.Fragment>\r\n    )\r\n}","import React from 'react';\r\nimport { Panel } from 'primereact/panel';\r\n\r\nexport const Contact = (props) => {\r\n\r\n    const {core, name, email, icon} = props;\r\n\r\n    const CLIENT_URL = core.CLIENT_URL;\r\n\r\n    return (\r\n      <button className=\"p-link\">\r\n        <img src={icon ? CLIENT_URL + icon : CLIENT_URL + \"assets/layout/images/avatar_4.png\"} width=\"35\" alt=\"avatar4\" />\r\n        <span className=\"name\">{name}</span>\r\n        <span className=\"email\">{email}</span>\r\n      </button>\r\n    );\r\n}\r\n\r\nexport const ContactList = (props) => {\r\n\r\n  const { core, contacts} = props;\r\n\r\n  return (\r\n    <Panel header=\"Contactos (suporte)\">\r\n      <ul>\r\n          { contacts.map((item, i) =>\r\n              <li key={i}>\r\n                  <Contact core={core} {...item} />\r\n              </li>\r\n          )}\r\n      </ul>\r\n    </Panel>\r\n  );\r\n}\r\n","import React, { useContext } from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { withRouter } from 'react-router-dom'\r\nimport AppContext from \"../../AppContext\";\r\n\r\nimport ViewerVisitsChart from '../components/stats/ViewerVisitsChart';\r\nimport BasicStats from '../components/stats/BasicStats';\r\nimport { ContactList } from '../components/common/Contact';\r\nimport { isAdminOrManager } from '../utils';\r\n\r\n\r\nfunction Dashboard(props) {\r\n\r\n    const { backoffice } = props;\r\n    const { core } = useContext(AppContext);\r\n\r\n    const auth = core.store.getState().auth;\r\n    const adminOrManager = isAdminOrManager(auth);\r\n\r\n    let contacts = null;\r\n    let stats = null;\r\n\r\n    if (backoffice &&  backoffice.config_json) {\r\n        if (backoffice.config_json.contacts) {\r\n            contacts = backoffice.config_json.contacts;\r\n        }\r\n        if (backoffice.config_json.stats) {\r\n            stats = backoffice.config_json.stats;\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-grid p-fluid dashboard\">\r\n            \r\n            { adminOrManager && <BasicStats core={core} /> }\r\n\r\n            <div className={(contacts && contacts.length > 0)  ? \"p-col-12 p-lg-9\" : \"p-col-12\"}>\r\n                <ViewerVisitsChart core={core} stats={stats} />\r\n            </div>\r\n\r\n            { (contacts && contacts.length > 0) ?\r\n            <div className=\"p-col-12 p-lg-3 contacts\">\r\n                <ContactList core={core} contacts={contacts} />\r\n            </div> : null }\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, backoffice: state.backoffice }))(withRouter(Dashboard));","import { fetchJson } from  './fetch'\r\nimport { stringify } from 'query-string';\r\n\r\nconst provider = (apiUrl, httpClient = fetchJson) => ({\r\n\r\n    getSimpleList: (resource) => {\r\n        const url = `${apiUrl}/${resource}`;\r\n        return httpClient(url).then(({ headers, json }) => ({\r\n            data: json.items || json\r\n        }));        \r\n    },\r\n\r\n    getList: (resource, params) => {\r\n        const { page, perPage } = params.pagination;\r\n        const { field, order } = params.sort;\r\n        const query = {\r\n            sort: JSON.stringify([field, order]),\r\n            range: JSON.stringify([(page - 1) * perPage, page * perPage - 1]),\r\n            page: page,\r\n            per_page: perPage,\r\n            filter: JSON.stringify(params.filter),\r\n        };\r\n        const url = `${apiUrl}/${resource}?${stringify(query)}`;\r\n\r\n        return httpClient(url).then(({ headers, json }) => ({\r\n            data: json.items || json,\r\n            //total: parseInt(headers.get('content-range').split('/').pop(), 10),\r\n            total: json.total != null ? json.total : json.length || 0\r\n        }));\r\n    },\r\n\r\n    getOne: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}/${params.id}`).then(({ json }) => ({\r\n            data: json,\r\n        })),\r\n\r\n    getMany: (resource, params) => {\r\n        const query = {\r\n            filter: JSON.stringify({ id: params.ids }),\r\n        };\r\n        const url = `${apiUrl}/${resource}?${stringify(query)}`;\r\n        return httpClient(url).then(({ json }) => ({ \r\n            data: json.items || json,\r\n            total: json.total != null ? json.total : json.length || 0\r\n        }));\r\n    },\r\n\r\n    getManyReference: (resource, params) => {\r\n        const { page, perPage } = params.pagination;\r\n        const { field, order } = params.sort;\r\n        const query = {\r\n            sort: JSON.stringify([field, order]),\r\n            range: JSON.stringify([(page - 1) * perPage, page * perPage - 1]),\r\n            page: page,\r\n            per_page: perPage,            \r\n            filter: JSON.stringify({\r\n                ...params.filter,\r\n                [params.target]: params.id,\r\n            }),\r\n        };\r\n        const url = `${apiUrl}/${resource}?${stringify(query)}`;\r\n\r\n        return httpClient(url).then(({ headers, json }) => ({\r\n            data: json.items || json,\r\n            //total: parseInt(headers.get('content-range').split('/').pop(), 10),\r\n            total: json.total != null ? json.total : json.length || 0\r\n        }));\r\n    },\r\n\r\n    update: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}/${params.id}`, {\r\n            method: 'PUT',\r\n            body: JSON.stringify(params.data),\r\n        }).then(({ json }) => ({ data: json })),\r\n\r\n    updateMany: (resource, params) => {\r\n        const query = {\r\n            filter: JSON.stringify({ id: params.ids}),\r\n        };\r\n        return httpClient(`${apiUrl}/${resource}?${stringify(query)}`, {\r\n            method: 'PUT',\r\n            body: JSON.stringify(params.data),\r\n        }).then(({ json }) => ({ data: json }));\r\n    },\r\n\r\n    create: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}`, {\r\n            method: 'POST',\r\n            body: JSON.stringify(params.data),\r\n        }).then(({ json }) => ({\r\n            data: { ...params.data, id: json.id },\r\n        })),\r\n\r\n    /*\r\n    delete: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}/${params.id}`, {\r\n            method: 'DELETE',\r\n        }).then(({ json }) => ({ data: json })),\r\n    */\r\n    delete: (resource, params) =>\r\n    httpClient(`${apiUrl}/${resource}/${params.id}`, {\r\n        method: 'DELETE',\r\n    }).then(({ json }) => ({ data: { \"id\": params.id} })),    \r\n\r\n    deleteMany: (resource, params) => {\r\n        const query = {\r\n            filter: JSON.stringify({ id: params.ids}),\r\n        };\r\n        return httpClient(`${apiUrl}/${resource}?${stringify(query)}`, {\r\n            method: 'DELETE',\r\n            body: JSON.stringify(params.data),\r\n        }).then(({ json }) => ({ data: json }));\r\n    },\r\n\r\n    getGeometry: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}/${params.feature_id}/geometry`).then(({ json }) => ({\r\n            data: json,\r\n        })),\r\n\r\n    saveGeometry: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}/${params.feature_id}/geometry`, {\r\n            method: 'POST',\r\n            body: JSON.stringify(params.data),\r\n        }).then(({ json }) => ({\r\n            data: { ...params.data, id: json.id },\r\n        })),\r\n\r\n    getDocuments: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}/${params.resource_id}/docs`).then(({ json }) => ({\r\n            data: json,\r\n        })),\r\n        \r\n    getDocument: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}/docs/${params.id}`).then(({ json }) => ({\r\n            data: json,\r\n        })),\r\n        \r\n    createDocument: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}/${params.resource_id}/docs`, {\r\n            method: 'POST',\r\n            body: JSON.stringify(params.data),\r\n        }).then(({ json }) => ({ data: json })),\r\n        \r\n    updateDocument: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}/docs/${params.id}`, {\r\n            method: 'PUT',\r\n            body: JSON.stringify(params.data),\r\n        }).then(({ json }) => ({ data: json })),\r\n        \r\n    deleteDocument: (resource, params) =>\r\n        httpClient(`${apiUrl}/${resource}/docs/${params.id}`, {\r\n            method: 'DELETE',\r\n        }).then(({ json }) => ({ data: { \"id\": params.id} })),           \r\n});\r\n\r\n\r\nexport default provider;","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect, useDispatch } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { Password } from 'primereact/password';\r\nimport { ToggleButton } from 'primereact/togglebutton';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { Calendar } from 'primereact/calendar';\r\nimport { MultiSelect } from 'primereact/multiselect';\r\nimport { ListBox } from 'primereact/listbox';\r\nimport { Message } from 'primereact/message';\r\nimport { classNames } from 'primereact/utils';\r\nimport { v4 as uuidV4 } from 'uuid'\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport useFormFields from '../../useFormFields';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nconst sortRolesArray = (data) => {\r\n  if (!data) return data;\r\n\r\n  return data.sort(function(a, b) {\r\n    if (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\r\n    if (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nconst sortGroupsArray = (data) => {\r\n  if (!data) return data;\r\n\r\n  return data.sort(function(a, b) {\r\n    if (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\r\n    if (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nfunction AccountForm(props) {\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [data, setData] = useState(props.data || {});\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {...data}\r\n  });\r\n\r\n  const goBack = () => {\r\n    const location = {\r\n      pathname: history.location.state.from,\r\n      state: { \r\n        searchParams: {...history.location.state.previousSearchParams}\r\n      }\r\n    }\r\n    history.replace(location);\r\n    //history.goBack();\r\n  }  \r\n\r\n  const onSubmit = (formData) => {\r\n    const new_data = {\r\n      first_name: formData.first_name,\r\n      last_name: formData.last_name,\r\n      name: formData.name,\r\n      username: formData.username,\r\n      email: formData.email,\r\n      password: formData.password || null\r\n    }\r\n\r\n    setIsSaving(true);\r\n\r\n    const provider = dataProvider(API_URL + '/security');      \r\n    if (data.id) {\r\n      const params = {\r\n        id: data.id,\r\n        data: {...new_data}\r\n      }\r\n      provider.update('users', params).then(d => {       \r\n        toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});\r\n        setValue('password', '', {\r\n          shouldValidate: true,\r\n          shouldDirty: true\r\n        });\r\n      }).catch(e => {\r\n        toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});        \r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });\r\n    } else {\r\n      const params = {\r\n        data: {...new_data}\r\n      }\r\n      provider.create('users', params).then(d => {\r\n        setData({...data, id: d.data.id});\r\n        toast.current.show({life: 5000, severity: 'success', summary: 'Criar Registo', detail: 'Registo criada com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Criar Registo', detail: 'Ocorreu um erro ao criar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });       \r\n    }\r\n  };\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      if (errors[name].type === 'required') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Campo obrigatório'}</small>\r\n      } else if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">{errors[name].message || 'O número de caracteres é superior à dimensão máxima permitida'}</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Formato inválido'}</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n \r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n              type=\"submit\" \r\n              label=\"Gravar\"\r\n              icon={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n              disabled={isSaving ? true : false} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n      <Toast ref={toast} baseZIndex={2000} />\r\n\r\n      <div className=\"p-fluid p-formgrid p-grid\">\r\n        <div className=\"p-field p-col-12 p-md-3\">\r\n          <label htmlFor=\"first_name\">Primeiro Nome</label>\r\n          <InputText id=\"first_name\" name=\"first_name\" {...register('first_name')} autoFocus />\r\n        </div>            \r\n        <div className=\"p-field p-col-12 p-md-3\">\r\n          <label htmlFor=\"last_name\">Último Nome</label>\r\n          <InputText id=\"last_name\" name=\"last_name\" {...register('last_name')} />\r\n        </div>\r\n        <div className=\"p-field p-col-12 p-md-6\">\r\n          <label htmlFor=\"name\">Nome</label>\r\n          <InputText id=\"name\" name=\"name\" {...register('name', { required: 'Campo obrigatório.' })} className={classNames({ 'p-invalid': errors.name })} />\r\n          {getFormErrorMessage(errors, 'name')}\r\n        </div>\r\n\r\n        <div className=\"p-field p-col-12 p-md-3\">\r\n          <label htmlFor=\"username\">Username</label>\r\n          <InputText id=\"username\" name=\"username\" {...register('username', { required: 'Campo obrigatório.' })} className={classNames({ 'p-invalid': errors.username })} />\r\n          {getFormErrorMessage(errors, 'username')}\r\n        </div>\r\n        <div className=\"p-field p-col-12 p-md-4\">\r\n          <label htmlFor=\"email\">Email</label>\r\n          <InputText id=\"email\" name=\"email\" {...register('email', { required: 'Campo obrigatório.' })} className={classNames({ 'p-invalid': errors.email })} />\r\n          {getFormErrorMessage(errors, 'email')}\r\n        </div>\r\n        <div className=\"p-field p-col-12 p-md-4\">\r\n          <label htmlFor=\"password\">Password</label>\r\n          <Controller\r\n            control={control}\r\n            name=\"password\"\r\n            render={({ field }) => {\r\n              return <Password {...field} feedback={false}  onChange={(e) => field.onChange(e.target.value)} />\r\n            }} \r\n          />\r\n        </div>\r\n\r\n        <div className=\"p-field p-col-12 p-md-6\">\r\n          <label htmlFor=\"auth_token\">Token de Autenticação</label>\r\n          <div className=\"p-inputgroup\">\r\n              <Button type=\"button\" label=\"Gerar\" icon=\"pi pi-check\" className=\"p-button-primary\" onClick={(e) => { setValue('auth_token', String(uuidV4())); } } />\r\n              <InputText id=\"auth_token\" name=\"auth_token\" {...register('auth_token')} placeholder=\"Token não definido\" />\r\n              <Button type=\"button\" icon=\"pi pi-times\" className=\"p-button-danger\" onClick={(e) => { setValue('auth_token', null); setValue('auth_token_expire', null); } } />                \r\n          </div>\r\n        </div>\r\n        <div className=\"p-field p-col-12 p-md-3\">\r\n          <label htmlFor=\"auth_token_expire\">Data de Validade do Token</label>\r\n          <div className=\"p-inputgroup\">\r\n              <Controller\r\n                control={control}\r\n                name=\"auth_token_expire\"\r\n                render={({ field }) => {              \r\n                  return <Calendar {...field} \r\n                    dateFormat=\"yy-mm-dd\"\r\n                    onChange={(e) => field.onChange(e.target.value)} \r\n                    showIcon showTime showSeconds />\r\n                }} \r\n              />                    \r\n              <Button type=\"button\" icon=\"pi pi-times\" className=\"p-button-danger\" onClick={(e) => setValue('auth_token_expire', null) } />\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n\r\n      <Toolbar className=\"p-mt-4 p-mb-4\" right={rightToolbarTemplate}></Toolbar>\r\n\r\n    </form>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(AccountForm));","import React, { useContext, useState, useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport AccountForm from './AccountForm';\r\n\r\nfunction AccountEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const { id } = useParams();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [record, setRecord] = useState(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/security');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setLoading(true);    \r\n\r\n    provider.getOne('users', params).then(d => {\r\n      const data = {...d.data}\r\n      data.auth_token_expire = data.auth_token && data.auth_token_expire ? new Date(data.auth_token_expire) : null;\r\n      setRecord(data);      \r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      console.log(e);\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n    { record ?      \r\n        <AccountForm data={record} />\r\n      :\r\n      <div>loading...</div>\r\n    }\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(AccountEdit));","import React from 'react'\r\n//import MapModel from '../model/MapModel';\r\n//import OWSModel from '../model/OWSModel';\r\nimport * as Utils from '../utils';\r\nimport dataProvider from '../../service/DataProvider';\r\n\r\nexport default function ModuleManager(props) {\r\n\r\n  const { history, core, backoffice, dispatch, module } = props;\r\n\r\n  return (\r\n    <div>\r\n      { core.renderComponentManager({\r\n        id: module || 'cadastro',\r\n        props: { history, backoffice, dispatch, Models: { Utils }, dataProvider },\r\n        dataProvider: { dataProvider },\r\n        //props: { history, viewer, dispatch, mainMap, Models: { MapModel, OWSModel, Utils } },\r\n        as: 'panel'\r\n      })}\r\n    </div>\r\n  )\r\n\r\n  /*\r\n  return (\r\n    <div style={{display: 'flex', flexDirection: 'row', width: '100%', height: 'calc(100% - 50px)'}}>\r\n      <div id=\"mainmenu\" style={{ width: '58px' }}>\r\n        \r\n        { core.renderMainMenu({\r\n          selected_menu,\r\n          props: { history, viewer, dispatch, mainMap, Models: { Utils } }\r\n          //props: { history, viewer, dispatch, mainMap, Models: { MapModel, OWSModel, Utils } }\r\n        })}\r\n\r\n      </div>\r\n\r\n      <div id=\"content\" style={{ backgroundColor: 'white', color: '#303030', overflowY: 'auto', flex: '1', width: '100%', padding: '5px' }}>\r\n      \r\n        { core.renderComponents({\r\n          id: selected_menu,\r\n          region: 'mainmenu',\r\n          props: { history, viewer, dispatch, mainMap, Models: { Utils } },\r\n          //props: { history, viewer, dispatch, mainMap, Models: { MapModel, OWSModel, Utils } },\r\n          as: 'panel',\r\n          style: getStyle\r\n        })}\r\n\r\n        { core.renderComponents({\r\n          region: 'popup',\r\n          props: { history, viewer, dispatch, mainMap, Models: { Utils } },\r\n          //props: { history, viewer, dispatch, mainMap, Models: { MapModel, OWSModel, Utils } },\r\n          as: 'popup'\r\n        })}\r\n        \r\n      </div>\r\n    </div>\r\n  )\r\n  */\r\n}","import React, { useContext, useState, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { Toast } from 'primereact/toast';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { InputTextarea } from 'primereact/inputtextarea';\r\nimport { Button } from 'primereact/button';\r\nimport { Message } from 'primereact/message';\r\nimport { DataView } from 'primereact/dataview';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nfunction NotificationForm(props) {\r\n\r\n  const { history } = props;\r\n\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [data, setData] = useState(props.data || {});\r\n\r\n  const { core } = useContext(AppContext);\r\n \r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL; \r\n\r\n  const goBack = () => {\r\n    if (history.location.state && history.location.state.from) {\r\n      const location = {\r\n        pathname: history.location.state.from,\r\n        state: { \r\n          searchParams: {...history.location.state.previousSearchParams}\r\n        }\r\n      }\r\n      history.replace(location);\r\n    } else {\r\n      history.goBack();\r\n    }\r\n  }\r\n\r\n  const onCheck = () => {  \r\n    const values = {\r\n      checked: true,\r\n      checked_date: new Date().toISOString().slice(0, 10)\r\n    }\r\n    updateNotification(values);  \r\n  }\r\n\r\n  const onClose = () => {\r\n    const values = {\r\n      closed: true,\r\n      closed_date: new Date().toISOString().slice(0, 10)\r\n    }\r\n    updateNotification(values);\r\n  }\r\n\r\n  const onReopen = () => {\r\n    const values = {\r\n      closed: false,\r\n      closed_date: null\r\n    }\r\n    updateNotification(values);\r\n  }\r\n\r\n  const onSave = () => {\r\n    const values = {\r\n      notes: data.notes\r\n    }\r\n    updateNotification(values);\r\n  }  \r\n\r\n  const updateNotification = (values) => {\r\n    setIsSaving(true); \r\n\r\n    const provider = dataProvider(API_URL + '/portal');      \r\n    const params = {\r\n      id: data.id,\r\n      data: values\r\n    }\r\n    provider.update('notifications', params).then(d => {       \r\n      toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});      \r\n      setData({...d.data});\r\n    }).catch(e => {\r\n      toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});        \r\n    }).finally(() => {\r\n      setIsSaving(false);\r\n    });\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n          <Button\r\n            type=\"button\" \r\n            label=\"Voltar\" \r\n            icon=\"pi pi-left\" \r\n            className=\"p-button-secondary p-mr-4\"\r\n            disabled={isSaving ? true : false} \r\n            onClick={goBack} />\r\n          { data?.status?.value === 0 && <Button\r\n            type=\"button\" \r\n            label=\"Lida\"\r\n            className=\"p-mr-2\"\r\n            icon_={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n            disabled={isSaving ? true : false} \r\n            onClick={onCheck} /> }\r\n          { data?.status?.value !== 2 && <Button\r\n            type=\"button\" \r\n            label=\"Encerrar\"\r\n            className=\"p-mr-2\"\r\n            icon_={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n            disabled={isSaving ? true : false}\r\n            onClick={onClose} /> }\r\n          { data?.status?.value === 2 && <Button\r\n            type=\"button\" \r\n            label=\"Reabrir\"\r\n            className=\"p-mr-2\"\r\n            icon_={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n            disabled={isSaving ? true : false}\r\n            onClick={onReopen} /> }\r\n          <Button\r\n            type=\"button\" \r\n            label=\"Gravar\"\r\n            className=\"p-mr-2\"\r\n            icon_={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n            disabled={isSaving ? true : false}\r\n            onClick={onSave} />\r\n        </React.Fragment>\r\n    )    \r\n  }\r\n  \r\n  const rightToolbarTemplateNone = () => {\r\n    return (\r\n      <React.Fragment>\r\n        <Button\r\n          type=\"button\" \r\n          label=\"Voltar\" \r\n          icon=\"pi pi-left\" \r\n          className=\"p-button-secondary p-mr-4\"\r\n          onClick={goBack} />\r\n      </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const fileTemplate = (file, layout) => {\r\n    if (!file) {\r\n        return;\r\n    }\r\n\r\n    return (\r\n      <>\r\n        <div className=\"p-col p-md-9\">\r\n          <div className=\"p-m-2\">\r\n            <a href={file.url} target=\"_blank\" rel=\"noreferrer\" download={file.filename}>{file.filename}</a>\r\n          </div>\r\n        </div>\r\n        <div className=\"p-col p-md-3\">\r\n          <div className=\"p-m-2 p-text-center\">\r\n            {file.size != null && <span class=\"p-tag p-component p-px-1 p-py-1\">\r\n              <span class=\"p-tag-value\">{(file.size / 1024).toFixed(2) + \" KB\"}</span>\r\n            </span>}\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }  \r\n \r\n  return (\r\n    <React.Fragment>\r\n      <h3>Notificação - Edição</h3>\r\n\r\n      <form>\r\n        <Toast ref={toast} baseZIndex={2000} />\r\n        { data.id ?\r\n        <React.Fragment>\r\n          <div className=\"p-grid p-fluid\">\r\n            <div className=\"p-col p-md-9\">\r\n              <div className=\"p-fluid p-formgrid p-grid\">\r\n                <div className=\"p-field p-col-12 p-md-2\">\r\n                    <label htmlFor=\"id\">Id</label>\r\n                    <InputText id=\"id\" type=\"text\" value={data.id} disabled />\r\n                </div>\r\n                <div className=\"p-field p-col-12 p-md-5\">\r\n                    <label htmlFor=\"name\">Nome</label>\r\n                    <InputText id=\"nam\" type=\"text\" value={DataTransfer.name} disabled />\r\n                </div>\r\n                <div className=\"p-field p-col-12 p-md-5\">\r\n                    <label htmlFor=\"email\">Email</label>\r\n                    <InputText id=\"email\" type=\"text\" value={data.email} disabled />\r\n                </div>\r\n                <div className=\"p-field p-col-12\">\r\n                    <label htmlFor=\"message\">Messagem</label>\r\n                    <InputTextarea id=\"message\" rows={5} value={data.message}  autoResize style={{maxHeight: '250px', opacity: '0.6'}} />\r\n                </div>\r\n                <div className=\"p-field p-col-12\">              \r\n                  <label htmlFor=\"message\">Ficheiros</label>\r\n                  <DataView value={data?.files || []} layout=\"list\" \r\n                    emptyMessage=\"Não tem ficheiros\" itemTemplate={fileTemplate} />                  \r\n                </div>                                                                 \r\n              </div>\r\n            </div>\r\n            <div className=\"p-col p-md-3\">\r\n              <div className=\"p-fluid p-formgrid p-grid\">\r\n                <div className=\"p-field p-col-12\">\r\n                    <label htmlFor=\"viewer\">Visualizador</label>\r\n                    <InputText id=\"viewer\" type=\"text\" value={data.viewer} disabled />\r\n                </div>\r\n                <div className=\"p-field p-col-12\">\r\n                    <label htmlFor=\"date\">Data</label>\r\n                    <InputText id=\"date\" type=\"text\" value={data.date || ''}  disabled />\r\n                </div>                                                \r\n              </div>\r\n            </div>\r\n            <div className=\"p-col p-md-9\">\r\n              <div className=\"p-fluid p-formgrid p-grid\">\r\n                <div className=\"p-field p-col-12\">\r\n                  <label htmlFor=\"notes\">Observações</label>\r\n                  <InputTextarea id=\"notes\" rows={5} autoResize value={data.notes} \r\n                  onChange={(e) => setData({...data, notes: e.target.value})\r\n                  } />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"p-col p-md-3\">\r\n              <div className=\"p-fluid p-formgrid p-grid\">\r\n                  <div className=\"p-field p-col-12\">\r\n                      <label htmlFor=\"read_date\">Data Leitura</label>\r\n                      <InputText id=\"read_date\" type=\"text\" value={data.checked_date || ''} disabled />\r\n                  </div>\r\n                  <div className=\"p-field p-col-12\">\r\n                      <label htmlFor=\"close_date\">Data Encerramento</label>\r\n                      <InputText id=\"close_date\" type=\"text\" value={data.closed_date || ''} disabled />\r\n                  </div>                               \r\n                </div>              \r\n            </div>\r\n          </div>\r\n          <Toolbar className=\"p-mt-2 p-mb-4\" right={rightToolbarTemplate}></Toolbar>\r\n        </React.Fragment>\r\n        :\r\n        <React.Fragment>\r\n          <Message severity=\"error\" text=\"Não foi possível obter os dados da notificação.\" className=\"p-col p-md-12\" />\r\n          <Toolbar className=\"p-mt-2 p-mb-4\" right={rightToolbarTemplateNone}></Toolbar>\r\n        </React.Fragment> }\r\n      </form>\r\n    </React.Fragment>\r\n\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ auth: state.auth }))(withRouter(NotificationForm));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport NotificationForm from './NotificationForm';\r\n\r\nfunction NotificationEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const { id } = useParams();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [record, setRecord] = useState(null);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/portal');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setLoading(true);  \r\n\r\n    provider.getOne('notifications', params).then(d => {\r\n      setRecord(d.data);\r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      setError(true);\r\n      //toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n    { record ?\r\n      <NotificationForm data={record} />\r\n      :\r\n      ( error ?\r\n        <NotificationForm data={null} />\r\n        :\r\n        <div>loading...</div>\r\n      )\r\n    }\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading }))(withRouter(NotificationEdit));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Accordion, AccordionTab } from 'primereact/accordion';\r\nimport { MultiSelect } from 'primereact/multiselect';\r\nimport { Calendar } from 'primereact/calendar';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { Chip } from 'primereact/chip';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { Toast } from 'primereact/toast';\r\n\r\nimport AppContext from '../../../AppContext'\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\n\r\nconst initialSearchParams = {\r\n  filters: {\"status\": [0]},\r\n  first: 0,\r\n  rows: 20,\r\n  page: 0,\r\n  sortField: 'id',\r\n  sortOrder: 1\r\n};\r\n\r\nconst status = [\r\n  {\r\n    value: 0,\r\n    name: 'Por abrir'\r\n  },\r\n  {\r\n    value: 1,\r\n    name: 'Lida'\r\n  },\r\n  {\r\n    value: 2,\r\n    name: 'Encerrado'\r\n  }\r\n];\r\n\r\nfunction NotificationList(props) {\r\n\r\n  const {\r\n    history\r\n  } = props;\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const [viewersOptions,  setViewersOptions] = useState([]);\r\n  const [loading, setLoading] = useState(false);  \r\n  const [records, setRecords] = useState([]);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n\r\n  const [filter, setFilter] = useState(props.filter || {\"status\": [0]});\r\n  const [searchParams, setSearchParams] = useState({...initialSearchParams});\r\n\r\n  const dt = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue, reset } = useForm({\r\n    defaultValues: {...filter}\r\n  });\r\n\r\n  const watchAllFields = watch();\r\n\r\n  useEffect(() => {\r\n    Promise.all([\r\n      dataProvider(API_URL + '/portal').getSimpleList('notifications/viewers/list', {}).catch((error) => error)\r\n    ]).then((result) => {      \r\n      setViewersOptions(result[0].data || []);\r\n    }).catch((error) => {\r\n      console.log(error)\r\n    }); \r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, [searchParams]);\r\n\r\n  const editRecord = (record) => {\r\n    const location = {\r\n      pathname: `/notifications/edit/${record.id}`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);    \r\n  }\r\n\r\n  const exportCSV = () => {\r\n    dt.current.exportCSV();\r\n  }\r\n\r\n  const exportFunction = (e) => {\r\n    if (e.field === 'status') {\r\n      return e.data.label;\r\n    } else if (e.field === 'author') {\r\n      return (e.data.name + (e.data.email ? ` (${e.data.email})` : ''));\r\n    } else {\r\n      return e.data;\r\n    }\r\n  }\r\n\r\n  const loadData = (filters) => {\r\n    const provider = dataProvider(API_URL + '/portal');\r\n  \r\n    const _filter = {};\r\n    if (filters) {\r\n      Object.entries(filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    } else if (searchParams.filters) {\r\n      Object.entries(searchParams.filters).forEach(([key, item]) => {\r\n        if (key && item) _filter[key] = item;\r\n      });\r\n    }\r\n\r\n    const params = {\r\n      pagination: { page: searchParams.page + 1, perPage: searchParams.rows},\r\n      sort: { field: searchParams.sortField, order: searchParams.sortOrder === -1 ? 'Desc' : 'Asc' },\r\n      filter: _filter\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    provider.getList('notifications', params).then(d => {\r\n      setSelectedRecords(null);\r\n      const data = d.data.map(x => {return {...x, author:{name: x.name, email: x.email}}});\r\n      setRecords({ ...d, data, page: searchParams.page });\r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      if (toast?.current?.show) {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Notificações', detail: 'Ocorreu um erro na pesquisa'});\r\n      }\r\n    });\r\n  }\r\n\r\n  const onPage = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onSort = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onFilterSubmit = (formData) => {\r\n    let _searchParams = { ...searchParams };\r\n    _searchParams.filters = {...formData};\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onFilterClear = (e) => {\r\n    setValue('id', null);\r\n    setValue('author', null);\r\n    setValue('viewer', null);\r\n    setValue('start_date', null);\r\n    setValue('end_date', null);\r\n    setValue('message', null);\r\n    setValue('status', null);\r\n    \r\n    let _searchParams = { ...searchParams };\r\n    _searchParams['filters'] = {};\r\n    _searchParams['first'] = 0;\r\n    setSearchParams(_searchParams);\r\n  }  \r\n\r\n  const filterViewersFooterTemplate = () => {\r\n    const selectedItems = watchAllFields.viewer;\r\n    const length = selectedItems ? selectedItems.length : 0;\r\n    return (\r\n        <div className=\"p-py-2 p-px-3\">\r\n            <b>{length}</b> selecionado{length > 1 ? 's' : ''}\r\n        </div>\r\n    );\r\n  }  \r\n\r\n  const viewerTemplate = (rowData) => {\r\n    return rowData.viewer ? <Chip label={rowData.viewer} /> : null;\r\n  }\r\n\r\n  const messageTemplate = (rowData) => {\r\n    const message = rowData.message || '';\r\n    return message.length > 50 ? `${message.slice(0, 50)}...` : message;\r\n  }\r\n\r\n  const authorTemplate = (rowData) => {\r\n    return (<>\r\n        {rowData.name && <span>{rowData.name}</span>}\r\n        {rowData.name && rowData.email ? <br /> : null}\r\n        {rowData.email && <span style={{color: '#707070', fontSize: '.9rem'}}>{rowData.email}</span>}\r\n      </>)\r\n  }  \r\n\r\n  const statusTemplate = (rowData) => {\r\n    const status = rowData.status || {}\r\n\r\n    if (status.value === 0) {\r\n      return <span className=\"badge badge-danger\" title={`${status.label || 'Por abrir'}`}><i className=\"fas fa-envelope\"></i></span>\r\n    } else if (status.value === 1) {\r\n      return <span className=\"badge badge-warning\" title={`${status.label || 'Lida'} (${status.date})`}><i className=\"fas fa-envelope-open\"></i></span>\r\n    } else if (status.value === 2) {\r\n      return <span className=\"badge badge-success\" title={`${status.label || 'Encerrada'} (${status.date})`}><i className=\"fas fa-check\"></i></span>\r\n    }\r\n\r\n    return null;    \r\n  }\r\n\r\n  const leftToolbarTemplate = () => {\r\n    return (\r\n        (records.total !== null) && <React.Fragment>              \r\n            <span><b>Total:</b> {records.total}</span>\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n      return (\r\n          <React.Fragment>              \r\n              <Button label=\"Exportar\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} disabled={records?.total ? false : true } />\r\n          </React.Fragment>\r\n      )\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    return (\r\n      <React.Fragment> \r\n        <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-outlined p-button-secondary p-mr-2\" title=\"Editar\" onClick={() => editRecord(rowData)} />\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"p-col-12\"><h3>Notificações</h3></div>\r\n\r\n      <div className=\"p-grid p-fluid notification-list\">\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n          <div className=\"card\">\r\n            <Accordion activeIndex={0}>\r\n                <AccordionTab header=\"Filtro\">\r\n                  <form onSubmit={handleSubmit(onFilterSubmit)}>\r\n                    <div className=\"p-fluid p-formgrid p-grid\">\r\n                      <div className=\"p-field p-col-12 p-md-1\">\r\n                          <label htmlFor=\"id\">Id</label>\r\n                          <InputText id=\"id\" type=\"text\" {...register('id')} />\r\n                      </div>\r\n                      <div className=\"p-field p-col-12 p-md-7\">\r\n                          <label htmlFor=\"viewer\">Visualizador</label>\r\n                          <Controller\r\n                              control={control}\r\n                              name=\"viewer\"\r\n                              render={({ field }) => {\r\n                                return <MultiSelect \r\n                                optionLabel=\"name\"\r\n                                optionValue=\"id\" \r\n                                value={field.value}\r\n                                options={viewersOptions}\r\n                                filter \r\n                                showClear\r\n                                showSelectAll={false}\r\n                                display=\"chip\"\r\n                                onChange={(e) => { field.onChange(e.target.value); }} \r\n                                panelFooterTemplate={filterViewersFooterTemplate}\r\n                                className=\"filter-multiselect\"\r\n                                style={{ minHeight: '2.5rem', maxHeight: '2.5rem'}} />                                                        \r\n                              }} \r\n                            />\r\n                      </div>\r\n                      <div className=\"p-field p-col-12 p-md-2\">\r\n                          <label htmlFor=\"start_date\">Data envio (início)</label>\r\n                          <Controller\r\n                              control={control}\r\n                              name=\"start_date\"\r\n                              render={({ field }) => {\r\n                                return <Calendar value={field.value} \r\n                                onChange={(e) => {field.onChange(e.target.value)}}\r\n                                dateFormat=\"dd/mm/yy\" mask=\"99/99/9999\" placeholder=\"dd/mm/aaaa\"/>                                                                                       \r\n                              }} \r\n                            />\r\n                      </div>\r\n                      <div className=\"p-field p-col-12 p-md-2\">\r\n                          <label htmlFor=\"end_date\">Data envio (fim)</label>\r\n                          <Controller\r\n                              control={control}\r\n                              name=\"end_date\"\r\n                              render={({ field }) => {\r\n                                return <Calendar value={field.value} \r\n                                onChange={(e) => {field.onChange(e.target.value)}}\r\n                                dateFormat=\"dd/mm/yy\" mask=\"99/99/9999\" placeholder=\"dd/mm/aaaa\"/>                                                                                       \r\n                              }} \r\n                            />\r\n                      </div>                    \r\n                      <div className=\"p-field p-col-12 p-md-4\">\r\n                          <label htmlFor=\"author\">Autor</label>\r\n                          <InputText id=\"author\" type=\"text\" {...register('author')} />\r\n                      </div>\r\n                      <div className=\"p-field p-col-12 p-md-4\">\r\n                          <label htmlFor=\"status\">Mensagem</label>\r\n                          <InputText id=\"message\" type=\"text\" {...register('message')} />\r\n                      </div>                      \r\n                      <div className=\"p-field p-col-12 p-md-4\">\r\n                          <label htmlFor=\"status\">Estado</label>\r\n                          <Controller\r\n                              control={control}\r\n                              name=\"status\"\r\n                              render={({ field }) => {\r\n                                return <MultiSelect \r\n                                optionLabel=\"name\" \r\n                                optionValue=\"value\"\r\n                                options={status}\r\n                                value={field.value}                                 \r\n                                showClear\r\n                                showSelectAll={false}\r\n                                display=\"chip\" \r\n                                onChange={(e) => field.onChange(e.target.value)}\r\n                                className=\"filter-multiselect\"\r\n                                style={{ minHeight: '2.5rem', maxHeight: '2.5rem'}} />                                                        \r\n                              }} \r\n                            />\r\n                      </div>                     \r\n                    </div>\r\n                    <div className=\"p-fluid p-formgrid p-grid p-justify-end\">\r\n                      <div className=\"p-field p-col-12 p-md-2\">\r\n                        <Button type=\"submit\" label=\"Pesquisar\" className=\"p-mr-2\" />  \r\n                      </div>                                  \r\n                      <div className=\"p-field p-col-12 p-md-2\">\r\n                        <Button type=\"button\" label=\"Limpar\" className=\"p-button-secondary p-mr-2\" onClick={onFilterClear} />\r\n                      </div>                   \r\n                    </div>\r\n                    </form>\r\n                </AccordionTab>\r\n            </Accordion>\r\n\r\n            <Toolbar className=\"p-mt-2\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n            <DataTable ref={dt} value={records ? records.data : []} lazy\r\n                selectionMode=\"checkbox\"\r\n                selection={selectedRecords} onSelectionChange={(e) => setSelectedRecords(e.value)}\r\n                paginator first={searchParams.first} rows={searchParams.rows} totalRecords={records.total} onPage={onPage}\r\n                onSort={onSort} sortField={searchParams.sortField} sortOrder={searchParams.sortOrder}\r\n                loading={loading} exportFunction={exportFunction} exportFilename=\"notificacoes\"\r\n                emptyMessage=\"Não foram encontradas notificações.\" >\r\n                <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n                <Column field=\"id\" header=\"Id\" sortable headerStyle={{ width: '6rem' }} />\r\n                <Column field=\"date\" header=\"Data\" sortable headerStyle={{ width: '8rem' }} />\r\n                <Column field=\"viewer\" header=\"Visualizador\" sortable sortField='viewer' body={viewerTemplate} headerStyle={{ width: '9rem' }} style={{ textAlign: 'center'}} />\r\n                <Column field=\"author\" header=\"Autor\" sortable sortField='name' body={authorTemplate} style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column field=\"message\" header=\"Mensagem\" body={messageTemplate} />\r\n                <Column field=\"status\" header=\"Estado\" body={statusTemplate} headerStyle={{ width: '6rem' }} style={{ textAlign: 'center'}} />\r\n                <Column body={actionBodyTemplate} headerStyle={{ width: '8rem' }} />\r\n            </DataTable>             \r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, filters: state.filters }))(withRouter(NotificationList));","export const ReorderGroups = (list, startIndex, endIndex) => {\r\n  const result_array = Object.entries(list).map((f,i) => {\r\n    return {id: f[0], ...f[1]}\r\n  });\r\n  const [removed] = result_array.splice(startIndex, 1);\r\n  result_array.splice(endIndex, 0, removed);\r\n\r\n  const result = {}\r\n  result_array.forEach((r) => {\r\n    result[r.id] = {active: r.active, title: r.title, fields: r.fields};\r\n  });\r\n\r\n  return result;  \r\n};\r\n\r\nexport const ReorderFields = (list, startIndex, endIndex) => {\r\n  const result = Object.entries(list).map((f,i) => {\r\n    return {id: f[0], ...f[1]}\r\n  });\r\n  const [removed] = result.splice(startIndex, 1);\r\n  result.splice(endIndex, 0, removed);\r\n\r\n  const fields = {}\r\n  result.forEach((r) => {\r\n    fields[r.id] = {active: r.active, required: r.required, title: r.title};\r\n  });\r\n\r\n  return fields;\r\n};\r\n\r\nconst grid = 4;\r\nexport const getItemStyle = (isDragging, draggableStyle) => {\r\n  return {\r\n    // some basic styles to make the items look a bit nicer\r\n    userSelect: \"none\",\r\n    padding: grid * 2,\r\n    margin: `0 0 ${grid * 2}px 0`,\r\n\r\n    // change background colour if dragging\r\n    background: isDragging ? \"lightblue\" : \"none\",\r\n\r\n    // styles we need to apply on draggables\r\n    ...draggableStyle\r\n  };\r\n};\r\n\r\nexport const getGroupListStyle = isDraggingOver => ({\r\n  background: isDraggingOver ? \"lightgray\" : \"none\",\r\n  padding: 8,\r\n  //width: 350\r\n});\r\n\r\nexport const getFieldListStyle = isDraggingOver => ({\r\n  background: isDraggingOver ? \"lightgray\" : \"none\",\r\n  padding: 4,\r\n  //width: 250\r\n});","import React, { useState, useEffect, Component } from \"react\";\r\nimport { Button } from 'primereact/button';\r\nimport { confirmPopup } from 'primereact/confirmpopup';\r\nimport { Panel } from 'primereact/panel';\r\nimport { Message } from 'primereact/message';\r\nimport { MultiSelect } from 'primereact/multiselect';\r\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\r\nimport { getItemStyle, getFieldListStyle } from \"./utils\";\r\n\r\n\r\nfunction RecordSelector(props) {\r\n\r\n  const [records, setRecords] = useState(props?.data ? [...props.data] : []);\r\n\r\n  const [availableRecords, setAvailableRecords] = useState(props.list || []);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n  const [filterValue, setFilterValue] = useState('');\r\n\r\n  useEffect(() => {\r\n    setAvailableRecords([...props.list]);\r\n  }, [props.list]);\r\n\r\n  useEffect(() => {\r\n    setRecords([...props.data]);\r\n  }, [props.data]);\r\n\r\n\r\n  const addRecords = () => {\r\n    if (!availableRecords) return;\r\n\r\n    let new_records = availableRecords.filter(v => selectedRecords.includes(v.id));\r\n    new_records = [...new_records, ...props.data];\r\n    console.log(new_records);\r\n    props.onChange(new_records);\r\n\r\n    setSelectedRecords(null);\r\n  } \r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"p-card p-p-2\">\r\n        <div className=\"p-field p-col-12 p-pl-0\">\r\n          <MultiSelect value={selectedRecords || []} \r\n            options={(availableRecords || []).filter(p => !(records || []).map(f=>f.id).includes(p.id))} \r\n            optionLabel=\"title\" optionValue=\"id\" display=\"chip\" showClear \r\n            filter filterValue={filterValue} \r\n            onFilterValueChange={(e) => setFilterValue(e.value)}\r\n            onChange={(e) => setSelectedRecords(e.value)} placeholder=\"Selecionar\" />\r\n        </div>              \r\n        <div className=\"p-grid\">\r\n          <div className=\"p-col\"></div>\r\n          <div className=\"p-col\">\r\n              <Button label=\"Adicionar\" type=\"button\" \r\n                disabled={(!selectedRecords || selectedRecords.length === 0)}\r\n              onClick={addRecords} />\r\n          </div>\r\n          <div className=\"p-col\"></div>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nconst ListChilds = props => {\r\n\r\n  const { type } = props;\r\n  const list = props.data;\r\n\r\n  if (!list || list.length === 0) {\r\n    return (\r\n      <div>\r\n        <Message severity=\"info\" text=\"Selecione uma ou mais opções e clique em 'Adicionar'\" />\r\n      </div>\r\n    )\r\n  } else {\r\n    return (\r\n      <DragDropContext\r\n        onDragEnd={(result) => {\r\n          // dropped outside the list\r\n          if (!result.destination) return;\r\n    \r\n          const new_list = [...list];\r\n          var element = new_list[result.source.index];\r\n          new_list.splice(result.source.index, 1);\r\n          new_list.splice(result.destination.index, 0, element);\r\n    \r\n          props.onChange(new_list);\r\n        }}\r\n        //onDragUpdate={}\r\n      >\r\n        <Droppable droppableId=\"droppable\" type={type}>\r\n          {(provided, snapshot) => (\r\n            <div\r\n              ref={provided.innerRef}\r\n              style={getFieldListStyle(snapshot.isDraggingOver)}\r\n            >\r\n    \r\n              {list.map((item, index) => (\r\n                <Draggable\r\n                  key={item.id.toString()}\r\n                  draggableId={item.id.toString()}\r\n                  index={index}\r\n                  style={{ \"border\": \"solid 1px lightgray\", marginTop: 3 }}                  \r\n                >\r\n                  {(provided, snapshot) => (\r\n                    <div\r\n                      ref={provided.innerRef}\r\n                      {...provided.draggableProps}\r\n                      style={getItemStyle(\r\n                        snapshot.isDragging,\r\n                        provided.draggableProps.style\r\n                      )}\r\n                      className=\"p-shadow-1\"\r\n                    >\r\n                    <div style={{marginBottom: 5 }}>\r\n                      <div style={{ float: \"left\", paddingTop: 6 }}>\r\n                        <span style={{paddingLeft: \"15px\"}}>{item.code}</span>\r\n                        <span {...provided.dragHandleProps}>\r\n                          <i className=\"fas fa-arrows-alt\" style={{ float: \"left\", \"paddingTop\": 3 }}></i>\r\n                        </span>\r\n                      </div>\r\n                      <div style={{ textAlign: \"right\" }}>\r\n                        <Button type=\"text\" icon=\"pi pi-times\" \r\n                          className=\"p-button-rounded p-button-text p-button-danger\"\r\n                          tooltip=\"Remover\"\r\n                          tooltipOptions={{position: 'bottom'}}                            \r\n                          onClick={ (e) => {\r\n                            e.preventDefault();\r\n                            confirmPopup({\r\n                                target: e.currentTarget,\r\n                                message: 'Tem a certeza que pretende remover?',\r\n                                icon: 'pi pi-exclamation-triangle',\r\n                                acceptLabel: 'Sim',\r\n                                rejectLabel: 'Não',\r\n                                accept: () => {                                      \r\n                                  const new_prints = list.filter(p => p.id !== item.id);\r\n                                  props.onChange(new_prints);\r\n                                }\r\n                            });\r\n                          }} />                               \r\n                        </div>\r\n                      </div>\r\n    \r\n                      <div className=\"p-fluid p-pt-2\">\r\n                        <div className=\"p-field p-grid p-mb-0\">\r\n                          <div class=\"p-col-12\">\r\n                            <div className=\"p-grid\">\r\n                              <label className=\"p-col-12 p-md-2\"><strong>Título: </strong></label>\r\n                              <div className=\"p-col-12 p-md-10\">\r\n                                  <span>{item.title}</span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>                                      \r\n                      </div>\r\n    \r\n                    </div>\r\n                  )}\r\n                </Draggable>\r\n              ))}\r\n              {provided.placeholder}\r\n            </div>\r\n          )}\r\n        </Droppable>\r\n      </DragDropContext>  \r\n    );    \r\n  }\r\n  \r\n};\r\n\r\nclass PrintGroupChildsEditor extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      data: props.data || {},\r\n      printsList: props.printsList || [],\r\n      groupsList: props.groupsList || [],\r\n      showGroupForm: false,\r\n      showFieldForm: false,\r\n    };\r\n\r\n    this.onChange = props.onChange.bind(this);\r\n    this.onPrintsChange = this.onPrintsChange.bind(this);\r\n    this.onGroupsChange = this.onGroupsChange.bind(this); \r\n  }\r\n\r\n  componentWillReceiveProps(props) {\r\n    this.setState({ data: props.data });\r\n  }\r\n\r\n  /*\r\n  componentDidUpdate() {\r\n  }\r\n  */\r\n\r\n  onGroupsChange(groups) {\r\n    console.log(groups);\r\n    this.onChange({...this.state.data, groups: [...groups]});\r\n  }\r\n\r\n  onPrintsChange(prints) {\r\n    console.log(prints);\r\n    this.onChange({...this.state.data, prints: [...prints]});\r\n  } \r\n\r\n\r\n  render() {\r\n    return (\r\n\r\n      <div className=\"p-fluid p-formgrid p-grid\">\r\n\r\n        <div className=\"p-field p-col-12 p-md-6\">\r\n          <Panel header=\"Plantas\">\r\n            <div class=\"p-col-12\">\r\n              <div className=\"p-grid p-mb-4\">\r\n                <div className=\"p-col-12\">\r\n                  <RecordSelector \r\n                    data={this.state.data.prints}\r\n                    list={this.state.printsList}\r\n                    onChange={(data) => {\r\n                      this.onPrintsChange(data);\r\n                    }}\r\n                  />\r\n                </div>               \r\n              </div>\r\n              <div className=\"p-grid\">\r\n                <div className=\"p-col-12\">\r\n                  <div className=\"p-card p-p-2\">\r\n                    <ListChilds\r\n                      data={this.state.data.prints}\r\n                      type=\"PRINTS\"\r\n                      onChange={(data) => {\r\n                        this.onPrintsChange(data);                     \r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>           \r\n          </Panel>          \r\n        </div>\r\n\r\n        <div className=\"p-field p-col-12 p-md-6\">\r\n          <Panel header=\"Grupos\">\r\n            <div class=\"p-col-12\">\r\n              <div className=\"p-grid p-mb-4\">\r\n                <div className=\"p-col-12\">\r\n                  <RecordSelector \r\n                    data={this.state.data.groups}\r\n                    list={this.state.groupsList}\r\n                    onChange={(data) => {\r\n                      this.onGroupsChange(data);\r\n                    }}\r\n                  />\r\n                </div>               \r\n              </div>\r\n              <div className=\"p-grid\">\r\n                <div className=\"p-col-12\">\r\n                  <div className=\"p-card p-p-2\">\r\n                    <ListChilds\r\n                      data={this.state.data.groups}\r\n                      type=\"GROUPS\"\r\n                      onChange={(data) => {\r\n                        this.onGroupsChange(data);                      \r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>           \r\n          </Panel>\r\n        </div>\r\n        \r\n      </div>\r\n\r\n    );\r\n  }\r\n}\r\n\r\nexport default PrintGroupChildsEditor;","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { TabMenu } from 'primereact/tabmenu';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { Chips} from 'primereact/chips';\r\nimport { Button } from 'primereact/button';\r\nimport { ToggleButton } from 'primereact/togglebutton';\r\nimport { MultiSelect } from 'primereact/multiselect';\r\nimport { ListBox } from 'primereact/listbox';\r\nimport { Message } from 'primereact/message';\r\nimport { OverlayPanel } from 'primereact/overlaypanel';\r\nimport { Column } from 'primereact/column';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { BlockUI } from 'primereact/blockui';\r\n\r\nimport AceEditor from \"react-ace\";\r\nimport \"ace-builds/src-noconflict/mode-json\";\r\nimport \"ace-builds/src-noconflict/theme-github\";\r\nimport \"ace-builds/src-noconflict/mode-css\";\r\nimport 'ace-builds/src-noconflict/ext-searchbox';\r\n\r\nimport { classNames } from 'primereact/utils';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\nimport { isAdminOrManager } from '../../utils';\r\n\r\nimport PrintGroupChildsEditor from \"../common/PrintGroupChildsEditor\";\r\n\r\n\r\nconst sortRolesArray = (data) => {\r\n  if (!data) return data;\r\n\r\n  return data.sort(function(a, b) {\r\n    if (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\r\n    if (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nconst tabItems = [\r\n  { label: 'Dados Base', icon: 'pi pi-fw pi-home' },\r\n  { label: 'UI', icon: 'pi pi-fw pi-home' },\r\n  { label: 'Configuração', icon: 'pi pi-fw pi-cog' },\r\n  { label: 'Plantas', icon: 'pi pi-fw pi-print' }\r\n];\r\n\r\n\r\nfunction ViewerForm(props) {\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [activeIndex, setActiveIndex] = useState(0);\r\n\r\n  const [data, setData] = useState(props.data || {});\r\n\r\n  const [configJson, setConfigJson] = useState(data?.config_json ? JSON.stringify(data.config_json, null, 2) : '{}');\r\n  const [manifestJson, setManifestJson] = useState(data?.manifest_json ? JSON.stringify(data.manifest_json, null, 2) : null);\r\n  const [customStyle, setCustomStyle] = useState(data?.custom_style ? data.custom_style : null);\r\n\r\n  const [roles, setRoles] = useState(props?.data?.roles ? sortRolesArray([...props.data.roles]) : []);\r\n  const [availableRoles, setAvailableRoles] = useState(null);\r\n  const [selectedRoles, setSelectedRoles] = useState(null);\r\n  const [removedRoles, setRemovedRoles] = useState(null);\r\n  const [filterRolesValue, setFilterRolesValue] = useState('');\r\n\r\n  const [availableUsers, setAvailableUsers] = useState(null);\r\n  const [selectedOwner, setSelectedOwner] = useState(data?.owner ? { id: data.owner.id, username: data.owner.username, name: data.owner.name, active: data.owner.active } : null);\r\n\r\n  const [printsList, setPrintsList] = useState([]);\r\n  const [groupsList, setGroupsList] = useState([]);\r\n  const [printChilds, setPrintChilds] = useState({ prints: props.data?.prints || [], groups: props.data?.print_groups || [] });\r\n\r\n\r\n  const [customStyleEditorSearchText, setCustomStyleEditorSearchText] = useState(null);\r\n  const [jsonConfigEditorSearchText, setJsonConfigEditorSearchText] = useState(null);  \r\n\r\n  const toast = useRef(null);\r\n  const op = useRef(null);\r\n  const jsonManifestEditor = useRef(null);\r\n  const customStyleEditor = useRef(null);\r\n  const jsonConfigEditor = useRef(null);\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const adminOrManager = isAdminOrManager(props.auth);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  /*\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {name: props.data.name, title: props.data.title, slug: props.data.slug,\r\n      keywords: props.data.keywords}\r\n  });\r\n  */\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {...data}\r\n  });  \r\n\r\n  useEffect(() => {\r\n    const params = {\r\n      pagination: { page: 1, perPage: 1000},\r\n      sort: { field: 'name', order: 'Asc' },\r\n      filter: {}\r\n    }\r\n\r\n    const params_print_groups = {\r\n      pagination: { page: 1, perPage: 1000},\r\n      sort: { field: 'title', order: 'Asc' },\r\n      filter: {}\r\n    }\r\n    \r\n    setIsLoading(true);\r\n\r\n    Promise.all([\r\n      dataProvider(API_URL + '/security').getList('roles', params).catch((error) => error),\r\n      dataProvider(API_URL + '/security').getList('users', params).catch((error) => error),\r\n      dataProvider(API_URL + '/portal').getList('prints', params).catch((error) => error),\r\n      dataProvider(API_URL + '/portal').getList('prints/groups', params_print_groups).catch((error) => error)      \r\n    ]).then((result) => {      \r\n      const roles_result = result[0];\r\n      const rids = props?.data?.roles ? props.data.roles.map(v => v.id) : [];\r\n      setAvailableRoles(sortRolesArray(roles_result.data.filter(v => !rids.includes(v.id))\r\n        .map(r => { return { id: r.id, name: r.name} })));\r\n\r\n      setAvailableUsers(result[1].data.map( u => { return { id: u.id, username: u.username, name: u.name, active: u.active}}));\r\n\r\n      if (!(props?.data?.id)) {\r\n        const owner = result[1].data.find(u => u.email === props.auth.data.username);\r\n        if (owner) {\r\n          setSelectedOwner({ id: owner.id, username: owner.username, name: owner.name, active: owner.active});\r\n        }\r\n      }\r\n\r\n      const prints_result = result[2]?.data || [];\r\n      setPrintsList(prints_result);      \r\n      const groups_result = result[3]?.data || [];\r\n      setGroupsList(groups_result);\r\n      \r\n      setIsLoading(false);\r\n\r\n    }).catch((error) => {\r\n      setIsLoading(false);\r\n      //console.log(error)\r\n    });    \r\n  }, []);\r\n\r\n  const addRoles = () => {\r\n    if (!availableRoles) return;\r\n    \r\n    const new_roles = availableRoles.filter(v => selectedRoles.includes(v.id));\r\n    const new_available_roles = availableRoles.filter(v => !selectedRoles.includes(v.id));\r\n\r\n    setRoles(sortRolesArray([...roles, ...new_roles]));\r\n    setAvailableRoles(sortRolesArray([...new_available_roles]));\r\n    setSelectedRoles(null);\r\n    setRemovedRoles(null);\r\n  }\r\n\r\n  const removeRoles = () => {\r\n    if (!removedRoles) return;\r\n    \r\n    const new_available_roles = roles.filter(v => removedRoles.includes(v.id));\r\n    const new_roles = roles.filter(v => !removedRoles.includes(v.id));\r\n\r\n    setRoles(sortRolesArray([...new_roles]));\r\n    setAvailableRoles(sortRolesArray([...availableRoles, ...new_available_roles]));\r\n    setRemovedRoles(null);\r\n    setSelectedRoles(null);\r\n  } \r\n\r\n  const goBack = () => {\r\n    if (history.location.state && history.location.state.from) {\r\n      const location = {\r\n        pathname: history.location.state.from,\r\n        state: { \r\n          searchParams: {...history.location.state.previousSearchParams}\r\n        }\r\n      }\r\n      history.replace(location);\r\n    } else {\r\n      history.goBack();\r\n    }\r\n  }  \r\n\r\n  const onSubmit = (formData) => {\r\n    let manifest_json = null;\r\n    let config_json = null;\r\n\r\n    try {\r\n      manifest_json = manifestJson ?  JSON.parse(manifestJson) : null;\r\n    } catch (e) {\r\n        return false;\r\n    }    \r\n\r\n    try {\r\n      config_json = JSON.parse(configJson);\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n\r\n    const new_data = { \r\n      //...formData,\r\n      id: formData.id,\r\n      name: formData.name,\r\n      title: formData.title,\r\n      description: formData.description,\r\n      slug: formData.slug,\r\n      keywords: formData.keywords,\r\n      is_active: formData.is_active,\r\n      show_help: formData.show_help,\r\n      show_credits: formData.show_credits,\r\n      show_contact: formData.show_contact,\r\n      on_homepage: formData.on_homepage,\r\n      img_icon: formData.img_icon ? formData.img_icon : null,\r\n      img_logo: formData.img_logo ? formData.img_logo : null,\r\n      manifest_json: manifest_json,\r\n      custom_style: customStyle ? customStyle : null,\r\n      config_json: config_json,\r\n      owner_id: selectedOwner ? selectedOwner.id : null,\r\n      roles: roles ? roles.map(r => r.id) : [],\r\n      prints: printChilds?.prints ? printChilds.prints : [],\r\n      print_groups: printChilds?.groups ? printChilds.groups : []      \r\n    }    \r\n\r\n    setIsSaving(true);\r\n\r\n    const provider = dataProvider(API_URL + '/portal');      \r\n    if (data.id) {\r\n      const params = {\r\n        id: data.id,\r\n        data: {...new_data}\r\n      }\r\n      provider.update('viewers', params).then(d => {       \r\n        toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});\r\n\r\n      }).catch(e => {\r\n        toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});        \r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });\r\n    } else {\r\n      const params = {\r\n        data: {...new_data}\r\n      }\r\n      provider.create('viewers', params).then(d => {\r\n        setData({...data, id: d.data.id});\r\n        toast.current.show({life: 5000, severity: 'success', summary: 'Criar Registo', detail: 'Registo criada com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Criar Registo', detail: 'Ocorreu um erro ao criar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });       \r\n    }    \r\n  };\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">O número de caracteres é superior à dimensão máxima permitida</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">Formato não permitido</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n              type=\"button\" \r\n              label=\"Voltar\" \r\n              icon=\"pi pi-left\" \r\n              className=\"p-button-secondary p-mr-4\"\r\n              disabled={isSaving ? true : false} \r\n              onClick={goBack} />\r\n            <Button\r\n              type=\"submit\" \r\n              label=\"Gravar\"\r\n              icon={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n              disabled={isSaving ? true : false} />\r\n        </React.Fragment>\r\n    )\r\n  }  \r\n \r\n  return (\r\n    <React.Fragment>   \r\n\r\n      <BlockUI blocked={isLoading}\r\n        template={<i class=\"p-blockui-loading-icon pi-spin pi pi-spinner\"></i>} >\r\n\r\n        <TabMenu model={tabItems} activeIndex={activeIndex} onTabChange={(e) => setActiveIndex(e.index)} />\r\n\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n\r\n          {activeIndex === 0 ?\r\n\r\n            <div className=\"card\">\r\n\r\n              <div className=\"p-fluid p-formgrid p-grid\">\r\n\r\n                <div className=\"p-field p-col-3\">\r\n                  <label htmlFor=\"id\">Id</label>\r\n                  <InputText id=\"id\" type=\"text\" value={data.id || ''} />\r\n                </div>\r\n\r\n                <div className=\"p-field p-col-4\">\r\n                  <label>&nbsp;</label>\r\n                  <Controller\r\n                    control={control}\r\n                    name=\"is_active\"\r\n                    render={({ field }) => {\r\n                      return <ToggleButton {...field} checked={field.value} onChange={(e) => field.onChange(e.target.value)} onLabel=\"Mapa Ativo\" offLabel=\"Mapa Não Ativo\" onIcon=\"pi pi-check\" offIcon=\"pi pi-times\" />\r\n                    }} \r\n                  />                   \r\n                </div>\r\n                \r\n                { adminOrManager &&\r\n                <div className=\"p-field p-col-4\">\r\n                  <label>Dono</label>\r\n                  <div>                \r\n                      <div className=\"p-inputgroup\">\r\n                        { selectedOwner?.id > 0 ?\r\n                          <React.Fragment>\r\n                            <span className=\"p-inputgroup-addon\"><i className={ selectedOwner.active ? \"fas fa-user-alt\" : \"fas fa-user-alt-slash\" }></i></span>\r\n                            <span className=\"p-inputgroup-addon\">{selectedOwner.name} ({selectedOwner.username})</span>\r\n                          </React.Fragment>\r\n                          :\r\n                          <React.Fragment>\r\n                            <span className=\"p-inputgroup-addon\"><i className=\"far fa-user\"></i></span>\r\n                            <span className=\"p-inputgroup-addon\">Anómimo</span>\r\n                          </React.Fragment>\r\n                        }\r\n                        <Button type=\"button\" tooltip=\"Alterar\" icon=\"fas fa-user-edit\" className=\"p-button-primary\"\r\n                          onClick={(e) => { op.current.toggle(e); }}/>\r\n                        \r\n                        { (selectedOwner?.id > 0) &&\r\n                          <Button type=\"button\" icon=\"pi pi-times\" className=\"p-button-danger\" \r\n                            onClick={(e) => { setSelectedOwner(null); }} />\r\n                        }\r\n\r\n                        <OverlayPanel ref={op} showCloseIcon id=\"overlay_panel\" breakpoints={{'960px': '75vw', '640px': '100vw'}} style={{width: '450px'}} className=\"overlaypanel-demo\">\r\n                          <div className=\"p-fluid\">\r\n                              <div className=\"p-field\">\r\n                                  <label htmlFor=\"observacoes\">Utilizadores</label>\r\n                                  <DataTable value={availableUsers} selectionMode=\"single\" paginator rows={10}\r\n                                    selection={selectedOwner}\r\n                                    onSelectionChange={ e=> { setSelectedOwner({...e.value}); op.current.hide(); }}>\r\n                                    <Column field=\"username\" header=\"Username\" sortable filter filterMatchMode=\"contains\" />\r\n                                    <Column field=\"name\" header=\"Nome\" sortable filter filterMatchMode=\"contains\" />\r\n                                </DataTable>                                \r\n                              </div>              \r\n                          </div>\r\n                        </OverlayPanel>\r\n\r\n                      </div>\r\n                  </div>\r\n                </div>\r\n                }              \r\n\r\n                <div className=\"p-field p-col-12 p-md-6\">\r\n                  <label htmlFor=\"name\">Designação</label>        \r\n                  <InputText id=\"name\" name=\"name\" {...register('name', { required: 'Campo obrigatório.' })} className={classNames({ 'p-invalid': errors.name })} />\r\n                  {getFormErrorMessage(errors, 'name')}\r\n                  {/*{errors.name && <span>This field is required</span>}*/}\r\n                </div>\r\n\r\n                <div className=\"p-field p-col-12 p-md-6\">\r\n                  <label htmlFor=\"name\">Título</label>        \r\n                  <InputText id=\"title\" name=\"title\" {...register('title', { required: 'Campo obrigatório.' })} className={classNames({ 'p-invalid': errors.title })} />\r\n                  {getFormErrorMessage(errors, 'title')}       \r\n                </div>          \r\n\r\n                <div className=\"p-field p-col-12 p-md-6\">\r\n                  <label htmlFor=\"slug\">Slug</label>\r\n                  <InputText id=\"slug\" name=\"slug\" {...register('slug')} />\r\n                </div>\r\n\r\n                <div className=\"p-field p-col-6\">\r\n                  <label htmlFor=\"tags\">Tags</label>\r\n                  <Controller name=\"keywords\" control={control} defaultValue={data.keywords} render={(props) => (\r\n                      <Chips id=\"keywords\" value={props.field.value} onChange={(e) => props.field.onChange(e.value) } />\r\n                  )} />            \r\n                </div>            \r\n\r\n                <div className=\"p-field p-col-12 p-md-6\">\r\n                  <label>Perfis</label>\r\n                  <div className=\"p-card p-p-2\">\r\n                    { (availableRoles && availableRoles.length > 0) && \r\n                    <>\r\n                    <div className=\"p-field p-col-12 p-pl-0\">\r\n                      <MultiSelect value={selectedRoles} options={availableRoles} \r\n                        optionLabel=\"name\" optionValue=\"id\" display=\"chip\" showClear \r\n                        filter filterValue={filterRolesValue} \r\n                        onFilterValueChange={(e) => setFilterRolesValue(e.value)}\r\n                        onChange={(e) => setSelectedRoles(e.value)} placeholder=\"Selecionar\" />\r\n                    </div>              \r\n                    <div className=\"p-grid\">\r\n                      <div className=\"p-col\"></div>\r\n                      <div className=\"p-col\">\r\n                          <Button label=\"Adicionar\" type=\"button\" \r\n                            disabled={(!selectedRoles || selectedRoles.length === 0)}\r\n                          onClick={addRoles} />\r\n                      </div>\r\n                      <div className=\"p-col\"></div>\r\n                    </div>\r\n                    </>\r\n                    }\r\n                    { (roles && roles.length > 0) ?\r\n                      <>        \r\n                      <div className=\"p-field p-col-12 p-pl-0 p-pt-2\">\r\n                        <ListBox optionLabel=\"name\" optionValue=\"id\" className=\"p-p-1\"\r\n                          options={roles} value={removedRoles}\r\n                          onChange={(e) => setRemovedRoles(e.value)} multiple />\r\n                      </div>\r\n                      <div className=\"p-grid\">\r\n                        <div className=\"p-col\"></div>\r\n                        <div className=\"p-col\">\r\n                          <Button label=\"Remover\" type=\"button\" \r\n                          disabled={(!removedRoles || removedRoles.length === 0)}\r\n                          onClick={removeRoles} />\r\n                        </div>\r\n                        <div className=\"p-col\"></div>\r\n                      </div>\r\n                      </> :\r\n                      <div className=\"p-grid p-justify-center\">\r\n                        <div className=\"p-col-12 p-mt-4 p-mb-2\">\r\n                          <Message severity=\"warn\" text=\"Adicione um ou mais Perfis\" />\r\n                        </div>\r\n                      </div>\r\n                    }\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n\r\n            </div>\r\n\r\n          : null}\r\n\r\n          {activeIndex === 1 ?\r\n            <div className=\"card\">            \r\n              <div className=\"p-fluid p-formgrid p-grid\">\r\n\r\n                <div className=\"p-field p-col-6\">\r\n                  <label htmlFor=\"img_icon\">Icon</label>\r\n                  <InputText id=\"img_icon\" name=\"img_icon\" {...register('img_icon')} />\r\n                </div>\r\n\r\n                <div className=\"p-field p-col-6\">\r\n                  <label htmlFor=\"img_logo\">Logo</label>\r\n                  <InputText id=\"img_logo\" name=\"img_logo\" {...register('img_logo')} />\r\n                </div>\r\n\r\n                <div className=\"p-field p-col-12\" id=\"manifest-editor-parent\">\r\n                  <label htmlFor=\"manifest_editor\">App Manifest</label>\r\n                    <AceEditor\r\n                      ref={jsonManifestEditor}\r\n                      id=\"manifest_editor\"\r\n                      mode=\"json\"\r\n                      theme=\"github\"\r\n                      onLoad={editorInstance => {                \r\n                        editorInstance.container.style.setProperty('width', (document.getElementById('manifest-editor-parent').offsetWidth - 20) + 'px');              \r\n                      }}\r\n                      onChange={(newValue) => {\r\n                        setManifestJson(newValue);\r\n                      }}\r\n                      value={manifestJson}\r\n                      name=\"UNIQUE_ID_OF_MANIFEST\"         \r\n                      editorProps={{ $blockScrolling: true }}\r\n                      setOptions={{\r\n                        tabSize: 2,\r\n                        maxLines: 20,\r\n                        printMargin: false                    \r\n                      }}              \r\n                    />\r\n                </div>\r\n\r\n                <div className=\"p-field p-col-12\" id=\"style-editor-parent\">\r\n                <Toolbar className=\"p-mb-1\" left={() => { return (\r\n                <React.Fragment>\r\n                  <Button icon=\"pi pi-undo\" className=\"p-mr-2 p-pl-3 p-pr-3\"\r\n                  title=\"Undo\"\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    customStyleEditor.current.editor.undo();\r\n                  }} />\r\n                  <Button icon=\"pi pi-refresh\" className=\"p-mr-2 p-pl-3 p-pr-3\"\r\n                  title=\"Redo\"\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    customStyleEditor.current.editor.redo();\r\n                  }} />\r\n                  <div className=\"p-inputgroup\">                  \r\n                    <InputText placeholder=\"Pesquisar\" \r\n                      value={customStyleEditorSearchText}\r\n                      onChange={e=>{\r\n                        if (!e.target.value) {\r\n                          customStyleEditor.current.editor.find('', {\r\n                            backwards: false,\r\n                            wrap: true,\r\n                            caseSensitive: false,\r\n                            wholeWord: false,\r\n                            regExp: false\r\n                          });                        \r\n                        }\r\n                        setCustomStyleEditorSearchText(e.target.value)\r\n                        }} />\r\n                    <Button icon=\"pi pi-search\" className=\"p-button-warning\"\r\n                      title=\"Pesquisar texto\"\r\n                      onClick={e=>{\r\n                        e.preventDefault();\r\n                        customStyleEditor.current.editor.find(customStyleEditorSearchText, {\r\n                          backwards: false,\r\n                          wrap: true,\r\n                          caseSensitive: false,\r\n                          wholeWord: false,\r\n                          regExp: false\r\n                        });\r\n                        return false;                      \r\n                      }}/>\r\n                  </div>\r\n\r\n                </React.Fragment>\r\n                )}} />                \r\n                  <label htmlFor=\"style_editor\">Style (Código)</label>\r\n                  <AceEditor\r\n                    ref={customStyleEditor}\r\n                    id=\"style_editor\"\r\n                    mode=\"css\"\r\n                    theme=\"github\"\r\n                    onLoad={editorInstance => {                \r\n                      editorInstance.container.style.setProperty('width', (document.getElementById('style-editor-parent').offsetWidth - 20) + 'px');              \r\n                    }}\r\n                    onChange={(newValue) => {\r\n                      setCustomStyle(newValue);\r\n                    }}\r\n                    value={customStyle}\r\n                    name=\"UNIQUE_ID_OF_DIV2\"         \r\n                    editorProps={{ $blockScrolling: true }}\r\n                    setOptions={{\r\n                      tabSize: 2,\r\n                      maxLines: 20,\r\n                      printMargin: false                    \r\n                    }}              \r\n                  />\r\n                </div> \r\n\r\n              </div>\r\n            </div>\r\n          : null}\r\n\r\n          {activeIndex === 2 ?\r\n            <div className=\"card\" id=\"editor-parent\">\r\n              <Toolbar className=\"p-mb-1\" left={() => { return (\r\n                <React.Fragment>\r\n                  <Button icon=\"pi pi-undo\" className=\"p-mr-2 p-pl-3 p-pr-3\"\r\n                  title=\"Undo\"\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    jsonConfigEditor.current.editor.undo();\r\n                  }} />\r\n                  <Button icon=\"pi pi-refresh\" className=\"p-mr-2 p-pl-3 p-pr-3\"\r\n                  title=\"Redo\"\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    jsonConfigEditor.current.editor.redo();\r\n                  }} />\r\n                  <div className=\"p-inputgroup\">                  \r\n                    <InputText placeholder=\"Pesquisar\" \r\n                      value={jsonConfigEditorSearchText}\r\n                      onChange={e=>{\r\n                        if (!e.target.value) {\r\n                          jsonConfigEditor.current.editor.find('', {\r\n                            backwards: false,\r\n                            wrap: true,\r\n                            caseSensitive: false,\r\n                            wholeWord: false,\r\n                            regExp: false\r\n                          });                        \r\n                        }\r\n                        setJsonConfigEditorSearchText(e.target.value)\r\n                        }} />\r\n                    <Button icon=\"pi pi-search\" className=\"p-button-warning\"\r\n                      title=\"Pesquisar texto\"\r\n                      onClick={e=>{\r\n                        e.preventDefault();\r\n                        jsonConfigEditor.current.editor.find(jsonConfigEditorSearchText, {\r\n                          backwards: false,\r\n                          wrap: true,\r\n                          caseSensitive: false,\r\n                          wholeWord: false,\r\n                          regExp: false\r\n                        });\r\n                        return false;                      \r\n                      }}/>\r\n                  </div>\r\n\r\n                </React.Fragment>\r\n                )}} />\r\n              <AceEditor\r\n                ref={jsonConfigEditor}\r\n                mode=\"json\"\r\n                theme=\"github\"\r\n                onLoad={editorInstance => {                \r\n                  editorInstance.container.style.setProperty('width', (document.getElementById('editor-parent').offsetWidth - 30) + 'px');\r\n                  /*\r\n                  editorInstance.container.style.resize = \"both\";\r\n                  // mouseup = css resize end\r\n                  document.addEventListener(\"mouseup\", e => (\r\n                    editorInstance.resize()\r\n                  ));\r\n                  */               \r\n                }}\r\n                onChange={(newValue) => {\r\n                  setConfigJson(newValue);\r\n                }}\r\n                value={configJson}\r\n                name=\"UNIQUE_ID_OF_DIV\"         \r\n                editorProps={{ $blockScrolling: true }}\r\n                setOptions={{\r\n                  tabSize: 2,\r\n                  printMargin: false \r\n                }}              \r\n              />\r\n            </div>\r\n          : null}\r\n\r\n          {activeIndex === 3 ?\r\n\r\n            <div className=\"card\">\r\n\r\n              <PrintGroupChildsEditor \r\n                data={printChilds} \r\n                printsList={printsList}\r\n                groupsList={groupsList}\r\n                onChange={(data) => {\r\n                  setPrintChilds(data);\r\n                }} \r\n              />\r\n\r\n            </div>\r\n          : null}\r\n\r\n          <Toolbar className=\"p-mt-4 p-mb-4\" right={rightToolbarTemplate}></Toolbar>\r\n\r\n        </form>\r\n      \r\n      </BlockUI>\r\n\r\n    </React.Fragment>\r\n\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ auth: state.auth }))(withRouter(ViewerForm));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\nimport { BlockUI } from 'primereact/blockui';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport ViewerForm from './ViewerForm';\r\n\r\nfunction ViewerEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const { id } = useParams();\r\n\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [record, setRecord] = useState(null);\r\n  const [roles, setRoles] = useState([]);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setIsLoading(false);\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/portal');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setIsLoading(true);  \r\n\r\n    provider.getOne('viewers', params).then(d => {\r\n      setRecord(d.data);\r\n      setIsLoading(false);\r\n    }).catch(e => {\r\n      setIsLoading(false);\r\n      //toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n      <BlockUI blocked={isLoading}\r\n        template={<i class=\"p-blockui-loading-icon pi-spin pi pi-spinner\"></i>} >\r\n        { record ? <ViewerForm data={record} /> : <div /> }\r\n      </BlockUI>\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading }))(withRouter(ViewerEdit));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { Chip } from 'primereact/chip';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { confirmDialog } from 'primereact/confirmdialog';\r\nimport { Toast } from 'primereact/toast';\r\n\r\nimport AppContext from '../../../AppContext'\r\nimport dataProvider from '../../../service/DataProvider';\r\nimport { isAdminOrManager } from '../../utils';\r\n\r\n\r\nconst initialSearchParams = {\r\n  filters: {},\r\n  first: 0,\r\n  rows: 20,\r\n  page: 0,\r\n  sortField: 'id',\r\n  sortOrder: 1\r\n}\r\n\r\n\r\nfunction ViewerList(props) {\r\n\r\n  const {\r\n    history\r\n  } = props;\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(false);  \r\n  const [records, setRecords] = useState([]);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n\r\n  const [searchParams, setSearchParams] = useState({...initialSearchParams});      \r\n\r\n  const [loaded, setLoaded] = useState(false);\r\n\r\n  const dt = useRef(null);\r\n\r\n  const auth = core.store.getState().auth;\r\n  const adminOrManager = isAdminOrManager(auth);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    setLoaded(true);\r\n    \r\n    if (props?.history?.location?.state?.searchParams) {\r\n      setSearchParams({...props.history.location.state.searchParams});\r\n    } else {\r\n      loadData();\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!loaded) return;\r\n\r\n    const handler = setTimeout(() => {\r\n      loadData();\r\n    }, 500);\r\n    return () => {\r\n      clearTimeout(handler);\r\n    };    \r\n  }, [searchParams]); \r\n  \r\n  const newRecord = () => {\r\n    const location = {\r\n      pathname: '/viewers/create',\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);   \r\n  }\r\n\r\n  const editRecord = (record) => {\r\n    const location = {\r\n      pathname: `/viewers/edit/${record.id}`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);    \r\n  }  \r\n\r\n  const deleteSelectedRecords = () => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o(s) registo(s) selecionado(s)?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal');\r\n        const params = {\r\n          ids: selectedRecords.map(v => v.id)\r\n        }\r\n        provider.deleteMany('viewers', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo(s)', detail: 'Registo(s) eliminado(s) com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo(s)', detail: 'Ocorreu um erro ao eliminar o(s) registo(s)'}); \r\n        }).finally(() => {\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }\r\n\r\n  const deleteRecord = (record) => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o registo selecionado?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal');\r\n        const params = {\r\n          id: record.id\r\n        }      \r\n        provider.delete('viewers', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo', detail: 'Registo eliminado com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo', detail: 'Ocorreu um erro ao eliminar o registo'}); \r\n        }).finally(() => {\r\n          //console.log('finally');\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }  \r\n\r\n  const exportCSV = () => {\r\n    //TODO: implement export\r\n    //dt.current.exportCSV();\r\n  }\r\n\r\n  const loadData = (filters) => {\r\n    const provider = dataProvider(API_URL + '/portal');\r\n  \r\n    const _filter = {};\r\n    if (filters) {\r\n      Object.entries(filters).forEach(([key, item]) => {\r\n        if (item.value) {\r\n          _filter[key] = item.value;\r\n        }\r\n      });\r\n    } else if (searchParams.filters) {\r\n      Object.entries(searchParams.filters).forEach(([key, item]) => {\r\n        if (item.value) {\r\n          _filter[key] = item.value;\r\n        }\r\n      });\r\n    }\r\n\r\n    const params = {\r\n      pagination: { page: searchParams.page + 1, perPage: searchParams.rows},\r\n      sort: { field: searchParams.sortField, order: searchParams.sortOrder == -1 ? 'Desc' : 'Asc' },\r\n      filter: _filter\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    provider.getList('viewers', params).then(d => {\r\n      setSelectedRecords(null);\r\n      setRecords({ ...d, page: searchParams.page });\r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }\r\n\r\n  const onPage = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onSort = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  } \r\n\r\n  const onFilterChange = (event) => {\r\n    const filter = {...searchParams?.filters};\r\n    filter[event.target.name] = { value: event.target.value };\r\n    setSearchParams({...searchParams, filters: {...filter}});\r\n  }\r\n  \r\n  const onFilterClear = (event) => {\r\n    setSearchParams({ ...initialSearchParams});    \r\n  }   \r\n\r\n  const keywordsTemplate = (rowData) => {\r\n    return (\r\n        <React.Fragment>\r\n          { rowData.keywords && rowData.keywords.map( (item) => <Chip label={item} className=\"p-mr-2 p-mb-2\" /> ) }\r\n        </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const ownerTemplate = (rowData) => {\r\n    let elem = <Chip label=\"Anónimo\" icon=\"far fa-user\" className=\"p-mr-2 p-mb-2\" />;\r\n\r\n    if (rowData?.owner?.id > 0) {\r\n      if (rowData.owner.active) {\r\n        elem = <Chip label={rowData.owner.username} icon=\"fas fa-user-alt\" className=\"p-mr-2 p-mb-2\" /> \r\n      } else {\r\n        elem = <Chip label={rowData.owner.username} icon=\"fas fa-user-alt-slash\" className=\"p-mr-2 p-mb-2\" /> \r\n      }\r\n    }\r\n\r\n    return elem;\r\n  }\r\n\r\n  const leftToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Novo\" icon=\"pi pi-plus\" className=\"p-button-success p-mr-2\" onClick={newRecord} />\r\n            <Button label=\"Eliminar\" icon=\"pi pi-trash\" className=\"p-button-danger\" onClick={deleteSelectedRecords} disabled={!selectedRecords || !selectedRecords.length} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Limpar\" icon=\"pi pi-times\" className=\"p-button-help p-mr-2\" onClick={onFilterClear} />\r\n            {/*<Button label=\"Export\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} />*/}\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success p-mr-2\" onClick={() => editRecord(rowData)} />\r\n            <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => deleteRecord(rowData)} />\r\n        </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const idFilter = <InputText name=\"id\" value={searchParams?.filters?.id?.value} onChange={onFilterChange} className=\"p-column-filter\" placeholder=\"Id\" disabled={loading} />;\r\n  const nameFilter = <InputText name=\"name\" value={searchParams?.filters?.name?.value} onChange={onFilterChange} className=\"p-column-filter\" placeholder=\"Nome\" disabled={loading} />;\r\n  const titleFilter = <InputText name=\"title\" value={searchParams?.filters?.title?.value} onChange={onFilterChange} className=\"p-column-filter\" placeholder=\"Nome\" disabled={loading} />;\r\n  const descriptionFilter = <InputText name=\"description\" value={searchParams?.filters?.description?.value} onChange={onFilterChange} className=\"p-column-filter\" placeholder=\"Descrição\" disabled={loading}/>;\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"p-col-12\"><h3>Visualizadores</h3></div>\r\n\r\n      <div className=\"p-grid p-fluid viewer-list\">\r\n        <Toast ref={toast} baseZIndex={2000} />          \r\n        <div className=\"card\">\r\n          <Toolbar className=\"p-mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n          <DataTable ref={dt} value={records ? records.data : []} lazy\r\n              selectionMode=\"checkbox\"\r\n              selection={selectedRecords} onSelectionChange={(e) => setSelectedRecords(e.value)}\r\n              paginator first={searchParams.first} rows={searchParams.rows} totalRecords={records.total} onPage={onPage}\r\n              onSort={onSort} sortField={searchParams.sortField} sortOrder={searchParams.sortOrder}\r\n              filters={searchParams.filters} loading={loading}\r\n              emptyMessage=\"Não foram entrados registos.\" >\r\n              <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n              <Column field=\"id\" header=\"Id\" sortable filter filterElement={idFilter} filterPlaceholder=\"Id\" headerStyle={{ width: '6rem' }} />\r\n              <Column field=\"name\" header=\"Nome\" sortable filter filterElement={nameFilter} filterPlaceholder=\"Nome\" style={{\"wordBreak\": \"break-all\"}}  />\r\n              <Column field=\"title\" header=\"Título\" sortable filter filterElement={titleFilter} filterPlaceholder=\"Título\" style={{\"wordBreak\": \"break-all\"}} />\r\n              <Column field=\"description\" header=\"Descrição\" sortable filter filterElement={descriptionFilter} filterPlaceholder=\"Descrição\" style={{\"wordBreak\": \"break-all\"}} />\r\n              <Column field=\"keywords\" header=\"Keywords\" body={keywordsTemplate} />\r\n              { adminOrManager && <Column field=\"owner\" header=\"Dono\" body={ownerTemplate} /> }\r\n              <Column body={actionBodyTemplate} />\r\n          </DataTable>             \r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, filters: state.filters }))(withRouter(ViewerList));\r\n","// react\r\nimport React, { useState, useEffect, useRef } from 'react';\r\n\r\n// openlayers\r\nimport Map from 'ol/Map'\r\nimport View from 'ol/View'\r\nimport TileLayer from 'ol/layer/Tile'\r\nimport VectorLayer from 'ol/layer/Vector'\r\nimport VectorSource from 'ol/source/Vector'\r\nimport XYZ from 'ol/source/XYZ'\r\nimport OSM from 'ol/source/OSM'\r\nimport {transform} from 'ol/proj'\r\nimport {toStringXY} from 'ol/coordinate';\r\n\r\nfunction MapWrapper(props) {\r\n\r\n  // set intial state\r\n  const [ map, setMap ] = useState();\r\n  const [ featuresLayer, setFeaturesLayer ] = useState();\r\n  const [ selectedCoord , setSelectedCoord ] = useState();\r\n\r\n  // pull refs\r\n  const mapElement = useRef()\r\n  \r\n  // create state ref that can be accessed in OpenLayers onclick callback function\r\n  //  https://stackoverflow.com/a/60643670\r\n  const mapRef = useRef();\r\n  mapRef.current = map;\r\n\r\n  // initialize map on first render - logic formerly put into componentDidMount\r\n  useEffect( () => {\r\n\r\n    // create and add vector source layer\r\n    const initalFeaturesLayer = new VectorLayer({\r\n      source: new VectorSource()\r\n    });\r\n\r\n    // create map\r\n    const initialMap = new Map({\r\n      target: mapElement.current,\r\n      layers: [\r\n        \r\n        /*\r\n        // USGS Topo\r\n        new TileLayer({\r\n          source: new XYZ({\r\n            url: 'https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer/tile/{z}/{y}/{x}',\r\n          })\r\n        }),\r\n        */\r\n\r\n        // OSM\r\n        new TileLayer({\r\n          source: new OSM()\r\n        }),\r\n\r\n        // Google Maps Terrain\r\n        /* new TileLayer({\r\n          source: new XYZ({\r\n            url: 'http://mt0.google.com/vt/lyrs=p&hl=en&x={x}&y={y}&z={z}',\r\n          })\r\n        }), */\r\n\r\n        initalFeaturesLayer\r\n        \r\n      ],\r\n      view: new View({\r\n        projection: 'EPSG:3857',\r\n        center: [0, 0],\r\n        zoom: 2\r\n      }),\r\n      controls: []\r\n    })\r\n\r\n    // set map onclick handler\r\n    initialMap.on('click', handleMapClick);\r\n\r\n    // save map and vector layer references to state\r\n    setMap(initialMap);\r\n\r\n    if (props.features && props.features.length > 0) {\r\n      initalFeaturesLayer.getSource().addFeatures(props.features);\r\n\r\n      // fit map to feature extent (with 500px of padding)\r\n      initialMap.getView().fit(initalFeaturesLayer.getSource().getExtent());\r\n    }\r\n    setFeaturesLayer(initalFeaturesLayer);\r\n\r\n  },[]);\r\n\r\n  // update map if features prop changes - logic formerly put into componentDidUpdate\r\n  useEffect( () => {\r\n\r\n    if (!mapRef && !mapRef.current.current) return;\r\n\r\n    if (!featuresLayer) return;\r\n\r\n    if (props.features.length) { // may be null on first render\r\n\r\n      // set features to map\r\n      featuresLayer.setSource(\r\n        new VectorSource({\r\n          features: props.features // make sure features is an array\r\n        })\r\n      );\r\n    } else {\r\n      featuresLayer.getSource().clear();\r\n    }\r\n\r\n  },[props.features]);\r\n\r\n  // map click handler\r\n  const handleMapClick = (event) => {\r\n\r\n    // get clicked coordinate using mapRef to access current React state inside OpenLayers callback\r\n    //  https://stackoverflow.com/a/60643670\r\n    const clickedCoord = mapRef.current.getCoordinateFromPixel(event.pixel);\r\n\r\n    // transform coord to EPSG 4326 standard Lat Long\r\n    const transormedCoord = transform(clickedCoord, 'EPSG:3857', 'EPSG:4326');\r\n\r\n    // set React state\r\n    setSelectedCoord(transormedCoord);\r\n\r\n    console.log(transormedCoord);\r\n  }\r\n\r\n  // render component\r\n  return (      \r\n    <div ref={mapElement} className=\"map-container\" style={{width: \"100%\", height: \"300px\"}}></div>\r\n  ) \r\n\r\n}\r\n\r\nexport default MapWrapper;","import React, { useState, useEffect } from \"react\";\r\nimport { TabView,TabPanel } from 'primereact/tabview';\r\nimport { Dialog } from 'primereact/dialog';\r\nimport { Button } from 'primereact/button';\r\nimport { InputTextarea } from 'primereact/inputtextarea';\r\nimport { InputNumber } from 'primereact/inputnumber';\r\nimport { Dropdown } from 'primereact/dropdown';\r\nimport { Message } from 'primereact/message';\r\nimport { classNames } from 'primereact/utils';\r\nimport { useForm, Controller } from 'react-hook-form';\r\n\r\nimport OlWKT from \"ol/format/WKT\";\r\nimport * as OlGeom from \"ol/geom\";\r\nimport * as OlProj from 'ol/proj';\r\nimport { Fill as OlFill, Stroke as OlStroke, Style as OlStyle } from 'ol/style';\r\nimport OlFeature from 'ol/Feature';\r\nimport {applyTransform} from 'ol/extent';\r\nimport {register as proj4register } from 'ol/proj/proj4';\r\nimport Proj4 from 'proj4';\r\nimport {\r\n  LineString,\r\n  LinearRing,\r\n  MultiLineString,\r\n  MultiPoint,\r\n  MultiPolygon,\r\n  Point,\r\n  Polygon,\r\n  GeometryCollection\r\n} from 'ol/geom';\r\nimport OL3Parser from 'jsts/org/locationtech/jts/io/OL3Parser';\r\nimport {BufferOp} from 'jsts/org/locationtech/jts/operation/buffer';\r\n\r\nimport MapWrapper from '../common/MapWrapper';\r\n\r\n// Add projections\r\nconst addProjections = (projections) => {\r\n  projections.map(i => {\r\n    if (!OlProj.get('EPSG:'+i.srid)) {  \r\n      try {\r\n        Proj4.defs('EPSG:'+i.srid, i.defs);\r\n        //This function should be called whenever changes are made to the proj4 registry,\r\n        //e.g. after calling proj4.defs(). Existing transforms will not be modified by this function.\r\n        proj4register(Proj4);\r\n        const newProj = OlProj.get('EPSG:'+i.srid);\r\n        const fromLonLat = OlProj.getTransform('EPSG:4326', newProj);\r\n        if (i.extent) {\r\n          const worldExtent = i.extent.split(' ').map(Number);\r\n          newProj.setWorldExtent(worldExtent);\r\n          const extent = applyTransform(worldExtent, fromLonLat, undefined, 8);\r\n          newProj.setExtent(extent);\r\n        }\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    }\r\n    return i;\r\n  });\r\n}\r\n\r\nconst getGeometryFromWKT = function (wkt, options) {\r\n  const format = new OlWKT();\r\n  const geom = options ? format.readGeometry(wkt, options) : format.readGeometry(wkt);\r\n\r\n  return geom;\r\n};\r\n\r\nconst getWKTFromGeometry = function (geom) {\r\n  const format = new OlWKT();\r\n  let wkt = format.writeGeometry(geom);\r\n  return wkt;\r\n};\r\n\r\nconst GeometryFilterEditor = props => {\r\n  const [data, setData] = useState(props.data ? {...props.data} : {});\r\n  const [coordinateSystems, setCoordinateSystems] = useState();\r\n  const [showForm, setShowForm] = useState(false);\r\n\r\n  // set intial state\r\n  const [ features, setFeatures ] = useState([])  \r\n\r\n  const { register, watch, setValue, handleSubmit, clearErrors, control, formState: { errors } } = useForm({\r\n    defaultValues: {...props.data}\r\n  });\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">O número de caracteres é superior à dimensão máxima permitida</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">Formato não permitido</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n\r\n  const onSave = (formData) => {\r\n    if (formData.geometryWKT && formData.geometrySRID) {\r\n      try {\r\n        const geom = getGeometryFromWKT(formData.geometryWKT, null);\r\n        if (geom) {\r\n          //const final_geom_wkt = getWKTFromGeometry(geom.clone().transform('EPSG:' + formData.geometrySRID, 'EPSG:3763'));\r\n          const final_geom_wkt = getWKTFromGeometry(geom.clone());\r\n          //props.onSave({geometryWKT: final_geom_wkt, geometrySRID: 3763, tolerance: formData.tolerance});\r\n          props.onSave({geometryWKT: final_geom_wkt, geometrySRID: formData.geometrySRID, tolerance: formData.tolerance});\r\n          setShowForm(false);\r\n        } else {\r\n          console.log('error');\r\n        }\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    }\r\n  }\r\n\r\n  const onRemove = () => {\r\n    //Clear Form\r\n    setValue('geometrySRID', null, { shouldValidate: false });\r\n    setValue('geometryWKT', null, { shouldValidate: false });\r\n    setValue('tolerance', null, { shouldValidate: false });\r\n    //Save new state \r\n    props.onSave({geometryWKT: null, geometrySRID: null, tolerance: null});\r\n  }\r\n\r\n  const onHide = () => {\r\n    setValue('geometrySRID', props?.data.geometrySRID, { shouldValidate: false });\r\n    setValue('geometryWKT', props?.data.geometryWKT, { shouldValidate: false });\r\n    setValue('tolerance', props?.data.tolerance, { shouldValidate: false });\r\n    clearErrors();\r\n    setShowForm(false); \r\n  }\r\n\r\n  const refreshFeatures = (geom_data) =>  {\r\n    if (!geom_data.geometryWKT || !geom_data.geometrySRID) {\r\n      setFeatures([]);\r\n    } else {\r\n      const format = new OlWKT();\r\n      const new_features = [];\r\n\r\n      const feature = format.readFeature(geom_data.geometryWKT, {\r\n        dataProjection: 'EPSG:' + geom_data.geometrySRID,\r\n        featureProjection: 'EPSG:3857',\r\n      });\r\n\r\n      new_features.push(feature);\r\n\r\n      if (geom_data.tolerance && geom_data.tolerance > 0) {\r\n        try {\r\n          const parser = new OL3Parser();\r\n          parser.inject(\r\n            Point, \r\n            LineString, \r\n            LinearRing, \r\n            Polygon, \r\n            MultiPoint, \r\n            MultiLineString, \r\n            MultiPolygon, \r\n            GeometryCollection\r\n          );\r\n\r\n          // convert the OpenLayers geometry to a JSTS geometry\r\n          const jstsGeom = parser.read(feature.getGeometry());\r\n          const jstsBuffer = BufferOp.bufferOp(jstsGeom, geom_data.tolerance);\r\n          \r\n          const geomBuffer = parser.write(jstsBuffer);\r\n          const buffered = new OlFeature({\r\n            geometry: geomBuffer\r\n          });\r\n        \r\n          const bufferStyle = new OlStyle({\r\n            stroke : new OlStroke({\r\n              color : 'rgba(100,27,0,1.0)',\r\n              width : 1    \r\n            }),\r\n            fill :  new OlFill({\r\n              color: 'rgba(0,0,0,0)'\r\n          })\r\n          });\r\n\r\n          buffered.setStyle(bufferStyle);\r\n          new_features.push(buffered);\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n      }\r\n\r\n      setFeatures(new_features);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    refreshFeatures(props.data);\r\n  }, []);\r\n  \r\n  // Callback version of watch.  It's your responsibility to unsubscribe when done.\r\n  React.useEffect(() => {\r\n    const subscription = watch((value, { name, type }) => {\r\n      //Refresh feature\r\n      refreshFeatures(value);\r\n    });\r\n    return () => subscription.unsubscribe();\r\n  }, [watch]);\r\n\r\n  useEffect(() => {\r\n    if (props.coordinateSystems) {\r\n      setCoordinateSystems(props.coordinateSystems.map( c => { return { value: parseInt(c.config_json.srid), label: c.config_json.title }; }));\r\n      const projections = props.coordinateSystems.map( c => { \r\n        return { \r\n          srid: parseInt(c.config_json.srid),\r\n          defs: c.config_json.defs,\r\n          extent: c.config_json.extent\r\n        }\r\n      });\r\n      addProjections(projections);\r\n      refreshFeatures(props.data);\r\n    }\r\n  }, [props.coordinateSystems]);\r\n\r\n  useEffect(() => {\r\n    //console.log(props.data);\r\n    setData({...props.data});\r\n  }, [props.data]);  \r\n\r\n  const renderFooter = (name) => {\r\n    return (\r\n        <div>\r\n            <Button \r\n              label=\"Fechar\"\r\n              icon=\"pi pi-times\"\r\n              onClick={onHide} className=\"p-button-text\" />\r\n            <Button \r\n              label=\"Gravar\"\r\n              icon={\"pi pi-check\"}\r\n              onClick={handleSubmit((d) => onSave(d))}\r\n              autoFocus />\r\n        </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n\r\n    <React.Fragment>\r\n      \r\n      <div className=\"p-field p-col-12 p-mt-2 p-mb-4\">\r\n        <div>\r\n          { data.geometryWKT ?\r\n            <Message severity=\"info\" text=\"Clique em 'Editar' para configurar o filtro espacial.\" /> \r\n            :\r\n            <Message severity=\"warn\" text=\"Sem filtro espacial definido. Clique em 'Editar' para definir um filtro espacial.\" />\r\n          }\r\n        </div>\r\n      </div>  \r\n\r\n      <div className=\"p-grid\">\r\n        <div className=\"p-col-6\">\r\n          { data.geometryWKT &&      \r\n          <Button type=\"text\" label=\"Remover\" icon=\"pi pi-trash\" className=\"p-button-danger p-button-outlined\"\r\n           onClick={(e)=> {e.preventDefault(); onRemove();}} />\r\n          }\r\n        </div>\r\n        <div className=\"p-col-6\">\r\n          <Button type=\"text\" label=\"Editar\" icon=\"pi pi-times\" className=\"p-button-outlined\"\r\n          onClick={(e)=> {e.preventDefault(); setShowForm(true)}} />     \r\n        </div>\r\n      </div>\r\n\r\n      { showForm &&\r\n      <Dialog header={\"Edição de Filtro Espacial\"} visible={showForm} style={{ width: '50vw' }} \r\n        footer={renderFooter} \r\n        onHide={onHide}>\r\n        <form>\r\n          <div className=\"p-fluid p-formgrid p-grid\">\r\n            <div className=\"p-field p-col-12\">\r\n              <TabView>\r\n                <TabPanel header=\"WKT\">          \r\n                  <div className=\"p-col p-field\">\r\n                    <label htmlFor=\"format\">Sistema de Coordenadas</label>\r\n                    <Controller name=\"geometrySRID\" control={control} rules={{required: 'Campo obrigatório.' }}\r\n                      render={({ field }) => {\r\n                        return <Dropdown id=\"geometrySRID\" {...field} \r\n                          options={coordinateSystems} showClear\r\n                          onChange={(e) => field.onChange(e.value)}\r\n                          className={classNames({ 'p-invalid': errors.geometrySRID })}\r\n                        />\r\n                      }}                    \r\n                    />\r\n                    {getFormErrorMessage(errors, 'geometrySRID')} \r\n                  </div>\r\n                  <div className=\"p-field p-col-12\">\r\n                    <label htmlFor=\"orientation\">Geometria (WKT)</label>\r\n                    <InputTextarea id=\"geometryWKT\" name=\"geometryWKT\" rows={5}\r\n                      {...register(\"geometryWKT\", { required: 'Campo obrigatório.' })} \r\n                      className={classNames({ 'p-invalid': errors.geometryWKT })} />\r\n                    {getFormErrorMessage(errors, 'geometryWKT')}  \r\n                  </div>\r\n                </TabPanel>\r\n                <TabPanel header=\"Mapa\"> \r\n                  <div>\r\n                    <MapWrapper features={features} />\r\n                  </div>\r\n                </TabPanel>\r\n              </TabView>\r\n            </div>\r\n            <div className=\"p-field p-col-12\">\r\n              <label htmlFor=\"tolerance\">Tolerância (m)</label>\r\n              <Controller name=\"tolerance\" control={control}\r\n                render={({ field }) => {\r\n                  return <InputNumber id=\"tolerance\" {...field}                    \r\n                    onChange={(e) => field.onChange(e.value)} />\r\n                }}                    \r\n              />\r\n            </div>\r\n            </div>\r\n        </form>\r\n      </Dialog>\r\n      }\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default GeometryFilterEditor;","import React, { useState, useEffect, Component } from \"react\";\r\nimport { Dialog } from 'primereact/dialog';\r\nimport { Button } from 'primereact/button';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport {Checkbox} from 'primereact/checkbox';\r\nimport { Tooltip } from 'primereact/tooltip';\r\nimport { confirmPopup } from 'primereact/confirmpopup';\r\nimport { Panel } from 'primereact/panel';\r\nimport { Message } from 'primereact/message';\r\nimport { classNames } from 'primereact/utils';\r\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { ReorderGroups, ReorderFields, getItemStyle, getGroupListStyle, getFieldListStyle } from \"./utils\";\r\n\r\n\r\nconst FieldFormEditor = props => {\r\n  const [field, setField] = useState(props.data ? {...props.data} : {});\r\n\r\n  const { register, handleSubmit, control, reset, formState: { errors } } = useForm({\r\n    defaultValues: {...props.data}\r\n  });\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">O número de caracteres é superior à dimensão máxima permitida</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">Formato não permitido</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n\r\n  const onSave = (formData) => {\r\n    props.onSave(formData);\r\n  }\r\n\r\n  useEffect(() => {\r\n    setField({...props.data});\r\n  }, [props.data]);\r\n\r\n\r\n  const renderFooter = (name) => {\r\n    return (\r\n        <div>\r\n            <Button \r\n              label=\"Fechar\"\r\n              icon=\"pi pi-times\"\r\n              onClick={() => props.onHide()} className=\"p-button-text\" />\r\n            <Button \r\n              label=\"Gravar\"\r\n              icon={\"pi pi-check\"}\r\n              onClick={handleSubmit((d) => onSave(d))}\r\n              autoFocus />\r\n        </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Dialog header={\"Edição de Campo\"} visible={props.show} style={{ width: '50vw' }} footer={renderFooter} onHide={() => { props.onHide(); }}>\r\n      <form>\r\n        <div className=\"p-fluid p-formgrid p-grid\">\r\n          <div className=\"p-field p-col-12\">\r\n            <label htmlFor=\"key\">Chave</label>\r\n            <div className=\"p-inputgroup\">\r\n              <InputText  id=\"key\" type=\"text\" {...register(\"key\", { required: 'Campo obrigatório.',  pattern: /^(?![0-9])[a-zA-Z0-9$_]+$/i })} className={classNames({ 'p-invalid': errors.key })} />            \r\n              <Tooltip target=\".tooltip-form-field-key\" autoHide={false}>\r\n                  <div className=\"p-d-flex p-ai-center\">\r\n                      <span style={{minWidth: '5rem'}}>\r\n                        O campo <i>chave</i> é de preenchimento obrigatório e serve como identificador único de cada campo.\r\n                        Deverá ser preenchido com uma cadeia de caracteres, sem espaços.\r\n                      </span>\r\n                  </div>\r\n              </Tooltip>\r\n              <Button type=\"text\" icon=\"pi pi-info-circle\" className=\"tooltip-form-field-key p-button-rounded p-button-text\" onClick={(e)=>e.preventDefault()} />\r\n            </div>\r\n            {getFormErrorMessage(errors, 'key')}\r\n          </div>\r\n          <div className=\"p-field p-col-12\">\r\n            <label htmlFor=\"title\">Título</label>\r\n            <InputText  id=\"title\" type=\"text\" {...register(\"title\", { required: 'Campo obrigatório.' })} className={classNames({ 'p-invalid': errors.title })} />\r\n            {getFormErrorMessage(errors, 'title')}\r\n          </div>\r\n          <div className=\"p-field p-col-12\">\r\n            <Controller name=\"required\" control={control}\r\n              render={({ field }) => {                      \r\n                return <Checkbox id=\"required\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n              }}                    \r\n            />          \r\n            <label htmlFor=\"required\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Preenchimento obrigatório</label>\r\n          </div>\r\n          \r\n          <div className=\"p-field p-col-12\"><hr /></div>\r\n          \r\n          <div className=\"p-field p-col-12\">\r\n            <Controller name=\"active\" control={control}\r\n              render={({ field }) => {                      \r\n                return <Checkbox id=\"active\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n              }}                    \r\n            />          \r\n            <label htmlFor=\"active\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Activo</label>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nconst GroupFormEditor = props => {\r\n  const [group, setGroup] = useState(props.data ? {...props.data} : {});\r\n\r\n  const { register, handleSubmit, control, reset, formState: { errors } } = useForm({\r\n    defaultValues: {...props.data}\r\n  });\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">O número de caracteres é superior à dimensão máxima permitida</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">Formato não permitido</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n\r\n  const onSave = (formData) => {\r\n    props.onSave(formData);\r\n  }  \r\n\r\n  useEffect(() => {\r\n    setGroup({...props.data});\r\n  }, [props.data]);\r\n\r\n\r\n  const renderFooter = (name) => {\r\n    return (\r\n        <div>\r\n            <Button \r\n              label=\"Fechar\"\r\n              icon=\"pi pi-times\"\r\n              onClick={() => props.onHide()} className=\"p-button-text\" />\r\n            <Button \r\n              label=\"Gravar\"\r\n              icon={\"pi pi-check\"}\r\n              onClick={handleSubmit((d) => onSave(d))}\r\n              autoFocus />\r\n        </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n  <Dialog header={\"Edição de Grupo\"} visible={props.show} style={{ width: '50vw' }} footer={renderFooter} onHide={() => { props.onHide(); }}>\r\n    <form>\r\n      <div className=\"p-fluid p-formgrid p-grid\">\r\n        <div className=\"p-field p-col-12\">\r\n          <label htmlFor=\"key\">Chave</label>\r\n          <div className=\"p-inputgroup\">\r\n            <InputText  id=\"key\" type=\"text\" {...register(\"key\", { required: 'Campo obrigatório.',  pattern: /^(?![0-9])[a-zA-Z0-9$_]+$/i })} className={classNames({ 'p-invalid': errors.key })} />            \r\n            <Tooltip target=\".tooltip-form-field-key\" autoHide={false}>\r\n                <div className=\"p-d-flex p-ai-center\">\r\n                    <span style={{minWidth: '5rem'}}>\r\n                      O campo <i>chave</i> é de preenchimento obrigatório e serve como identificador único de cada grupo.\r\n                      Deverá ser preenchido com uma cadeia de caracteres, sem espaços.\r\n                    </span>\r\n                </div>\r\n            </Tooltip>\r\n            <Button type=\"text\" icon=\"pi pi-info-circle\" className=\"tooltip-form-field-key p-button-rounded p-button-text\" onClick={(e)=>e.preventDefault()} />\r\n          </div>\r\n          {getFormErrorMessage(errors, 'key')}\r\n        </div>\r\n        <div className=\"p-field p-col-12\">\r\n          <label htmlFor=\"title\">Título</label>\r\n          <InputText  id=\"title\" type=\"text\" {...register(\"title\", { required: 'Campo obrigatório.' })} className={classNames({ 'p-invalid': errors.title })} />\r\n          {getFormErrorMessage(errors, 'title')}\r\n        </div>\r\n\r\n        <div className=\"p-field p-col-12\"><hr /></div>\r\n\r\n        <div className=\"p-field p-col-12\">\r\n          <Controller name=\"active\" control={control}\r\n            render={({ field }) => {                      \r\n              return <Checkbox id=\"active\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n            }}                    \r\n          />          \r\n          <label htmlFor=\"active\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Activo</label>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </Dialog>\r\n  );\r\n\r\n};\r\n\r\n\r\nconst GroupFields = props => {\r\n  const { group, groupNum } = props;\r\n\r\n  const [fieldEdition, setFieldEdition] = useState();\r\n  const [showFieldForm, setShowFieldForm] = useState(false);\r\n\r\n  function onFieldFormHide () {\r\n    setShowFieldForm(false);\r\n    setFieldEdition(null);\r\n  }\r\n\r\n  function onFieldFormSave (field) {\r\n    const key = field.key;\r\n\r\n    //Check key already exists\r\n    if (fieldEdition.key !== key && group.data.fields[key]) return;\r\n\r\n    let new_fields = {...group.data.fields};\r\n    if (new_fields[fieldEdition.key]) delete new_fields[fieldEdition.key];\r\n    new_fields = {[key]: (({ active, title, header, required }) => ({ active, title, header, required }))(field), ...new_fields};\r\n\r\n    props.onChange(group.id, new_fields);\r\n\r\n    setShowFieldForm(false);\r\n  }\r\n\r\n  return (\r\n    <Droppable droppableId={`droppable${group.id}`} type={`${groupNum}`}>\r\n      {(provided, snapshot) => (\r\n        <div\r\n          ref={provided.innerRef}\r\n          style={getFieldListStyle(snapshot.isDraggingOver)}\r\n        >\r\n          {Object.keys(group.data.fields || {}).length === 0 &&\r\n            <div className=\"p-fluid\">\r\n              <div className=\"p-col-12\">\r\n                  <Message severity=\"info\" text=\"Clique em '+' para adicionar um campo\" />\r\n              </div>\r\n            </div>\r\n          }          \r\n\r\n          {Object.entries(group.data.fields).map((g,i) => {\r\n              return {id: g[0], ...g[1]}\r\n            }).map((field, index) => {\r\n              return (\r\n                <Draggable\r\n                  key={`${groupNum}${index}`}\r\n                  draggableId={`${groupNum}${index}`}\r\n                  index={index}\r\n                  style={{ \"border\": \"solid 1px lightgray\", marginTop: 3 }}                  \r\n                >\r\n                  {(provided, snapshot) => (\r\n                    <div\r\n                      ref={provided.innerRef}\r\n                      {...provided.draggableProps}\r\n                      style={getItemStyle(\r\n                        snapshot.isDragging,\r\n                        provided.draggableProps.style\r\n                      )}\r\n                      className=\"p-shadow-1\"\r\n                    >\r\n                      <div style={{marginBottom: 5 }}>\r\n                        <div style={{ float: \"left\", paddingTop: 6 }}>\r\n                          <span style={{paddingLeft: \"15px\"}}>{field.id}</span>\r\n                          <span {...provided.dragHandleProps}>\r\n                            <i className=\"fas fa-arrows-alt\" style={{ float: \"left\", \"paddingTop\": 3 }}></i>\r\n                          </span>\r\n                        </div>\r\n                        <div style={{ textAlign: \"right\" }}>\r\n                          <Button type=\"text\" icon=\"pi pi-trash\" \r\n                            className=\"p-button-rounded p-button-text p-button-danger\"\r\n                            tooltip=\"Eliminar campo\"\r\n                            tooltipOptions={{position: 'bottom'}}                            \r\n                            onClick={ (e) => {\r\n                              e.preventDefault();\r\n                              confirmPopup({\r\n                                  target: e.currentTarget,\r\n                                  message: 'Tem a certeza que pretende eliminar?',\r\n                                  icon: 'pi pi-exclamation-triangle',\r\n                                  acceptLabel: 'Sim',\r\n                                  rejectLabel: 'Não',\r\n                                  accept: () => {                                      \r\n                                    const new_fields = {...group.data.fields};\r\n                                    delete new_fields[field.id];\r\n                                    props.onChange(group.id, new_fields);\r\n                                  }\r\n                              });\r\n                            }} />\r\n                            <Button type=\"text\" icon=\"pi pi-pencil\" \r\n                              className=\"p-button-rounded p-button-text p-button-warning\"\r\n                              tooltip=\"Editar campo\"\r\n                              tooltipOptions={{position: 'bottom'}}                              \r\n                              onClick={ (e) => {\r\n                                e.preventDefault();\r\n                                setFieldEdition({...field, groupId: group.id, key: field.id});\r\n                                setShowFieldForm(true);                                     \r\n                              }} />                                \r\n                          </div>\r\n                        </div>\r\n\r\n                        { showFieldForm && \r\n                          <FieldFormEditor data={fieldEdition} show={showFieldForm} onHide={onFieldFormHide} onSave={onFieldFormSave} />\r\n                        }\r\n\r\n                        <div className=\"p-fluid p-pt-2\">\r\n                          <div className=\"p-field p-grid p-mb-0\">\r\n                            <div class=\"p-col-10\">\r\n                              <div className=\"p-grid\">\r\n                                <label className=\"p-col-12 p-md-2\"><strong>Título: </strong></label>\r\n                                <div className=\"p-col-12 p-md-10\">\r\n                                    <span>{field.title}</span>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                            <div class=\"p-col-2\">\r\n                              <div className=\"p-grid\">\r\n                                <div className=\"p-field-checkbox\">\r\n                                    <Checkbox checked={field.active} disabled/>\r\n                                    <label>Ativo</label>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"p-field p-grid\">\r\n                            <div class=\"p-col-12\">\r\n                              <div className=\"p-grid\">\r\n                                <label className=\"p-col-12 p-md-2\"><strong>Cabeçalho: </strong></label>\r\n                                <div className=\"p-col-12 p-md-10\">\r\n                                    <span>{field.header}</span>\r\n                                </div>\r\n                              </div>                       \r\n                            </div>\r\n                          </div>\r\n                          <div className=\"p-field p-grid\">\r\n                            <div class=\"p-col-12\">\r\n                              <div className=\"p-field-checkbox\">\r\n                                  <Checkbox checked={field.required} disabled/>\r\n                                  <label>Preenchimento obrigatório</label>\r\n                              </div>\r\n                            </div>\r\n                          </div>                                        \r\n                        </div>\r\n\r\n                    </div>\r\n                  )}\r\n                </Draggable>\r\n              );\r\n          })}\r\n          {provided.placeholder}\r\n        </div>\r\n      )}\r\n    </Droppable>\r\n  );\r\n};\r\n\r\n\r\nconst Fields = props => {\r\n  const { fields } = props;\r\n\r\n  const [fieldEdition, setFieldEdition] = useState();\r\n  const [showFieldForm, setShowFieldForm] = useState(false);\r\n\r\n  function onFieldFormHide () {\r\n    setShowFieldForm(false);\r\n    setFieldEdition(null);\r\n  }\r\n\r\n  function onFieldFormSave (field) {\r\n    const key = field.key;\r\n\r\n    //Check key already exists\r\n    if (fieldEdition.key !== key && fields[key]) return;\r\n\r\n    let new_fields = {...fields};\r\n    if (fieldEdition.key !== key) delete new_fields[fieldEdition.key];\r\n    new_fields[key] =  (({ active, title, header, required }) => ({ active, title, header, required }))(field);\r\n\r\n    props.onChange(new_fields);\r\n\r\n    setShowFieldForm(false);\r\n  }\r\n\r\n  return (\r\n\r\n\r\n  <DragDropContext\r\n    onDragEnd={props.onDragEnd}\r\n    //onDragUpdate={this.onDragUpdate}\r\n  >\r\n    <Droppable droppableId=\"droppable\" type=\"FIELDS\">\r\n      {(provided, snapshot) => (\r\n        <div\r\n          ref={provided.innerRef}\r\n          style={getFieldListStyle(snapshot.isDraggingOver)}\r\n        >\r\n          {Object.keys(fields || {}).length === 0 &&\r\n            <div className=\"p-fluid\">\r\n              <div className=\"p-col-12\">\r\n                  <Message severity=\"info\" text=\"Clique em 'Novo Campo' para adicionar um campo\" />\r\n              </div>\r\n            </div>\r\n          }\r\n\r\n          {Object.entries(fields).map((f,i) => {\r\n            return {id: f[0], data: f[1]}\r\n          }).map((field, index) => (\r\n            <Draggable\r\n              key={field.id}\r\n              draggableId={field.id}\r\n              index={index}\r\n              style={{ \"border\": \"solid 1px lightgray\", marginTop: 3 }}                  \r\n            >\r\n              {(provided, snapshot) => (\r\n                <div\r\n                  ref={provided.innerRef}\r\n                  {...provided.draggableProps}\r\n                  style={getItemStyle(\r\n                    snapshot.isDragging,\r\n                    provided.draggableProps.style\r\n                  )}\r\n                  className=\"p-shadow-1\"\r\n                >\r\n                <div style={{marginBottom: 5 }}>\r\n                  <div style={{ float: \"left\", paddingTop: 6 }}>\r\n                    <span style={{paddingLeft: \"15px\"}}>{field.id}</span>\r\n                    <span {...provided.dragHandleProps}>\r\n                      <i className=\"fas fa-arrows-alt\" style={{ float: \"left\", \"paddingTop\": 3 }}></i>\r\n                    </span>\r\n                  </div>\r\n                  <div style={{ textAlign: \"right\" }}>\r\n                    <Button type=\"text\" icon=\"pi pi-trash\" \r\n                      className=\"p-button-rounded p-button-text p-button-danger\"\r\n                      tooltip=\"Eliminar campo\"\r\n                      tooltipOptions={{position: 'bottom'}}                            \r\n                      onClick={ (e) => {\r\n                        e.preventDefault();\r\n                        confirmPopup({\r\n                            target: e.currentTarget,\r\n                            message: 'Tem a certeza que pretende eliminar?',\r\n                            icon: 'pi pi-exclamation-triangle',\r\n                            acceptLabel: 'Sim',\r\n                            rejectLabel: 'Não',\r\n                            accept: () => {                                      \r\n                              const new_fields = {...fields};\r\n                              delete new_fields[field.id];\r\n                              props.onChange(new_fields);\r\n                            }\r\n                        });\r\n                      }} />\r\n                      <Button type=\"text\" icon=\"pi pi-pencil\" \r\n                        className=\"p-button-rounded p-button-text p-button-warning\"\r\n                        tooltip=\"Editar campo\"\r\n                        tooltipOptions={{position: 'bottom'}}                              \r\n                        onClick={ (e) => {\r\n                          e.preventDefault();\r\n                          setFieldEdition({...field.data, key: field.id});\r\n                          setShowFieldForm(true);                                     \r\n                        }} />                                \r\n                    </div>\r\n                  </div>\r\n\r\n                  { showFieldForm && \r\n                    <FieldFormEditor data={fieldEdition} show={showFieldForm} onHide={onFieldFormHide} onSave={onFieldFormSave} />\r\n                  }\r\n\r\n                  <div className=\"p-fluid p-pt-2\">\r\n                    <div className=\"p-field p-grid p-mb-0\">\r\n                      <div class=\"p-col-10\">\r\n                        <div className=\"p-grid\">\r\n                          <label className=\"p-col-12 p-md-2\"><strong>Título: </strong></label>\r\n                          <div className=\"p-col-12 p-md-10\">\r\n                              <span>{field.data.title}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"p-col-2\">\r\n                        <div className=\"p-grid\">\r\n                          <div className=\"p-field-checkbox\">\r\n                              <Checkbox checked={field.data.active} disabled/>\r\n                              <label>Ativo</label>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"p-field p-grid\">\r\n                      <div class=\"p-col-12\">\r\n                        <div className=\"p-grid\">\r\n                          <label className=\"p-col-12 p-md-2\"><strong>Cabeçalho: </strong></label>\r\n                          <div className=\"p-col-12 p-md-10\">\r\n                              <span>{field.data.header}</span>\r\n                          </div>\r\n                        </div>                       \r\n                      </div>\r\n                    </div>\r\n                    <div className=\"p-field p-grid\">\r\n                      <div class=\"p-col-12\">\r\n                        <div className=\"p-field-checkbox\">\r\n                            <Checkbox checked={field.data.required} disabled/>\r\n                            <label>Preenchimento obrigatório</label>\r\n                        </div>\r\n                      </div>\r\n                    </div>                                        \r\n                  </div>\r\n\r\n                </div>\r\n              )}\r\n            </Draggable>\r\n          ))}\r\n          {provided.placeholder}\r\n        </div>\r\n      )}\r\n    </Droppable>\r\n  </DragDropContext>\r\n\r\n\r\n  );\r\n};\r\n\r\nclass FormFieldsEditor extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      data: props.data || {},\r\n      showGroupForm: false,\r\n      showFieldForm: false,\r\n    };\r\n\r\n    this.onDragEnd = this.onDragEnd.bind(this);\r\n\r\n    this.onChange = props.onChange.bind(this);\r\n    this.onFieldsChange = this.onFieldsChange.bind(this);\r\n    this.onGroupFieldsChange = this.onGroupFieldsChange.bind(this);\r\n\r\n    this.groupEdition = {};\r\n    this.onGroupFormHide = this.onGroupFormHide.bind(this);\r\n    this.onGroupFormSave = this.onGroupFormSave.bind(this);\r\n\r\n    this.fieldEdition = {};\r\n    this.onFieldFormHide = this.onFieldFormHide.bind(this);\r\n    this.onFieldFormSave = this.onFieldFormSave.bind(this);    \r\n  }\r\n\r\n  componentWillReceiveProps(props) {\r\n    this.setState({ data: props.data });\r\n  }\r\n\r\n  /*\r\n  componentDidUpdate() {\r\n  }\r\n  */\r\n\r\n  onDragEnd(result) {\r\n    // dropped outside the list\r\n    if (!result.destination) {\r\n      return;\r\n    }\r\n\r\n    if (result.type === \"GROUPS\") {\r\n      const groups = ReorderGroups(\r\n        //this.state.data,\r\n        this.state.data.groups,\r\n        result.source.index,\r\n        result.destination.index\r\n      );    \r\n      \r\n      this.onChange({...this.state.data, groups: groups});\r\n    } else if (result.type === \"FIELDS\") {\r\n      const fields = ReorderFields(\r\n        this.state.data.fields,\r\n        result.source.index,\r\n        result.destination.index\r\n      );\r\n      \r\n      this.onChange({...this.state.data, fields: fields });\r\n    } else {\r\n      const fields = ReorderFields(\r\n        this.state.data.groups[result.type].fields,\r\n        result.source.index,\r\n        result.destination.index\r\n      );\r\n\r\n      const data = JSON.parse(JSON.stringify(this.state.data.groups));\r\n      data[result.type].fields = fields;\r\n      \r\n      this.onChange({...this.state.data, groups: data });\r\n    }\r\n  }\r\n\r\n  onGroupFormHide() {\r\n    this.setState({\r\n      ...this.state,\r\n      showGroupForm: false\r\n    });    \r\n  }\r\n\r\n  onGroupFormSave(group) {\r\n    const key = group.key;\r\n\r\n    //Check key already exists\r\n    if (this.groupEdition.key !== key && this.state.data.groups[key]) return;\r\n\r\n    let new_data = {...this.state.data.groups};\r\n    if (new_data[key]) delete new_data[key];\r\n    new_data = {[key]: (({ active, title, fields }) => ({ active, title, fields }))(group), ...new_data};\r\n\r\n    this.setState({\r\n      ...this.state,\r\n      showGroupForm: false\r\n    });\r\n\r\n    this.onChange({ ...this.state.data, groups: new_data });\r\n  }\r\n\r\n  onGroupFieldsChange(groupId, fields) {\r\n    let new_data = {...this.state.data.groups};\r\n    if (new_data[groupId]) {\r\n      new_data[groupId].fields = fields;\r\n      this.onChange({...this.state.data, groups: new_data});\r\n    }\r\n  }\r\n\r\n  onFieldsChange(fields) {\r\n    this.onChange({...this.state.data, fields: {...fields}});\r\n  }  \r\n\r\n  onFieldFormHide() {\r\n    this.setState({\r\n      ...this.state,\r\n      showFieldForm: false\r\n    });    \r\n  }\r\n\r\n  onFieldFormSave(field) {\r\n    const groupId = field.groupId;\r\n    const key = field.key;\r\n\r\n    if (groupId) {\r\n      //Field belongs to a group\r\n\r\n      //Check key already exists\r\n      if (this.fieldEdition.key !== key && this.state.data.groups[groupId].fields[key]) return;\r\n\r\n      let new_data = {...this.state.data.groups};\r\n      if (new_data[groupId].fields[key]) delete new_data[groupId].fields[key];\r\n      new_data[groupId].fields = {[key]: (({ active, title, header, required }) => ({ active, title, header, required }))(field), ...new_data[groupId].fields};\r\n\r\n      this.setState({\r\n        ...this.state,\r\n        showFieldForm: false\r\n      });\r\n\r\n      this.onChange({...this.state.data, groups: new_data});\r\n    } else {\r\n      //Check key already exists\r\n      if (this.fieldEdition.key !== key && this.state.data.fields[key]) return;\r\n\r\n      let new_data = {...this.state.data.fields};\r\n      if (new_data[key]) delete new_data[key];\r\n      new_data = {[key]: (({ active, title, header, required }) => ({ active, title, header, required }))(field), ...new_data};\r\n\r\n      this.setState({\r\n        ...this.state,\r\n        showFieldForm: false\r\n      });\r\n\r\n      this.onChange({...this.state.data, fields: new_data});\r\n    }\r\n  }  \r\n\r\n\r\n  render() {\r\n    return (\r\n\r\n      <div className=\"p-fluid p-formgrid p-grid\">\r\n\r\n        { this.state.showFieldForm && \r\n          <FieldFormEditor data={this.fieldEdition} show={this.state.showFieldForm} onHide={this.onFieldFormHide} onSave={this.onFieldFormSave} />\r\n        }\r\n\r\n        <div className=\"p-field p-col-12 p-md-6\">\r\n          <Panel header=\"Campos\">\r\n\r\n            <div class=\"p-col-12\">\r\n\r\n              <div>\r\n                <div className=\"p-grid\">\r\n                  <div className=\"p-col-12 p-md-8\">\r\n                  </div>\r\n                  <div className=\"p-col-12 p-md-4 p-mt-2 p-mb-2\" >\r\n                    <Button\r\n                      type=\"button\"\r\n                      label=\"Novo Campo\"\r\n                      icon=\"pi pi-list\" \r\n                      className=\"p-button-outlined\"\r\n                      onClick={()=> {\r\n                        this.fieldEdition = { key: null, active: true, title: null, header: null};\r\n                        this.setState({\r\n                          ...this.state,              \r\n                          showFieldForm: true\r\n                        });\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <Fields fields={this.state.data.fields || {}} onDragEnd={this.onDragEnd} onChange={this.onFieldsChange} />\r\n\r\n            </div>\r\n\r\n          </Panel>\r\n        </div>\r\n\r\n        <div className=\"p-field p-col-12 p-md-6\">\r\n          <Panel header=\"Grupos\">\r\n\r\n          <div class=\"p-col-12\">\r\n\r\n            <div>\r\n              { this.state.showGroupForm && \r\n                <GroupFormEditor data={this.groupEdition} show={this.state.showGroupForm} onHide={this.onGroupFormHide} onSave={this.onGroupFormSave} />\r\n              }\r\n\r\n              <div className=\"p-grid\">\r\n                <div className=\"p-col-12 p-md-8\">\r\n                </div>           \r\n                <div className=\"p-col-12 p-md-4 p-mt-2 p-mb-2\" >\r\n                  <Button\r\n                    type=\"button\"\r\n                    label=\"Novo Grupo\"\r\n                    icon=\"pi pi-list\" \r\n                    className=\"p-button-outlined\"\r\n                    onClick={()=> {\r\n                      this.groupEdition = { key: null, active: true, title: null, fields: {}};\r\n                      this.setState({\r\n                        ...this.state,              \r\n                        showGroupForm: true\r\n                      });\r\n                    }}                 \r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <DragDropContext\r\n              onDragEnd={this.onDragEnd}\r\n              //onDragUpdate={this.onDragUpdate}          \r\n            >\r\n              <Droppable droppableId=\"droppable\" type=\"GROUPS\">\r\n                {(provided, snapshot) => (\r\n                  <div\r\n                    ref={provided.innerRef}\r\n                    style={getGroupListStyle(snapshot.isDraggingOver)}\r\n                  >\r\n                    {Object.keys(this.state.data.groups || {}).length === 0 &&\r\n                      <div className=\"p-fluid\">\r\n                        <div className=\"p-col-12\">\r\n                            <Message severity=\"info\" text=\"Clique em 'Novo Grupo' para adicionar um grupo\" />\r\n                        </div>\r\n                      </div>\r\n                    }                    \r\n\r\n                    {Object.entries(this.state.data.groups).map((g,i) => {\r\n                      return {id: g[0], data: g[1]}\r\n                    }).map((group, index) => (    \r\n                      <Draggable\r\n                        key={group.id}\r\n                        draggableId={group.id}\r\n                        index={index}\r\n                      >\r\n                        {(provided, snapshot) => (\r\n                          <div\r\n                            ref={provided.innerRef}\r\n                            {...provided.draggableProps}\r\n                            style={getItemStyle(\r\n                              snapshot.isDragging,\r\n                              provided.draggableProps.style                          \r\n                            )}\r\n                            className=\"p-shadow-1\"\r\n                          >\r\n                            <div>\r\n                              <div style={{ float: \"left\", paddingTop: \"6px\" }}>\r\n                                <span style={{paddingLeft: \"15px\"}}>{group.id}</span>\r\n                                <div {...provided.dragHandleProps} style={{ float: \"left\", paddingTop: '3px' }}>\r\n                                  <i className=\"fas fa-arrows-alt\" style={{ float: \"left\" }}></i>\r\n                                </div>\r\n                              </div>\r\n                              <div style={{ textAlign: \"right\"}}>\r\n                                <Button type=\"text\" icon=\"pi pi-plus-circle\" \r\n                                  className=\"p-button-rounded p-button-text p-button-warning p-mr-2\"\r\n                                  tooltip=\"Adicionar campo\"\r\n                                  tooltipOptions={{position: 'bottom'}}\r\n                                  onClick={ (e) => {\r\n                                    e.preventDefault();\r\n                                    this.fieldEdition = { groupId: group.id, key: null, active: true, title: null, header: null, required: false};\r\n                                    this.setState({\r\n                                      ...this.state,              \r\n                                      showFieldForm: true\r\n                                    });\r\n                                  }} />\r\n\r\n                                <Button type=\"text\" icon=\"pi pi-trash\" \r\n                                  className=\"p-button-rounded p-button-text p-button-danger\"\r\n                                  tooltip=\"Eliminar grupo\"\r\n                                  tooltipOptions={{position: 'bottom'}}\r\n                                  onClick={ (e) => {\r\n                                    e.preventDefault();\r\n                                    confirmPopup({\r\n                                        target: e.currentTarget,\r\n                                        message: 'Tem a certeza que pretende eliminar?',\r\n                                        icon: 'pi pi-exclamation-triangle',\r\n                                        acceptLabel: 'Sim',\r\n                                        rejectLabel: 'Não',\r\n                                        accept: () => { \r\n                                          const new_data = {...this.state.data.groups};\r\n                                          if (new_data[group.id]) delete new_data[group.id];\r\n                                          this.onChange({...this.state.data, groups: new_data});\r\n                                        }\r\n                                    });\r\n                                  }} />                            \r\n                                <Button type=\"text\" icon=\"pi pi-pencil\" \r\n                                  className=\"p-button-rounded p-button-text p-button-warning\"\r\n                                  tooltip=\"Editar grupo\"\r\n                                  tooltipOptions={{position: 'bottom'}}\r\n                                  onClick={ (e) => {\r\n                                    e.preventDefault();\r\n                                    this.groupEdition = {key: group.id, ...group.data}\r\n                                    this.setState({\r\n                                      ...this.state,\r\n                                      showGroupForm: true\r\n                                    }); \r\n                                  }} />\r\n                              </div>                        \r\n                            </div>\r\n\r\n                            <div><hr className=\"p-mt-1 p-pb-3\" /></div>\r\n\r\n                            <div className=\"p-fluid\">\r\n                              <div className=\"p-grid\">\r\n                                <div class=\"p-col-10\">\r\n                                  <div className=\"p-grid\">\r\n                                    <label className=\"p-col-12 p-md-2\"><strong>Título: </strong></label>\r\n                                    <div className=\"p-col-12 p-md-10\">\r\n                                        <span>{group.data.title}</span>\r\n                                    </div>\r\n                                  </div>\r\n                                </div>\r\n                                <div class=\"p-col-2\">\r\n                                  <div className=\"p-grid\">\r\n                                    <div className=\"p-field-checkbox\">\r\n                                        <Checkbox checked={true} disabled/>\r\n                                        <label>Ativo</label>\r\n                                    </div>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"p-grid\">\r\n                                <label className=\"p-col-12\"><strong>Campos:</strong></label>\r\n                                <div className=\"p-col-12\">\r\n                                  <GroupFields groupNum={group.id} group={group} onChange={this.onGroupFieldsChange} />\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </Draggable>\r\n                    ))}\r\n                    {provided.placeholder}\r\n                  </div>\r\n                )}\r\n              </Droppable>\r\n            </DragDropContext>\r\n\r\n            </div>\r\n\r\n\r\n          </Panel>\r\n        </div>\r\n        \r\n      </div>\r\n\r\n    );\r\n  }\r\n}\r\n\r\nexport default FormFieldsEditor;","import React, { useState, useEffect, useRef, Component } from \"react\";\r\nimport { Dialog } from 'primereact/dialog';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { Dropdown } from 'primereact/dropdown';\r\nimport { confirmPopup } from 'primereact/confirmpopup';\r\nimport { Toast } from 'primereact/toast';\r\nimport { classNames } from 'primereact/utils';\r\nimport { useForm, Controller } from 'react-hook-form';\r\n\r\nimport AceEditor from \"react-ace\";\r\nimport \"ace-builds/src-noconflict/mode-json\";\r\nimport \"ace-builds/src-noconflict/theme-github\";\r\n\r\n\r\nconst LayoutEditor = props => {\r\n\r\n  const { register, handleSubmit, control, reset, formState: { errors } } = useForm({\r\n    defaultValues: {...props.data}\r\n  });\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">O número de caracteres é superior à dimensão máxima permitida</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">Formato não permitido</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n\r\n  const onSave = (formData) => {\r\n    props.onSave(formData);\r\n  }\r\n\r\n  const renderFooter = (name) => {\r\n    return (\r\n        <div className=\"p-mt-4\">\r\n            <Button \r\n              label=\"Fechar\"\r\n              icon=\"pi pi-times\"\r\n              onClick={() => props.onHide()} className=\"p-button-text\" />\r\n            <Button \r\n              label=\"Gravar\"\r\n              icon={\"pi pi-check\"}\r\n              onClick={handleSubmit((d) => onSave(d))}\r\n              autoFocus />\r\n        </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Dialog header={\"Edição de Layout\"} visible={props.show} style={{ width: '50vw' }} footer={renderFooter} onHide={() => { props.onHide(); }}>\r\n      <form>\r\n        <div className=\"p-fluid p-formgrid p-grid\">\r\n          <div className=\"p-field p-col-12 p-md-6\">\r\n            <label htmlFor=\"format\">Formato</label>\r\n            <Controller name=\"format\" control={control} rules={{ required: 'Campo obrigatório.' }}\r\n              render={({ field }) => {\r\n                return <Dropdown id=\"format\" {...field}\r\n                  options={props.pageFormatList.map(val=>{return {label: val, value: val}})}\r\n                  onChange={(e) => field.onChange(e.value)}\r\n                  className={classNames({ 'p-invalid': errors.format})} />\r\n              }}                    \r\n            />            \r\n            {getFormErrorMessage(errors, 'format')}\r\n          </div>\r\n          <div className=\"p-field p-col-12 p-md-6\">\r\n            <label htmlFor=\"orientation\">Orientação</label>\r\n            <Controller name=\"orientation\" control={control} rules={{ required: 'Campo obrigatório.' }}\r\n              render={({ field }) => {\r\n                return <Dropdown id=\"orientation\" {...field}\r\n                  options={props.pageOrientationList.map(val=>{return {label: val, value: val}})}\r\n                  onChange={(e) => field.onChange(e.value)}\r\n                  className={classNames({ 'p-invalid': errors.format})} />\r\n              }}                    \r\n            />             \r\n            {getFormErrorMessage(errors, 'orientation')}\r\n          </div>\r\n          <div className=\"p-field p-col-12\">\r\n            <label htmlFor=\"config\">Configuração</label>\r\n            <div id=\"editor-parent\">\r\n\r\n              <Controller\r\n                control={control}\r\n                name=\"config\"\r\n                render={({ field }) => {\r\n\r\n                  return <AceEditor\r\n                    mode=\"json\"\r\n                    theme=\"github\"\r\n                    onLoad={editorInstance => {                \r\n                      editorInstance.container.style.setProperty('width', (document.getElementById('editor-parent').offsetWidth - 50) + 'px');               \r\n                    }}\r\n                    {...field}\r\n                    onChange={(newValue) => {\r\n                      field.onChange(newValue);\r\n                    }}\r\n                    value={field.value}\r\n                    name=\"layout-config\"         \r\n                    editorProps={{ $blockScrolling: true }}\r\n                    setOptions={{\r\n                      tabSize: 2\r\n                    }}              \r\n                  />\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n      </form>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\n\r\nconst PrintLayoutsEditor = props => {\r\n\r\n  const [records, setRecords] = useState(props.data ? [...props.data] : []);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);  \r\n\r\n  const [layoutEdition, setLayoutEdition] = useState();\r\n  const [showLayoutForm, setShowLayoutForm] = useState(false);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const dt = useRef(null);\r\n\r\n  useEffect(() => {\r\n   if (props?.data) setRecords(props.data.map((l) => { return {...l, key: createKey()} }));\r\n  }, [props.data]);\r\n\r\n  const findIndexByKey = (key) => {\r\n    let index = -1;\r\n    for (let i = 0; i < records.length; i++) {\r\n        if (records[i].key === key) {\r\n            index = i;\r\n            break;\r\n        }\r\n    }\r\n    return index;\r\n  }  \r\n\r\n  const createKey = () => {\r\n      let key = '';\r\n      let chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n      for (let i = 0; i < 5; i++) {\r\n          key += chars.charAt(Math.floor(Math.random() * chars.length));\r\n      }\r\n      return key;\r\n  }  \r\n  \r\n  const editRecord = (record) => {\r\n    setLayoutEdition({...record});\r\n    setShowLayoutForm(true);\r\n  }\r\n\r\n  const deleteRecord = (e, record) => {\r\n    confirmPopup({\r\n      target: e.currentTarget,\r\n      message: 'Tem a certeza que pretende eliminar?',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const _records = records.filter(val => val.key !== record.key);\r\n        console.log(_records);\r\n        props.onChange(_records.map(r => (({ id, format, orientation, config }) => ({ id, format, orientation, config }))(r)));\r\n        setSelectedRecords([]);\r\n      }\r\n    });\r\n  }\r\n\r\n  const deleteSelectedRecords = (e) => {\r\n    confirmPopup({\r\n      target: e.currentTarget,\r\n      message: 'Tem a certeza que pretende eliminar todos os layouts selecionados?',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const _keys = selectedRecords.map((r) => r.key);\r\n        //console.log(_keys);\r\n        const _records = records.filter(r => !_keys.includes(r.key));\r\n        //console.log(_records);\r\n        props.onChange(_records.map(r => (({ id, format, orientation, config }) => ({ id, format, orientation, config }))(r)));\r\n        setSelectedRecords([]);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  const onLayoutFormHide = () => {\r\n    setShowLayoutForm(false);\r\n    setLayoutEdition(null);\r\n  }\r\n\r\n  const onLayoutFormSave = (data) => {\r\n    console.log(data);\r\n\r\n    const _records = [...records];\r\n    const _record = {...data}\r\n\r\n    if (data.key) {\r\n      const index = findIndexByKey(data.key);\r\n      _records[index] = _record;\r\n    } else {\r\n      _record.key = createKey();\r\n      _records.push(_record);\r\n    }\r\n\r\n    //console.log(_records.map(r => (({ id, format, orientation, config }) => ({ id, format, orientation, config }))(r)));\r\n    props.onChange(_records.map(r => (({ id, format, orientation, config }) => ({ id, format, orientation, config }))(r)));\r\n    setSelectedRecords([]);\r\n    setShowLayoutForm(false);\r\n  }  \r\n\r\n  const leftToolbarTemplate = () => {\r\n    return null\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n      <React.Fragment>\r\n          <Button type=\"button\" label=\"Novo\" icon=\"pi pi-plus\" className=\"p-button-success p-mr-2\" \r\n            onClick={() => {\r\n              editRecord({ key: '' });\r\n            }}\r\n          />\r\n          <Button type=\"button\"  label=\"Eliminar\" icon=\"pi pi-trash\" className=\"p-button-danger\" \r\n            disabled={!selectedRecords || !selectedRecords.length} \r\n            onClick={(e) => {\r\n              deleteSelectedRecords(e);\r\n            }}\r\n          />\r\n      </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    return (\r\n      <div style={{textAlign: \"right\"}}>\r\n          <Button type=\"button\" icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success p-mr-2\" onClick={(e) => {\r\n            editRecord(rowData);\r\n          }} />\r\n          <Button type=\"button\" icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={(e) => {\r\n            deleteRecord(e, rowData);\r\n          }} />\r\n      </div>\r\n    );\r\n  }  \r\n\r\n  return (\r\n    <div>\r\n      <Toast ref={toast} baseZIndex={2000} />\r\n\r\n      { showLayoutForm && \r\n        <LayoutEditor data={layoutEdition} \r\n          pageFormatList={props.pageFormatList}\r\n          pageOrientationList={props.pageOrientationList}\r\n          show={showLayoutForm} \r\n          onHide={onLayoutFormHide} \r\n          onSave={onLayoutFormSave} />\r\n      }\r\n\r\n      <div className=\"card\">\r\n        <Toolbar className=\"p-mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n        <DataTable ref={dt} value={records ? records : []}\r\n            selection={selectedRecords} onSelectionChange={(e) => setSelectedRecords(e.value)}\r\n            emptyMessage=\"Não foram encontrados registos.\" >\r\n            <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n            <Column field=\"id\" header=\"Id\" sortable filterPlaceholder=\"Id\" headerStyle={{ width: '6rem' }} />\r\n            <Column field=\"format\" header=\"Formato\" sortable filterPlaceholder=\"Format\" />\r\n            <Column field=\"orientation\" header=\"Orientação\" sortable filterPlaceholder=\"Orientação\" />\r\n            <Column body={actionBodyTemplate} />\r\n        </DataTable>\r\n      </div>      \r\n    </div>\r\n  )\r\n\r\n}\r\n\r\nexport default PrintLayoutsEditor;","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { TabMenu } from 'primereact/tabmenu';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { InputMask } from 'primereact/inputmask';\r\nimport { Dropdown } from 'primereact/dropdown';\r\nimport {Checkbox} from 'primereact/checkbox';\r\nimport { Button } from 'primereact/button';\r\nimport { Panel } from 'primereact/panel';\r\nimport { ToggleButton } from 'primereact/togglebutton';\r\nimport { MultiSelect } from 'primereact/multiselect';\r\nimport { OverlayPanel } from 'primereact/overlaypanel';\r\n\r\nimport GeometryFilterEditor from \"./GeometryFilterEditor\";\r\nimport FormFieldsEditor from \"../common/FormFieldsEditor\";\r\nimport PrintLayoutsEditor from \"./PrintLayoutsEditor\";\r\n\r\nimport AceEditor from \"react-ace\";\r\nimport \"ace-builds/src-noconflict/mode-json\";\r\nimport \"ace-builds/src-noconflict/theme-github\";\r\n\r\nimport { classNames } from 'primereact/utils';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\nimport { isAdminOrManager } from '../../utils';\r\n\r\n\r\nconst buildScaleList = (list1, list2) => {\r\n  const list = [...new Set([...(list1 || []) ,...(list2 || [])])].sort((a, b)=>{return a-b});\r\n  return list;\r\n}\r\n\r\nconst sortRolesArray = (data) => {\r\n  if (!data) return data;\r\n\r\n  return data.sort(function(a, b) {\r\n    if (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\r\n    if (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nconst tabItems = [\r\n  { label: 'Dados Base', icon: 'pi pi-fw pi-home' },\r\n  { label: 'Configuração', icon: 'pi pi-fw pi-cog' },  \r\n  { label: 'Formulário', icon: 'pi pi-fw pi-home' },\r\n  { label: 'Layouts', icon: 'pi pi-fw pi-home' },\r\n];\r\n\r\nconst pageFormatList = ['A4', 'A3', 'A2', 'A1', 'A0'];\r\nconst pageOrientationList = ['Retrato', 'Paisagem'];\r\n\r\nfunction PrintForm(props) {\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [activeIndex, setActiveIndex] = useState(0);\r\n\r\n  const [data, setData] = useState(props.data);\r\n\r\n  const [roles, setRoles] = useState(props?.data?.roles ? sortRolesArray([...props.data.roles]) : []);\r\n  const [availableRoles, setAvailableRoles] = useState(null);\r\n  const [selectedRoles, setSelectedRoles] = useState(null);\r\n  const [removedRoles, setRemovedRoles] = useState(null);\r\n  const [filterRolesValue, setFilterRolesValue] = useState('');\r\n\r\n  const [availableUsers, setAvailableUsers] = useState(null);\r\n  const [selectedOwner, setSelectedOwner] = useState(data?.owner ? { id: data.owner.id, username: data.owner.username, name: data.owner.name, active: data.owner.active } : null);\r\n\r\n  const [coordinateSystems, setCoordinateSystems] = useState(null);\r\n  \r\n  const [scaleList, setScaleList] = useState(buildScaleList([1000,2000,5000,10000,20000,25000,50000], data.restrict_scales_list));\r\n\r\n  const [formFields, setFormFields] = useState(props.data?.form_fields || { fields: {}, groups:{} });\r\n  const [layouts, setLayouts] = useState(props.data?.layouts || []);\r\n  const [geometryFilter, setGeometryFilter] = useState();\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n  const op = useRef(null);\r\n\r\n  const adminOrManager = isAdminOrManager(props.auth);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {\r\n      id: data.id,\r\n      code: data.code,\r\n      config_json: data.config_json,\r\n      description: data.description,\r\n      allow_drawing: data.allow_drawing,\r\n      draw_location: data.draw_location,\r\n      //form_fields: data.form_fields,\r\n      format: data.format,\r\n      free_printing: data.free_printing,\r\n      free_scale: data.free_scale,\r\n      identification: data.identification,\r\n      identification_fields: data.identification_fields,\r\n      is_active: data.is_active,\r\n      //layouts: data.layouts,\r\n      location_marking: data.location_marking,\r\n      map_scale: data.map_scale,\r\n      multi_geom: data.multi_geom,\r\n      name: data.name,\r\n      orientation: data.orientation,\r\n      owner_id: data.owner_id,\r\n      payment_reference: data.payment_reference,\r\n      print_purpose: data.print_purpose,\r\n      restrict_scales: data.restrict_scales,\r\n      restrict_scales_list: data.restrict_scales_list,\r\n      scale: data.scale,\r\n      add_title: data.add_title,\r\n      show_author: data.show_author,\r\n      srid: data.srid,\r\n      title: data.title\r\n    }\r\n  });\r\n\r\n  const restrictScales = watch(\"restrict_scales\");\r\n\r\n  useEffect(() => {\r\n    const params = {\r\n      pagination: { page: 1, perPage: 1000},\r\n      sort: { field: 'name', order: 'Asc' },\r\n      filter: {}\r\n    }  \r\n\r\n    Promise.all([\r\n      dataProvider(API_URL + '/security').getList('roles', params).catch((error) => error),\r\n      dataProvider(API_URL + '/security').getList('users', params).catch((error) => error),\r\n      dataProvider(API_URL + '/portal/lists').getList('coordinate_systems', params).catch((error) => error),\r\n    ]).then((result) => {      \r\n      const roles_result = result[0];\r\n      const rids = props?.data?.roles ? props.data.roles.map(v => v.id) : [];\r\n      setAvailableRoles(sortRolesArray(roles_result.data.filter(v => !rids.includes(v.id))\r\n        .map(r => { return { id: r.id, name: r.name} })));\r\n\r\n      setAvailableUsers(result[1].data.map( u => { return { id: u.id, username: u.username, name: u.name, active: u.active}}));\r\n\r\n      if (!(props?.data?.id)) {\r\n        const owner = result[1].data.find(u => u.email === props.auth.data.username);\r\n        if (owner) {\r\n          setSelectedOwner({ id: owner.id, username: owner.username, name: owner.name, active: owner.active});\r\n        }\r\n      }\r\n\r\n      const crs_result = result[2]?.data || [];\r\n      setCoordinateSystems(crs_result.map( c => { return { value: parseInt(c.config_json.srid), label: c.config_json.title }; }));\r\n\r\n    }).catch((error) => {\r\n      console.log(error)\r\n    });    \r\n  }, []);\r\n\r\n  const addRoles = () => {\r\n    if (!availableRoles) return;\r\n    \r\n    const new_roles = availableRoles.filter(v => selectedRoles.includes(v.id));\r\n    const new_available_roles = availableRoles.filter(v => !selectedRoles.includes(v.id));\r\n\r\n    setRoles(sortRolesArray([...roles, ...new_roles]));\r\n    setAvailableRoles(sortRolesArray([...new_available_roles]));\r\n    setSelectedRoles(null);\r\n    setRemovedRoles(null);\r\n  }\r\n\r\n  const removeRoles = () => {\r\n    if (!removedRoles) return;\r\n    \r\n    const new_available_roles = roles.filter(v => removedRoles.includes(v.id));\r\n    const new_roles = roles.filter(v => !removedRoles.includes(v.id));\r\n\r\n    setRoles(sortRolesArray([...new_roles]));\r\n    setAvailableRoles(sortRolesArray([...availableRoles, ...new_available_roles]));\r\n    setRemovedRoles(null);\r\n    setSelectedRoles(null);\r\n  } \r\n\r\n  const goBack = () => {\r\n    const location = {\r\n      pathname: history.location.state.from,\r\n      state: { \r\n        searchParams: {...history.location.state.previousSearchParams}\r\n      }\r\n    }\r\n    history.replace(location);\r\n    //history.goBack();\r\n  }  \r\n\r\n  const onSubmit = (formData) => {\r\n\r\n    //console.log(formData);\r\n\r\n    let new_data = {\r\n      ...formData,\r\n      form_fields: formFields ? {...formFields}  : {},\r\n      layouts: layouts ? [...layouts]: []\r\n    }\r\n\r\n    if (geometryFilter) {\r\n      new_data = {\r\n        ...new_data,\r\n        ...geometryFilter\r\n      }\r\n    }\r\n\r\n    //console.log(new_data);\r\n\r\n    setIsSaving(true);\r\n\r\n    const provider = dataProvider(API_URL + '/portal');      \r\n    if (data.id) {\r\n      const params = {\r\n        id: data.id,\r\n        data: {...new_data}\r\n      }\r\n      provider.update('prints', params).then(d => {       \r\n        toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});\r\n        setLayouts(d?.data ? [...(d.data.layouts || [])] : []);\r\n      }).catch(e => {\r\n        toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});        \r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });\r\n    } else {\r\n      const params = {\r\n        data: {...new_data}\r\n      }\r\n      provider.create('prints', params).then(d => {\r\n        setData({...data, id: d.data.id});\r\n        setLayouts(d?.data ? [...(d.data.layouts || [])] : []);\r\n        toast.current.show({life: 5000, severity: 'success', summary: 'Criar Registo', detail: 'Registo criada com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Criar Registo', detail: 'Ocorreu um erro ao criar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });       \r\n    }\r\n\r\n  };\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">O número de caracteres é superior à dimensão máxima permitida</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">Formato não permitido</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n              type=\"button\" \r\n              label=\"Voltar\" \r\n              icon=\"pi pi-left\" \r\n              className=\"p-button-secondary p-mr-4\"\r\n              disabled={isSaving ? true : false} \r\n              onClick={goBack} />\r\n            <Button\r\n              type=\"submit\" \r\n              label=\"Gravar\"\r\n              icon={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n              disabled={isSaving ? true : false} />\r\n        </React.Fragment>\r\n    )\r\n  }  \r\n \r\n  return (\r\n    <React.Fragment>      \r\n\r\n      <TabMenu model={tabItems} activeIndex={activeIndex} onTabChange={(e) => setActiveIndex(e.index)} />\r\n\r\n      <OverlayPanel ref={op} showCloseIcon dismissable>\r\n          <div className=\"p-fluid p-grid\">\r\n            <label>Adicionar escala</label>\r\n            <InputMask id=\"addScale\" \r\n              onChange={(e) => { \r\n                if (e.originalEvent.key === 'Enter' || e.originalEvent.keyCode === 13) {\r\n                    if (e.value) {\r\n                      setScaleList([...scaleList, e.value].sort((a, b)=>{return a-b}));\r\n                      op.current.hide();\r\n                    }\r\n                }\r\n              }}\r\n              mask=\"1:9?99999999\" unmask={true} autoClear={false} />\r\n          </div>\r\n      </OverlayPanel>\r\n\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n        <Toast ref={toast} baseZIndex={2000} />       \r\n\r\n        {activeIndex === 0 ?\r\n          <div className=\"card\">\r\n\r\n            <div className=\"p-fluid p-formgrid p-grid\">\r\n\r\n              <div className=\"p-field p-col-1\">\r\n                <label htmlFor=\"id\">Id</label>\r\n                <InputText id=\"id\" type=\"text\" value={data.id || ''} />\r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-2\">\r\n                <label htmlFor=\"code\">Código</label>        \r\n                <InputText id=\"code\" name=\"code\" {...register('code', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.code })} />\r\n                {getFormErrorMessage(errors, 'code')}\r\n                {/*{errors.name && <span>This field is required</span>}*/}\r\n              </div>              \r\n\r\n              <div className=\"p-field p-col-12 p-md-7\">\r\n                <label htmlFor=\"name\">Designação</label>        \r\n                <InputText id=\"name\" name=\"name\" {...register('name', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.name })} />\r\n                {getFormErrorMessage(errors, 'name')}\r\n                {/*{errors.name && <span>This field is required</span>}*/}\r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-2\">\r\n                <label>&nbsp;</label>\r\n                <Controller\r\n                  control={control}\r\n                  name=\"is_active\"\r\n                  render={({ field }) => {\r\n                    return <ToggleButton {...field} checked={field.value} onChange={(e) => field.onChange(e.target.value)} onLabel=\"Planta Ativa\" offLabel=\"Planta Não Ativa\" onIcon=\"pi pi-check\" offIcon=\"pi pi-times\" />\r\n                  }} \r\n                />                 \r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-12\">\r\n                <label htmlFor=\"name\">Título</label>        \r\n                <InputText id=\"title\" name=\"title\" {...register('title', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.title })} />\r\n                {getFormErrorMessage(errors, 'title')}       \r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-12\">\r\n                <label htmlFor=\"name\">Descrição</label>        \r\n                <InputText id=\"description\" name=\"description\" {...register('description')} />   \r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-6\">\r\n                <div className=\"p-grid\">\r\n                  <div className=\"p-col p-field\">\r\n                    <label htmlFor=\"scale\">Escala</label>                    \r\n                    <Controller name=\"scale\" control={control}\r\n                      render={({ field }) => {\r\n                        return <InputMask id=\"scale\" {...field} onChange={(e) => field.onChange(e.value)} mask=\"1:999?999999\" unmask={true} autoClear={false} />\r\n                      }}                    \r\n                    />\r\n                  </div>\r\n                  <div className=\"p-col p-field\">\r\n                    <label htmlFor=\"format\">Formato</label>\r\n                    <Controller name=\"format\" control={control}\r\n                      render={({ field }) => {\r\n                        return <Dropdown id=\"format\" {...field} options={pageFormatList.map(val=>{return {label: val, value: val}})} onChange={(e) => field.onChange(e.value)} showClear />\r\n                      }}                    \r\n                    />\r\n                  </div>\r\n                  <div className=\"p-col p-field\">\r\n                    <label htmlFor=\"format\">Orientação</label>\r\n                    <Controller name=\"orientation\" control={control}\r\n                      render={({ field }) => {\r\n                        return <Dropdown id=\"orientation\" {...field} options={pageOrientationList.map(val=>{return {label: val, value: val}})} onChange={(e) => field.onChange(e.value)} showClear />\r\n                      }}                    \r\n                    />                    \r\n                  </div>                                   \r\n                </div>\r\n                <div className=\"p-grid\">\r\n                  <div className=\"p-col p-field\">\r\n                    <label htmlFor=\"format\">Sistema de Coordenadas</label>\r\n                    <Controller name=\"srid\" control={control} rules={{ required: 'Campo obrigatório.' }}\r\n                      render={({ field }) => {\r\n                        return <Dropdown id=\"srid\" {...field} options={coordinateSystems} \r\n                          onChange={(e) => field.onChange(e.value)} \r\n                          className={classNames({ 'p-invalid': errors.srid})} />\r\n                      }}                    \r\n                    />\r\n                    {getFormErrorMessage(errors, 'srid')}\r\n                  </div>                  \r\n                </div>\r\n              </div>  \r\n\r\n              <div className=\"p-field p-col-12 p-md-6\">\r\n                <Panel header=\"Filtro Geográfico\">\r\n                  <GeometryFilterEditor \r\n                    data={\r\n                      (\r\n                        geometryFilter ?\r\n                        {\r\n                          geometryWKT: geometryFilter.geom_filter,\r\n                          geometrySRID: geometryFilter.geom_filter_srid,\r\n                          tolerance: geometryFilter.tolerance_filter\r\n                        } :\r\n                        {\r\n                          geometryWKT: props.data?.geom_filter,\r\n                          geometrySRID: props.data?.geom_filter_srid,\r\n                          tolerance: props.data?.tolerance_filter\r\n                        }\r\n                      )\r\n                    }\r\n                    coordinateSystems={props.coordinateSystems} \r\n                    onSave={ data => {\r\n                      const filter = {\r\n                        geom_filter: data.geometryWKT,\r\n                        geom_filter_srid: data.geometrySRID,\r\n                        tolerance_filter: data.tolerance\r\n                      }\r\n                      setGeometryFilter(filter);\r\n                    }}\r\n                  />\r\n                </Panel>\r\n              </div>                \r\n                \r\n              <div className=\"p-field p-col-12 p-md-6\"> \r\n                <Panel header=\"Opções de Escalas\">\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"free_scale\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"free_scale\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />                            \r\n                      <label htmlFor=\"map_scale\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Escala livre</label>\r\n                    </div>\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"map_scale\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"map_scale\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />                            \r\n                      <label htmlFor=\"map_scale\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Escala do mapa</label>\r\n                    </div>                    \r\n                  </div>\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-3\">\r\n                      <Controller name=\"restrict_scales\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"restrict_scales\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />\r\n                      <label htmlFor=\"cb1\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Escalas restritas</label>\r\n                    </div>\r\n                    {restrictScales && (\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <div className=\"p-inputgroup\"> \r\n                        <Controller name=\"restrict_scales_list\" control={control}\r\n                          render={({ field }) => {                                                  \r\n                            return <MultiSelect id=\"restrict_scales_list\"\r\n                              {...field}\r\n                              value={field.value}\r\n                              options={scaleList.map(s => {return {value: s, name: '1:' + s}})}\r\n                              onChange={(e) => field.onChange(e.value)}\r\n                              optionValue=\"value\" optionLabel=\"name\"\r\n                              selectedItemsLabel=\"{0} escalas selecionadas\" />                          \r\n                          }}\r\n                        />\r\n                        <Button type=\"button\" icon=\"pi pi-ellipsis-v\" className=\"p-button-primary\" \r\n                          onClick={(e) => op.current.toggle(e)} />\r\n                      </div>                           \r\n                    </div>\r\n                    )}                                       \r\n                  </div>\r\n                </Panel>\r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-6\">\r\n                <Panel header=\"Opções de impressão\" className=\"p-pb-1\">\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"identification\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"identification\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />                       \r\n                      <label htmlFor=\"identification\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Identificação obrigatória</label>\r\n                    </div>\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"add_title\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"add_title\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />                       \r\n                      <label htmlFor=\"add_title\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Adicionar título</label>\r\n                    </div>\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"free_printing\" control={control}\r\n                        render={({ field }) => {\r\n                          return <Checkbox id=\"free_printing\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}\r\n                      />\r\n                      <label htmlFor=\"free_printing\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Emissão livre</label>\r\n                    </div>\r\n                  </div>\r\n                </Panel>\r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-6\">\r\n                <Panel header=\"Marcação de local e geometrias\" className=\"p-mt-2\">\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"allow_drawing\" control={control}\r\n                        render={({ field }) => {\r\n                          return <Checkbox id=\"allow_drawing\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}\r\n                      />\r\n                      <label htmlFor=\"allow_drawing\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Permitir desenhar</label>\r\n                    </div>\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"location_marking\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"location_marking\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />                            \r\n                      <label htmlFor=\"location_marking\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Obrigatório marcar local</label>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"draw_location\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"draw_location\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />\r\n                      <label htmlFor=\"cb1\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Desenhar local</label>\r\n                    </div>\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"multi_geom\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"multi_geom\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />\r\n                      <label htmlFor=\"cb1\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Múltiplas geometrias</label>\r\n                    </div>                                        \r\n                  </div>\r\n                </Panel>               \r\n              </div>              \r\n\r\n            </div>  \r\n\r\n          </div>     \r\n\r\n        : null}\r\n\r\n        {activeIndex === 1 ?\r\n\r\n          <div className=\"card\">\r\n\r\n            <div className=\"p-field p-col-12\">\r\n              <label htmlFor=\"orientation\">Configuração</label>\r\n              <div id=\"config-editor-parent\">\r\n\r\n                <Controller\r\n                  control={control}\r\n                  name=\"config_json\"\r\n                  render={({ field }) => {\r\n\r\n                    return <AceEditor\r\n                      mode=\"json\"\r\n                      theme=\"github\"\r\n                      onLoad={editorInstance => {                \r\n                        editorInstance.container.style.setProperty('width', (document.getElementById('config-editor-parent').offsetWidth - 50) + 'px');               \r\n                      }}\r\n                      {...field}\r\n                      onChange={(newValue) => {\r\n                        //console.log(newValue);\r\n                        field.onChange(newValue);\r\n                      }}\r\n                      value={field.value}\r\n                      name=\"print-config\"         \r\n                      editorProps={{ $blockScrolling: true }}\r\n                      setOptions={{\r\n                        tabSize: 2\r\n                      }}              \r\n                    />\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n\r\n        : null}\r\n\r\n        {activeIndex === 2 ?\r\n\r\n          <div className=\"card\">\r\n\r\n            <FormFieldsEditor data={formFields}\r\n              onChange={(data) => {\r\n              //console.log(JSON.stringify(data));\r\n              setFormFields(data);\r\n              }} \r\n            />\r\n\r\n          </div>\r\n\r\n        : null}          \r\n          \r\n        {activeIndex === 3 ?\r\n\r\n          <div className=\"card\">\r\n\r\n            <div className=\"p-fluid p-formgrid p-grid\">\r\n              <PrintLayoutsEditor data={layouts}\r\n                pageFormatList={pageFormatList} pageOrientationList={pageOrientationList}\r\n                onChange={(data) => {\r\n                  //console.log(JSON.stringify(data));\r\n                  console.log(data);\r\n                  setLayouts(data);\r\n                }}\r\n              />\r\n            </div>\r\n\r\n          </div>\r\n\r\n        : null} \r\n\r\n\r\n        <Toolbar className=\"p-mt-4 p-mb-4\" right={rightToolbarTemplate}></Toolbar>        \r\n\r\n      </form>\r\n\r\n\r\n    </React.Fragment>\r\n\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ auth: state.auth }))(withRouter(PrintForm));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport PrintForm from './PrintForm';\r\n\r\n\r\nfunction PrintEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const { id } = useParams();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [record, setRecord] = useState(null);\r\n  const [roles, setRoles] = useState([]);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/portal');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setLoading(true);  \r\n\r\n    provider.getOne('prints', params).then(d => {\r\n      //Change restrict_scales_list from string to array\r\n      const tmp_data = d.data;\r\n      if (tmp_data.restrict_scales_list && ((typeof tmp_data.restrict_scales_list === 'string' || tmp_data.restrict_scales_list instanceof String))) {\r\n        tmp_data.restrict_scales_list = tmp_data.restrict_scales_list.split(',').map(s => parseInt(s));\r\n      }\r\n      setRecord(tmp_data);\r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      //toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n    { record ?\r\n      <PrintForm data={record} coordinateSystems={ props?.backoffice?.config_json ? props.backoffice.config_json.coordinate_systems || [] : []} />\r\n      :\r\n      <div>loading...</div>\r\n    }\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, backoffice: state.backoffice }))(withRouter(PrintEdit));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { Chip } from 'primereact/chip';\r\nimport { confirmDialog } from 'primereact/confirmdialog';\r\nimport { Toast } from 'primereact/toast';\r\n\r\nimport AppContext from '../../../AppContext'\r\nimport dataProvider from '../../../service/DataProvider';\r\nimport { isAdminOrManager } from '../../utils';\r\n\r\n\r\nconst initialSearchParams = {\r\n  filters: {},\r\n  first: 0,\r\n  rows: 20,\r\n  page: 0,\r\n  sortField: 'id',\r\n  sortOrder: 1\r\n}\r\n\r\n\r\nfunction PrintList(props) {\r\n\r\n  const {\r\n    history,\r\n    printsFilter\r\n  } = props;\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(false);  \r\n  const [records, setRecords] = useState([]);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n\r\n  const [searchParams, setSearchParams] = useState({...initialSearchParams});\r\n\r\n  const loaded = useRef(false);\r\n  const dt = useRef(null);\r\n\r\n  const auth = core.store.getState().auth;\r\n  const adminOrManager = isAdminOrManager(auth)\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (!loaded.current) return;\r\n\r\n    loaded.current = true;\r\n    if (printsFilter) {\r\n      setSearchParams(...printsFilter);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, [searchParams]);\r\n  \r\n  \r\n  const newRecord = () => {\r\n    const location = {\r\n      pathname: '/prints/create',\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);   \r\n  }\r\n\r\n  const editRecord = (record) => {\r\n    const location = {\r\n      pathname: `/prints/edit/${record.id}`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);    \r\n  }  \r\n\r\n  const deleteSelectedRecords = () => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o(s) registo(s) selecionado(s)?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal');\r\n        const params = {\r\n          ids: selectedRecords.map(v => v.id)\r\n        }\r\n        provider.deleteMany('prints', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo(s)', detail: 'Registo(s) eliminado(s) com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo(s)', detail: 'Ocorreu um erro ao eliminar o(s) registo(s)'}); \r\n        }).finally(() => {\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }\r\n\r\n  const deleteRecord = (record) => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o registo selecionado?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal');\r\n        const params = {\r\n          id: record.id\r\n        }      \r\n        provider.delete('prints', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo', detail: 'Registo eliminado com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo', detail: 'Ocorreu um erro ao eliminar o registo'}); \r\n        }).finally(() => {\r\n          //console.log('finally');\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }  \r\n\r\n  const exportCSV = () => {\r\n    //TODO: implement export\r\n    //dt.current.exportCSV();\r\n  }\r\n\r\n  const loadData = (filters) => {\r\n    const provider = dataProvider(API_URL + '/portal');\r\n  \r\n    const _filter = {};\r\n    if (filters) {\r\n      Object.entries(filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    } else if (searchParams.filters) {\r\n      Object.entries(searchParams.filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    }\r\n\r\n    const params = {\r\n      pagination: { page: searchParams.page + 1, perPage: searchParams.rows},\r\n      sort: { field: searchParams.sortField, order: searchParams.sortOrder == -1 ? 'Desc' : 'Asc' },\r\n      filter: _filter\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    provider.getList('prints', params).then(d => {\r\n      setSelectedRecords(null);\r\n      setRecords({ ...d, page: searchParams.page });\r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Plantas', detail: 'Ocorreu um erro na pesquisa'});\r\n    });\r\n  }\r\n\r\n  const onPage = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onSort = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onFilter = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    _searchParams['first'] = 0;\r\n    setSearchParams(_searchParams);    \r\n  }\r\n\r\n  const onFilterClear = (event) => {\r\n    setSearchParams({ ...initialSearchParams});    \r\n  }\r\n\r\n  const groupsTemplate = (rowData) => {\r\n    return (\r\n        <React.Fragment>\r\n          { rowData.groups && rowData.groups.map( (item) => <Chip key={item.id} label={item.code} className=\"p-mr-2 p-mb-2\" /> ) }\r\n        </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const viewersTemplate = (rowData) => {\r\n    return (\r\n        <React.Fragment>\r\n          { rowData.viewers && rowData.viewers.map( (item) => <Chip key={item.id} label={item.name} className=\"p-mr-2 p-mb-2\" /> ) }\r\n        </React.Fragment>\r\n    );\r\n  } \r\n\r\n  const ownerTemplate = (rowData) => {\r\n    let elem = <Chip label=\"Anónimo\" icon=\"far fa-user\" className=\"p-mr-2 p-mb-2\" />;\r\n\r\n    if (rowData?.owner?.id > 0) {\r\n      if (rowData.owner.active) {\r\n        elem = <Chip label={rowData.owner.username} icon=\"fas fa-user-alt\" className=\"p-mr-2 p-mb-2\" /> \r\n      } else {\r\n        elem = <Chip label={rowData.owner.username} icon=\"fas fa-user-alt-slash\" className=\"p-mr-2 p-mb-2\" /> \r\n      }\r\n    }\r\n\r\n    return elem;\r\n  }\r\n\r\n  const leftToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Novo\" icon=\"pi pi-plus\" className=\"p-button-success p-mr-2\" onClick={newRecord} />\r\n            <Button label=\"Eliminar\" icon=\"pi pi-trash\" className=\"p-button-danger\" onClick={deleteSelectedRecords} disabled={!selectedRecords || !selectedRecords.length} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n      return (\r\n          <React.Fragment>              \r\n              <Button label=\"Limpar\" icon=\"pi pi-times\" className=\"p-button-help p-mr-2\" onClick={onFilterClear} />\r\n              {/*<Button label=\"Export\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} />*/}\r\n          </React.Fragment>\r\n      )\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success p-mr-2\" onClick={() => editRecord(rowData)} />\r\n            <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => deleteRecord(rowData)} />\r\n        </React.Fragment>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"p-col-12\"><h3>Emissão de Plantas - Plantas</h3></div>\r\n\r\n      <div className=\"p-grid p-fluid print-list\">\r\n        <Toast ref={toast} baseZIndex={2000} />\r\n        <div className=\"card\">\r\n          <Toolbar className=\"p-mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n          <DataTable ref={dt} value={records ? records.data : []} lazy\r\n              selectionMode=\"checkbox\"\r\n              selection={selectedRecords} onSelectionChange={(e) => setSelectedRecords(e.value)}\r\n              paginator first={searchParams.first} rows={searchParams.rows} totalRecords={records.total} onPage={onPage}\r\n              onSort={onSort} sortField={searchParams.sortField} sortOrder={searchParams.sortOrder}\r\n              filters={searchParams.filters} onFilter={onFilter} loading={loading}\r\n              emptyMessage=\"Não foram encontrados registos.\" >\r\n              <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n              <Column field=\"id\" header=\"Id\" sortable filter filterPlaceholder=\"Id\" headerStyle={{ width: '6rem' }} />\r\n              <Column field=\"code\" header=\"Código\" sortable filter filterPlaceholder=\"Código\" style={{\"wordBreak\": \"break-all\"}} />\r\n              <Column field=\"name\" header=\"Nome\" sortable filter filterPlaceholder=\"Nome\" style={{\"wordBreak\": \"break-all\"}} />\r\n              <Column field=\"title\" header=\"Título\" sortable filter filterPlaceholder=\"Título\" style={{\"wordBreak\": \"break-all\"}} /> \r\n              <Column field=\"groups\" header=\"Grupos\" body={groupsTemplate} />\r\n              <Column field=\"viewers\" header=\"Visualizadores\" body={viewersTemplate} />\r\n              { adminOrManager && <Column field=\"owner\" header=\"Dono\" body={ownerTemplate} /> }\r\n              <Column body={actionBodyTemplate} />\r\n          </DataTable>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, filters: state.filters }))(withRouter(PrintList));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter  } from 'react-router-dom';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { TabMenu } from 'primereact/tabmenu';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { InputMask } from 'primereact/inputmask';\r\nimport {Checkbox} from 'primereact/checkbox';\r\nimport { Button } from 'primereact/button';\r\nimport { Panel } from 'primereact/panel';\r\nimport { ToggleButton } from 'primereact/togglebutton';\r\nimport { MultiSelect } from 'primereact/multiselect';\r\nimport { OverlayPanel } from 'primereact/overlaypanel';\r\n\r\nimport GeometryFilterEditor from \"./GeometryFilterEditor\";\r\nimport PrintLayoutsEditor from \"./PrintLayoutsEditor\";\r\nimport FormFieldsEditor from \"../common/FormFieldsEditor\";\r\nimport PrintGroupChildsEditor from \"../common/PrintGroupChildsEditor\";\r\n\r\nimport { classNames } from 'primereact/utils';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\nimport { isAdminOrManager } from '../../utils';\r\n\r\n\r\nconst buildScaleList = (list1, list2) => {\r\n  const list = [...new Set([...(list1 || []) ,...(list2 || [])])].sort((a, b)=>{return a-b});\r\n  return list;\r\n}\r\n\r\nconst sortRolesArray = (data) => {\r\n  if (!data) return data;\r\n\r\n  return data.sort(function(a, b) {\r\n    if (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\r\n    if (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nconst tabItems = [\r\n  { label: 'Dados Base', icon: 'pi pi-fw pi-home' },\r\n  { label: 'Formulário', icon: 'pi pi-fw pi-home' },\r\n  { label: 'Layouts', icon: 'pi pi-fw pi-home' },\r\n  { label: 'Plantas e Grupos', icon: 'pi pi-fw pi-cog' },  \r\n];\r\n\r\nconst pageFormatList = ['A4', 'A3', 'A2', 'A1', 'A0'];\r\nconst pageOrientationList = ['Retrato', 'Paisagem'];\r\n\r\nfunction PrintGroupForm(props) {\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [activeIndex, setActiveIndex] = useState(0);\r\n\r\n  const [data, setData] = useState(props.data);\r\n\r\n  const [roles, setRoles] = useState(props?.data?.roles ? sortRolesArray([...props.data.roles]) : []);\r\n  const [availableRoles, setAvailableRoles] = useState(null);\r\n  const [selectedRoles, setSelectedRoles] = useState(null);\r\n  const [removedRoles, setRemovedRoles] = useState(null);\r\n  const [filterRolesValue, setFilterRolesValue] = useState('');\r\n\r\n  const [availableUsers, setAvailableUsers] = useState(null);\r\n  const [selectedOwner, setSelectedOwner] = useState(data?.owner ? { id: data.owner.id, username: data.owner.username, name: data.owner.name, active: data.owner.active } : null);\r\n\r\n  const [coordinateSystems, setCoordinateSystems] = useState([]);\r\n\r\n  const [printsList, setPrintsList] = useState([]);\r\n  const [groupsList, setGroupsList] = useState([]);\r\n  \r\n  const [scaleList, setScaleList] = useState(buildScaleList([1000,2000,5000,10000,20000,25000,50000], data.restrict_scales_list));\r\n\r\n  const [formFields, setFormFields] = useState(props.data?.form_fields || { fields: {}, groups:{} });\r\n  const [layouts, setLayouts] = useState(props.data?.layouts || []);\r\n  const [groupChilds, setGroupChilds] = useState({ prints: props.data?.prints || [], groups: props.data?.groups || [] });\r\n  const [geometryFilter, setGeometryFilter] = useState();\r\n\r\n  const toast = useRef(null);\r\n  const op = useRef(null);\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const adminOrManager = isAdminOrManager(props.auth);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {\r\n      id: data.id,\r\n      code: data.code,\r\n      title: data.title,\r\n      description: data.description,\r\n      //form_fields: data.form_fields,\r\n      free_scale: data.free_scale,\r\n      identification: data.identification,\r\n      identification_fields: data.identification_fields,\r\n      is_active: data.is_active,\r\n      //layouts: data.layouts,\r\n      allow_drawing: data.allow_drawing,\r\n      draw_location: data.draw_location,\r\n      location_marking: data.location_marking,\r\n      map_scale: data.map_scale,\r\n      multi_geom: data.multi_geom,\r\n      owner_id: data.owner_id,\r\n      payment_reference: data.payment_reference,\r\n      print_purpose: data.print_purpose,\r\n      restrict_scales: data.restrict_scales,\r\n      restrict_scales_list: data.restrict_scales_list,\r\n      add_title: data.add_title,\r\n      show_author: data.show_author,\r\n      select_prints: data.select_prints,\r\n      group_prints:data.group_prints,\r\n      show_all_prints: data.show_all_prints,\r\n      //tolerance_filter: data.tolerance_filter      \r\n    }\r\n  });\r\n\r\n  const restrictScales = watch(\"restrict_scales\");\r\n\r\n  useEffect(() => {\r\n    const params = {\r\n      pagination: { page: 1, perPage: 1000},\r\n      sort: { field: 'name', order: 'Asc' },\r\n      filter: {}\r\n    }\r\n    \r\n    const params_groups = {\r\n      pagination: { page: 1, perPage: 1000},\r\n      sort: { field: 'title', order: 'Asc' },\r\n      filter: {}\r\n    }    \r\n\r\n    Promise.all([\r\n      dataProvider(API_URL + '/security').getList('roles', params).catch((error) => error),\r\n      dataProvider(API_URL + '/security').getList('users', params).catch((error) => error),\r\n      dataProvider(API_URL + '/portal').getList('prints', params).catch((error) => error),\r\n      dataProvider(API_URL + '/portal').getList('prints/groups', params_groups).catch((error) => error)\r\n    ]).then((result) => {      \r\n      const roles_result = result[0];\r\n      const rids = props?.data?.roles ? props.data.roles.map(v => v.id) : [];\r\n      setAvailableRoles(sortRolesArray(roles_result.data.filter(v => !rids.includes(v.id))\r\n        .map(r => { return { id: r.id, name: r.name} })));\r\n\r\n      setAvailableUsers(result[1].data.map( u => { return { id: u.id, username: u.username, name: u.name, active: u.active}}));\r\n\r\n      if (!(props?.data?.id)) {\r\n        const owner = result[1].data.find(u => u.email === props.auth.data.username);\r\n        if (owner) {\r\n          setSelectedOwner({ id: owner.id, username: owner.username, name: owner.name, active: owner.active});\r\n        }\r\n      }\r\n\r\n      const prints_result = result[2]?.data || [];\r\n      setPrintsList(prints_result);      \r\n      const groups_result = result[3]?.data || [];\r\n      setGroupsList(groups_result);\r\n    }).catch((error) => {\r\n      console.log(error)\r\n    });\r\n    \r\n  }, []);\r\n\r\n  const addRoles = () => {\r\n    if (!availableRoles) return;\r\n    \r\n    const new_roles = availableRoles.filter(v => selectedRoles.includes(v.id));\r\n    const new_available_roles = availableRoles.filter(v => !selectedRoles.includes(v.id));\r\n\r\n    setRoles(sortRolesArray([...roles, ...new_roles]));\r\n    setAvailableRoles(sortRolesArray([...new_available_roles]));\r\n    setSelectedRoles(null);\r\n    setRemovedRoles(null);\r\n  }\r\n\r\n  const removeRoles = () => {\r\n    if (!removedRoles) return;\r\n    \r\n    const new_available_roles = roles.filter(v => removedRoles.includes(v.id));\r\n    const new_roles = roles.filter(v => !removedRoles.includes(v.id));\r\n\r\n    setRoles(sortRolesArray([...new_roles]));\r\n    setAvailableRoles(sortRolesArray([...availableRoles, ...new_available_roles]));\r\n    setRemovedRoles(null);\r\n    setSelectedRoles(null);\r\n  } \r\n\r\n  const goBack = () => {\r\n    const location = {\r\n      pathname: history.location.state.from,\r\n      state: { \r\n        searchParams: {...history.location.state.previousSearchParams}\r\n      }\r\n    }\r\n    history.replace(location);\r\n    //history.goBack();\r\n  }  \r\n\r\n  const onSubmit = (formData) => {\r\n\r\n    let new_data = {\r\n      ...formData,\r\n      form_fields: formFields ? {...formFields}  : {},\r\n      layouts: layouts ? [...layouts] : [],\r\n      prints: groupChilds?.prints ? groupChilds.prints : [],\r\n      groups: groupChilds?.groups ? groupChilds.groups : []\r\n    }\r\n\r\n    if (geometryFilter) {\r\n      new_data = {\r\n        ...new_data,\r\n        ...geometryFilter\r\n      }\r\n    }\r\n\r\n    setIsSaving(true);\r\n\r\n    const provider = dataProvider(API_URL + '/portal');      \r\n    if (data.id) {\r\n      const params = {\r\n        id: data.id,\r\n        data: {...new_data}\r\n      }\r\n      provider.update('prints/groups', params).then(d => {       \r\n        toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});\r\n        setLayouts(d?.data ? [...(d.data.layouts || [])] : []);\r\n      }).catch(e => {\r\n        toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});        \r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });\r\n    } else {\r\n      const params = {\r\n        data: {...new_data}\r\n      }\r\n      provider.create('prints/groups', params).then(d => {\r\n        setData({...data, id: d.data.id});\r\n        setLayouts(d?.data ? [...(d.data.layouts || [])] : []);\r\n        toast.current.show({life: 5000, severity: 'success', summary: 'Criar Registo', detail: 'Registo criada com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Criar Registo', detail: 'Ocorreu um erro ao criar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });       \r\n    }\r\n\r\n  };\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">O número de caracteres é superior à dimensão máxima permitida</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">Formato não permitido</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n              type=\"button\" \r\n              label=\"Voltar\" \r\n              icon=\"pi pi-left\" \r\n              className=\"p-button-secondary p-mr-4\"\r\n              disabled={isSaving ? true : false} \r\n              onClick={goBack} />\r\n            <Button\r\n              type=\"submit\" \r\n              label=\"Gravar\"\r\n              icon={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n              disabled={isSaving ? true : false} />\r\n        </React.Fragment>\r\n    )\r\n  }  \r\n \r\n  return (\r\n    <React.Fragment>      \r\n\r\n      <TabMenu model={tabItems} activeIndex={activeIndex} onTabChange={(e) => setActiveIndex(e.index)} />\r\n\r\n      <OverlayPanel ref={op} showCloseIcon dismissable>\r\n          <div className=\"p-fluid p-grid\">\r\n            <label>Adicionar escala</label>\r\n            <InputMask id=\"addScale\" \r\n              onChange={(e) => { \r\n                if (e.originalEvent.key === 'Enter' || e.originalEvent.keyCode === 13) {\r\n                    if (e.value) {\r\n                      setScaleList([...scaleList, e.value].sort((a, b)=>{return a-b}));\r\n                      op.current.hide();\r\n                    }\r\n                }\r\n              }}\r\n              mask=\"1:9?99999999\" unmask={true} autoClear={false} />\r\n          </div>\r\n      </OverlayPanel> \r\n\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n        <Toast ref={toast} baseZIndex={2000} />       \r\n\r\n        {activeIndex === 0 ?\r\n\r\n          <div className=\"card\">\r\n\r\n            <div className=\"p-fluid p-formgrid p-grid\">\r\n\r\n              <div className=\"p-field p-col-1\">\r\n                <label htmlFor=\"id\">Id</label>\r\n                <InputText id=\"id\" type=\"text\" value={data.id || ''} />\r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-2\">\r\n                <label htmlFor=\"code\">Código</label>        \r\n                <InputText id=\"code\" name=\"code\" {...register('code', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.code })} />\r\n                {getFormErrorMessage(errors, 'code')}\r\n                {/*{errors.name && <span>This field is required</span>}*/}\r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-7\">\r\n                <label htmlFor=\"name\">Título</label>        \r\n                <InputText id=\"title\" name=\"title\" {...register('title', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.title })} />\r\n                {getFormErrorMessage(errors, 'title')}       \r\n              </div>              \r\n\r\n              <div className=\"p-field p-col-12 p-md-2\">\r\n                <label>&nbsp;</label>\r\n                <Controller\r\n                  control={control}\r\n                  name=\"is_active\"\r\n                  render={({ field }) => {\r\n                    return <ToggleButton {...field} checked={field.value} onChange={(e) => field.onChange(e.target.value)} onLabel=\"Grupo Ativo\" offLabel=\"Grupo Não Ativo\" onIcon=\"pi pi-check\" offIcon=\"pi pi-times\" />\r\n                  }} \r\n                />                 \r\n              </div>\r\n\r\n\r\n\r\n              <div className=\"p-field p-col-12 p-md-12\">\r\n                <label htmlFor=\"name\">Descrição</label>        \r\n                <InputText id=\"description\" name=\"description\" {...register('description')} />   \r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-6\">\r\n                <Panel header=\"Opções de Escalas\">\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"free_scale\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"free_scale\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />                            \r\n                      <label htmlFor=\"map_scale\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Escala livre</label>\r\n                    </div>\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"map_scale\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"map_scale\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />                            \r\n                      <label htmlFor=\"map_scale\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Escala do mapa</label>\r\n                    </div>                    \r\n                  </div>\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-3\">\r\n                      <Controller name=\"restrict_scales\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"restrict_scales\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />\r\n                      <label htmlFor=\"cb1\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Escalas restritas</label>\r\n                    </div>\r\n                    {restrictScales && (\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <div className=\"p-inputgroup\"> \r\n                        <Controller name=\"restrict_scales_list\" control={control}\r\n                          render={({ field }) => {                                                  \r\n                            return <MultiSelect id=\"restrict_scales_list\"\r\n                              {...field}\r\n                              value={field.value}\r\n                              options={scaleList.map(s => {return {value: s, name: '1:' + s}})}\r\n                              onChange={(e) => field.onChange(e.value)}\r\n                              optionValue=\"value\" optionLabel=\"name\"\r\n                              selectedItemsLabel=\"{0} escalas selecionadas\" />                          \r\n                          }}\r\n                        />\r\n                        <Button type=\"button\" icon=\"pi pi-ellipsis-v\" className=\"p-button-primary\" \r\n                          onClick={(e) => op.current.toggle(e)} />\r\n                      </div>                           \r\n                    </div>\r\n                    )}                                       \r\n                  </div>\r\n                </Panel>\r\n\r\n                <Panel header=\"Opções de impressão\" className=\"p-mt-2\">\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"identification\" control={control}\r\n                        render={({ field }) => {\r\n                          return <Checkbox id=\"identification\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}\r\n                      />\r\n                      <label htmlFor=\"identification\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Identificação obrigatória</label>\r\n                    </div>                                        \r\n                  </div>\r\n                </Panel>\r\n\r\n                <Panel header=\"Marcação de local e geometrias\" className=\"p-mt-2\">\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"allow_drawing\" control={control}\r\n                        render={({ field }) => {\r\n                          return <Checkbox id=\"allow_drawing\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}\r\n                      />\r\n                      <label htmlFor=\"allow_drawing\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Permitir desenhar</label>\r\n                    </div>\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"location_marking\" control={control}\r\n                        render={({ field }) => {\r\n                          return <Checkbox id=\"location_marking\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}\r\n                      />\r\n                      <label htmlFor=\"location_marking\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Obrigatório marcar local</label>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"draw_location\" control={control}\r\n                        render={({ field }) => {\r\n                          return <Checkbox id=\"draw_location\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}\r\n                      />\r\n                      <label htmlFor=\"cb1\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Desenhar local</label>\r\n                    </div>\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"multi_geom\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"multi_geom\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />\r\n                      <label htmlFor=\"cb1\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Múltiplas geometrias</label>\r\n                    </div>\r\n                  </div>\r\n                </Panel>                 \r\n\r\n              </div>\r\n\r\n              <div className=\"p-field p-col-12 p-md-6\">\r\n                <Panel header=\"Filtro Geográfico\">\r\n                  <GeometryFilterEditor \r\n                    data={\r\n                      (\r\n                        geometryFilter ?\r\n                        {\r\n                          geometryWKT: geometryFilter.geom_filter,\r\n                          geometrySRID: geometryFilter.geom_filter_srid,\r\n                          tolerance: geometryFilter.tolerance_filter\r\n                        } :\r\n                        {\r\n                          geometryWKT: props.data?.geom_filter,\r\n                          geometrySRID: props.data?.geom_filter_srid,\r\n                          tolerance: props.data?.tolerance_filter\r\n                        }\r\n                      )                            \r\n                    }\r\n                    coordinateSystems={props.coordinateSystems} \r\n                    onSave={ data => {\r\n                      const filter = {\r\n                        geom_filter: data.geometryWKT,\r\n                        geom_filter_srid: data.geometrySRID,\r\n                        tolerance_filter: data.tolerance\r\n                      }\r\n                      setGeometryFilter(filter);\r\n                    }}\r\n                  />\r\n                </Panel>\r\n\r\n                <Panel header=\"Opções de Grupo\" className=\"p-mt-2\">\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"select_prints\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"select_prints\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />                            \r\n                      <label htmlFor=\"select_prints\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Permitir selecionar plantas</label>\r\n                    </div>\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"group_prints\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"group_prints\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />\r\n                      <label htmlFor=\"group_prints\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Agrupar plantas</label>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col p-field p-mt-2\">\r\n                      <Controller name=\"show_all_prints\" control={control}\r\n                        render={({ field }) => {                      \r\n                          return <Checkbox id=\"show_all_prints\" {...field} onChange={(e) => field.onChange(!e.value)} checked={field.value} className=\"p-mr-2\" style={{float: \"left\"}} />\r\n                        }}                    \r\n                      />                            \r\n                      <label htmlFor=\"show_all_prints\" className=\"p-checkbox-label\" style={{display: \"inline\"}}>Mostar filhos vazios</label>\r\n                    </div>\r\n                  </div>                  \r\n                </Panel>\r\n              </div>              \r\n\r\n            </div>  \r\n\r\n          </div>     \r\n\r\n        : null}\r\n\r\n        {activeIndex === 1 ?\r\n\r\n          <div className=\"card\">\r\n\r\n            <FormFieldsEditor data={formFields} onChange={(data) => {\r\n              setFormFields(data);\r\n            }} />\r\n\r\n          </div>\r\n\r\n        : null}          \r\n          \r\n        {activeIndex === 2 ?\r\n\r\n          <div className=\"card\">\r\n\r\n            <div className=\"p-fluid p-formgrid p-grid\">\r\n              <PrintLayoutsEditor data={layouts}\r\n                pageFormatList={pageFormatList} pageOrientationList={pageOrientationList}\r\n                onChange={(data) => {\r\n                  setLayouts(data);\r\n                }}\r\n              />\r\n            </div>\r\n\r\n          </div>\r\n\r\n        : null}\r\n\r\n        {activeIndex === 3 ?\r\n\r\n          <div className=\"card\">\r\n\r\n            <PrintGroupChildsEditor \r\n              data={groupChilds} \r\n              printsList={printsList}\r\n              groupsList={data.id ? groupsList.filter(g=>g.id !== data.id) : groupsList}\r\n              onChange={(data) => {\r\n                setGroupChilds(data);\r\n              }} \r\n            />\r\n\r\n          </div>\r\n\r\n        : null}        \r\n\r\n\r\n        <Toolbar className=\"p-mt-4 p-mb-4\" right={rightToolbarTemplate}></Toolbar>        \r\n\r\n      </form>\r\n\r\n\r\n    </React.Fragment>\r\n\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ auth: state.auth }))(withRouter(PrintGroupForm));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect, useDispatch } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { Chips} from 'primereact/chips';\r\nimport { Button } from 'primereact/button';\r\nimport { classNames } from 'primereact/utils';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport PrintGroupForm from './PrintGroupForm';\r\n\r\n\r\nfunction PrintGroupEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const {\r\n    history,\r\n    dispatch,\r\n    backoffice\r\n  } = props;\r\n\r\n  const { id } = useParams();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [record, setRecord] = useState(null);\r\n  const [roles, setRoles] = useState([]);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/portal');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setLoading(true);  \r\n\r\n    provider.getOne('prints/groups', params).then(d => {\r\n      //Change restrict_scales_list from string to array\r\n      const tmp_data = d.data;\r\n      if (tmp_data.restrict_scales_list && ((typeof tmp_data.restrict_scales_list === 'string' || tmp_data.restrict_scales_list instanceof String))) {\r\n        tmp_data.restrict_scales_list = tmp_data.restrict_scales_list.split(',').map(s => parseInt(s));\r\n      }\r\n      setRecord(tmp_data);\r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      //toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n    { record ?\r\n      <PrintGroupForm data={record} coordinateSystems={ props?.backoffice?.config_json ? props.backoffice.config_json.coordinate_systems || [] : []} />\r\n      :\r\n      <div>loading...</div>\r\n    }\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, backoffice: state.backoffice }))(withRouter(PrintGroupEdit));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { Chip } from 'primereact/chip';\r\nimport { confirmDialog } from 'primereact/confirmdialog';\r\nimport { Toast } from 'primereact/toast';\r\n\r\nimport AppContext from '../../../AppContext'\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\n\r\nconst initialSearchParams = {\r\n  filters: {},\r\n  first: 0,\r\n  rows: 20,\r\n  page: 0,\r\n  sortField: 'id',\r\n  sortOrder: 1\r\n}\r\n\r\n\r\nfunction PrintGroupList(props) {\r\n\r\n  const {\r\n    history,\r\n    groupsFilter\r\n  } = props;\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(false);  \r\n  const [records, setRecords] = useState([]);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n\r\n  const [searchParams, setSearchParams] = useState({...initialSearchParams});\r\n\r\n  const loaded = useRef(false);\r\n  const dt = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (!loaded.current) return;\r\n\r\n    loaded.current = true;\r\n    if (groupsFilter) {\r\n      setSearchParams(...groupsFilter);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, [searchParams]);\r\n\r\n    \r\n  const newRecord = () => {\r\n    const location = {\r\n      pathname: '/prints/groups/create',\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);   \r\n  }\r\n\r\n  const editRecord = (record) => {\r\n    const location = {\r\n      pathname: `/prints/groups/edit/${record.id}`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);    \r\n  }  \r\n\r\n  const deleteSelectedRecords = () => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o(s) registo(s) selecionado(s)?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal');\r\n        const params = {\r\n          ids: selectedRecords.map(v => v.id)\r\n        }\r\n        provider.deleteMany('prints/groups', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo(s)', detail: 'Registo(s) eliminado(s) com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo(s)', detail: 'Ocorreu um erro ao eliminar o(s) registo(s)'}); \r\n        }).finally(() => {\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }\r\n\r\n  const deleteRecord = (record) => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o registo selecionado?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal');\r\n        const params = {\r\n          id: record.id\r\n        }      \r\n        provider.delete('prints/groups', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo', detail: 'Registo eliminado com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo', detail: 'Ocorreu um erro ao eliminar o registo'}); \r\n        }).finally(() => {\r\n          //console.log('finally');\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }  \r\n\r\n  const exportCSV = () => {\r\n    //TODO: implement export\r\n    //dt.current.exportCSV();\r\n  }\r\n\r\n  const loadData = (filters) => {\r\n    const provider = dataProvider(API_URL + '/portal');\r\n  \r\n    const _filter = {};\r\n    if (filters) {\r\n      Object.entries(filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    } else if (searchParams.filters) {\r\n      Object.entries(searchParams.filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    }\r\n\r\n    const params = {\r\n      pagination: { page: searchParams.page + 1, perPage: searchParams.rows},\r\n      sort: { field: searchParams.sortField, order: searchParams.sortOrder == -1 ? 'Desc' : 'Asc' },\r\n      filter: _filter\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    provider.getList('prints/groups', params).then(d => {\r\n      setSelectedRecords(null);\r\n      setRecords({ ...d, page: searchParams.page });\r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Grupos de Plantas', detail: 'Ocorreu um erro na pesquisa'});\r\n    });\r\n  }\r\n\r\n  const onPage = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onSort = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onFilter = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    _searchParams['first'] = 0;\r\n    setSearchParams(_searchParams);    \r\n  }\r\n\r\n  const onFilterClear = (event) => {\r\n    setSearchParams({ ...initialSearchParams});    \r\n  }\r\n\r\n  const groupsTemplate = (rowData) => {\r\n    return (\r\n        <React.Fragment>\r\n          { rowData.groups && rowData.groups.map( (item) => <Chip key={item.id} label={item.code} className=\"p-mr-2 p-mb-2\" /> ) }\r\n        </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const printsTemplate = (rowData) => {\r\n    return (\r\n        <React.Fragment>\r\n          { rowData.groups && rowData.prints.map( (item) => <Chip key={item.id} label={item.code} className=\"p-mr-2 p-mb-2\" /> ) }\r\n        </React.Fragment>\r\n    );\r\n  }  \r\n\r\n  const viewersTemplate = (rowData) => {\r\n    return (\r\n        <React.Fragment>\r\n          { rowData.viewers && rowData.viewers.map( (item) => <Chip key={item.id} label={item.name} className=\"p-mr-2 p-mb-2\" /> ) }\r\n        </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const leftToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Novo\" icon=\"pi pi-plus\" className=\"p-button-success p-mr-2\" onClick={newRecord} />\r\n            <Button label=\"Eliminar\" icon=\"pi pi-trash\" className=\"p-button-danger\" onClick={deleteSelectedRecords} disabled={!selectedRecords || !selectedRecords.length} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n      return (\r\n          <React.Fragment>              \r\n              <Button label=\"Limpar\" icon=\"pi pi-times\" className=\"p-button-help p-mr-2\" onClick={onFilterClear} />\r\n              {/*<Button label=\"Export\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} />*/}\r\n          </React.Fragment>\r\n      )\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success p-mr-2\" onClick={() => editRecord(rowData)} />\r\n            <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => deleteRecord(rowData)} />\r\n        </React.Fragment>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"p-col-12\"><h3>Emissão de Plantas - Grupos</h3></div>\r\n\r\n      <div className=\"p-grid p-fluid print-list\">\r\n        <Toast ref={toast} baseZIndex={2000} />\r\n        <div className=\"card\">\r\n          <Toolbar className=\"p-mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n          <DataTable ref={dt} value={records ? records.data : []} lazy\r\n              selectionMode=\"checkbox\"\r\n              selection={selectedRecords} onSelectionChange={(e) => setSelectedRecords(e.value)}\r\n              paginator first={searchParams.first} rows={searchParams.rows} totalRecords={records.total} onPage={onPage}\r\n              onSort={onSort} sortField={searchParams.sortField} sortOrder={searchParams.sortOrder}\r\n              filters={searchParams.filters} onFilter={onFilter} loading={loading}\r\n              emptyMessage=\"Não foram encontrados registos.\" >\r\n              <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n              <Column field=\"id\" header=\"Id\" sortable filter filterPlaceholder=\"Id\" headerStyle={{ width: '6rem' }} />\r\n              <Column field=\"code\" header=\"Código\" sortable filter filterPlaceholder=\"Código\" style={{\"wordBreak\": \"break-all\"}} />\r\n              <Column field=\"title\" header=\"Título\" sortable filter filterPlaceholder=\"Título\" style={{\"wordBreak\": \"break-all\"}} /> \r\n              <Column field=\"groups\" header=\"Grupos\" body={groupsTemplate} />\r\n              <Column field=\"prints\" header=\"Plantas\" body={printsTemplate} />\r\n              <Column field=\"viewers\" header=\"Visualizadores\" body={viewersTemplate} />\r\n              <Column body={actionBodyTemplate} />\r\n          </DataTable>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, filters: state.filters }))(withRouter(PrintGroupList));","import React, { useContext, useState, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { classNames } from 'primereact/utils';\r\n\r\nimport AceEditor from \"react-ace\";\r\nimport \"ace-builds/src-noconflict/mode-json\";\r\nimport \"ace-builds/src-noconflict/theme-github\";\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nfunction PrintElementForm(props) {\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [data, setData] = useState(props.data || {});\r\n\r\n  const toast = useRef(null);\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {...data}\r\n  });\r\n\r\n  const goBack = () => {\r\n    const location = {\r\n      pathname: history.location.state.from,\r\n      state: { \r\n        searchParams: {...history.location.state.previousSearchParams}\r\n      }\r\n    }\r\n    history.replace(location);\r\n    //history.goBack();\r\n  }\r\n\r\n  const onSubmit = (formData) => {\r\n    const new_data = {\r\n      code: formData.code,\r\n      name: formData.name,\r\n      config: formData.config\r\n    }\r\n\r\n    setIsSaving(true);\r\n\r\n    const provider = dataProvider(API_URL + '/portal');      \r\n    if (data.id) {\r\n      const params = {\r\n        id: data.id,\r\n        data: {...new_data}\r\n      }\r\n      provider.update('prints/elements', params).then(d => {       \r\n        toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });\r\n    } else {\r\n      const params = {\r\n        data: {...new_data}\r\n      }\r\n      provider.create('prints/elements', params).then(d => {\r\n        setData({...data, id: d.data.id});\r\n        toast.current.show({life: 5000, severity: 'success', summary: 'Criar Registo', detail: 'Registo criada com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Criar Registo', detail: 'Ocorreu um erro ao criar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });       \r\n    }\r\n  };\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      if (errors[name].type === 'required') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Campo obrigatório'}</small>\r\n      } else if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">{errors[name].message || 'O número de caracteres é superior à dimensão máxima permitida'}</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Formato inválido'}</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n \r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n              type=\"button\" \r\n              label=\"Voltar\" \r\n              icon=\"pi pi-left\" \r\n              className=\"p-button-secondary p-mr-4\"\r\n              disabled={isSaving ? true : false} \r\n              onClick={goBack} />\r\n            <Button\r\n              type=\"submit\" \r\n              label=\"Gravar\"\r\n              icon={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n              disabled={isSaving ? true : false} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  return (\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n\r\n          <div className=\"p-fluid p-formgrid p-grid\">      \r\n            <div className=\"p-field p-col-12 p-md-2\">\r\n              <label htmlFor=\"id\">Id</label>\r\n              <InputText id=\"id\" type=\"text\" value={data.id || ''} disabled />\r\n            </div>              \r\n\r\n            <div className=\"p-field p-col-12 p-md-6\">\r\n              <label htmlFor=\"code\">Código</label>\r\n              <InputText id=\"code\" name=\"code\" {...register('code', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.code })} />\r\n              {getFormErrorMessage(errors, 'code')}\r\n            </div>           \r\n\r\n            <div className=\"p-field p-col-12 p-md-11\">\r\n              <label htmlFor=\"name\">Designação</label>        \r\n              <InputText id=\"name\" name=\"name\" {...register('name', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.name })} />\r\n              {getFormErrorMessage(errors, 'name')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12\">\r\n              <label htmlFor=\"config\">Configuração</label>        \r\n              <div id=\"editor-parent\">\r\n                <Controller\r\n                  control={control}\r\n                  name=\"config\"\r\n                  rules={{ required: 'Campo obrigatório.' }}\r\n                  render={({ field }) => {\r\n                    return <AceEditor\r\n                      mode=\"json\"\r\n                      theme=\"github\"\r\n                      onLoad={editorInstance => {                \r\n                        editorInstance.container.style.setProperty('width', (document.getElementById('editor-parent').offsetWidth - 50) + 'px');               \r\n                      }}\r\n                      {...field}\r\n                      onChange={(newValue) => {\r\n                        field.onChange(newValue);\r\n                      }}\r\n                      value={field.value}\r\n                      name=\"config\"         \r\n                      editorProps={{ $blockScrolling: true }}\r\n                      setOptions={{\r\n                        tabSize: 2\r\n                      }}                                 \r\n                    />\r\n                  }}\r\n                />\r\n                {getFormErrorMessage(errors, 'config')}\r\n              </div>            \r\n            </div>\r\n          </div>\r\n\r\n        <Toolbar className=\"p-mt-4 p-mb-4\" right={rightToolbarTemplate}></Toolbar>\r\n\r\n      </form>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(PrintElementForm));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport PrintElementForm from './PrintElementForm';\r\n\r\n\r\nfunction PrintElementEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const { id } = useParams();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [record, setRecord] = useState(null);\r\n  const [roles, setRoles] = useState([]);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/portal');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setLoading(true);  \r\n\r\n    provider.getOne('prints/elements', params).then(d => {\r\n      //Change restrict_scales_list from string to array\r\n      const tmp_data = d.data;\r\n      if (tmp_data.restrict_scales_list && ((typeof tmp_data.restrict_scales_list === 'string' || tmp_data.restrict_scales_list instanceof String))) {\r\n        tmp_data.restrict_scales_list = tmp_data.restrict_scales_list.split(',').map(s => parseInt(s));\r\n      }\r\n      setRecord(tmp_data);\r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      //toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n    { record ?\r\n      <PrintElementForm data={record} />\r\n      :\r\n      <div>loading...</div>\r\n    }\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading }))(withRouter(PrintElementEdit));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { confirmDialog } from 'primereact/confirmdialog';\r\nimport { Toast } from 'primereact/toast';\r\n\r\nimport AppContext from '../../../AppContext'\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\n\r\nconst initialSearchParams = {\r\n  filters: {},\r\n  first: 0,\r\n  rows: 20,\r\n  page: 0,\r\n  sortField: 'id',\r\n  sortOrder: 1\r\n}\r\n\r\nfunction PrintElementList(props) {\r\n\r\n  const {\r\n    history,\r\n    elementsFilter\r\n  } = props;\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(false);  \r\n  const [records, setRecords] = useState([]);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n\r\n  const [searchParams, setSearchParams] = useState({...initialSearchParams});\r\n\r\n  const loaded = useRef(false);\r\n  const dt = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (!loaded.current) return;\r\n\r\n    loaded.current = true;\r\n    if (elementsFilter) {\r\n      setSearchParams(...elementsFilter);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, [searchParams]);\r\n\r\n  \r\n  const newRecord = () => {\r\n    const location = {\r\n      pathname: '/prints/elements/create',\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);   \r\n  }\r\n\r\n  const editRecord = (record) => {\r\n    const location = {\r\n      pathname: `/prints/elements/edit/${record.id}`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);    \r\n  }  \r\n\r\n  const deleteSelectedRecords = () => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o(s) registo(s) selecionado(s)?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal');\r\n        const params = {\r\n          ids: selectedRecords.map(v => v.id)\r\n        }\r\n        provider.deleteMany('prints/elements', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo(s)', detail: 'Registo(s) eliminado(s) com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo(s)', detail: 'Ocorreu um erro ao eliminar o(s) registo(s)'}); \r\n        }).finally(() => {\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }\r\n\r\n  const deleteRecord = (record) => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o registo selecionado?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal');\r\n        const params = {\r\n          id: record.id\r\n        }      \r\n        provider.delete('prints/elements', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo', detail: 'Registo eliminado com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo', detail: 'Ocorreu um erro ao eliminar o registo'}); \r\n        }).finally(() => {\r\n          //console.log('finally');\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }  \r\n\r\n  const exportCSV = () => {\r\n    //TODO: implement export\r\n    //dt.current.exportCSV();\r\n  }\r\n\r\n  const loadData = (filters) => {\r\n    const provider = dataProvider(API_URL + '/portal');\r\n  \r\n    const _filter = {};\r\n    if (filters) {\r\n      Object.entries(filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    } else if (searchParams.filters) {\r\n      Object.entries(searchParams.filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    }\r\n\r\n    const params = {\r\n      pagination: { page: searchParams.page + 1, perPage: searchParams.rows},\r\n      sort: { field: searchParams.sortField, order: searchParams.sortOrder == -1 ? 'Desc' : 'Asc' },\r\n      filter: _filter\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    provider.getList('prints/elements', params).then(d => {\r\n      setSelectedRecords(null);\r\n      setRecords({ ...d, page: searchParams.page });\r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Elementos de Impressão', detail: 'Ocorreu um erro na pesquisa'});\r\n    });\r\n  }\r\n\r\n  const onPage = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onSort = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onFilter = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    _searchParams['first'] = 0;\r\n    setSearchParams(_searchParams);    \r\n  }\r\n\r\n  const onFilterClear = (event) => {\r\n    setSearchParams({ ...initialSearchParams});    \r\n  }\r\n\r\n  const leftToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Novo\" icon=\"pi pi-plus\" className=\"p-button-success p-mr-2\" onClick={newRecord} />\r\n            <Button label=\"Eliminar\" icon=\"pi pi-trash\" className=\"p-button-danger\" onClick={deleteSelectedRecords} disabled={!selectedRecords || !selectedRecords.length} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n      return (\r\n          <React.Fragment>              \r\n              <Button label=\"Limpar\" icon=\"pi pi-times\" className=\"p-button-help p-mr-2\" onClick={onFilterClear} />\r\n              {/*<Button label=\"Export\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} />*/}\r\n          </React.Fragment>\r\n      )\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    return (\r\n        <div style={{textAlign: \"right\"}}>\r\n            <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success p-mr-2\" onClick={() => editRecord(rowData)} />\r\n            <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => deleteRecord(rowData)} />\r\n        </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"p-col-12\"><h3>Emissão de Plantas - Elementos</h3></div>\r\n\r\n      <div className=\"p-grid p-fluid print-list\">\r\n        <Toast ref={toast} baseZIndex={2000} />\r\n        <div className=\"card\">\r\n          <Toolbar className=\"p-mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n          <DataTable ref={dt} value={records ? records.data : []} lazy\r\n              selectionMode=\"checkbox\"\r\n              selection={selectedRecords} onSelectionChange={(e) => setSelectedRecords(e.value)}\r\n              paginator first={searchParams.first} rows={searchParams.rows} totalRecords={records.total} onPage={onPage}\r\n              onSort={onSort} sortField={searchParams.sortField} sortOrder={searchParams.sortOrder}\r\n              filters={searchParams.filters} onFilter={onFilter} loading={loading}\r\n              emptyMessage=\"Não foram encontrados registos.\" >\r\n              <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n              <Column field=\"id\" header=\"Id\" sortable filter filterPlaceholder=\"Id\" headerStyle={{ width: '6rem' }} />\r\n              <Column field=\"code\" header=\"Código\" sortable filter filterPlaceholder=\"Código\" style={{\"wordBreak\": \"break-all\"}} />\r\n              <Column field=\"name\" header=\"Nome\" sortable filter filterPlaceholder=\"Nome\" style={{\"wordBreak\": \"break-all\"}} />\r\n              <Column body={actionBodyTemplate} />\r\n          </DataTable>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, filters: state.filters }))(withRouter(PrintElementList));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { Dropdown } from 'primereact/dropdown';\r\nimport { confirmDialog } from 'primereact/confirmdialog';\r\nimport { Toast } from 'primereact/toast';\r\n\r\nimport AppContext from '../../../AppContext'\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nconst initialSearchParams = {\r\n  filters: { \r\n    \"active\": { \"value\": true}\r\n  },\r\n  first: 0,\r\n  rows: 20,\r\n  page: 0,\r\n  sortField: 'id',\r\n  sortOrder: 1\r\n}\r\n\r\nfunction UserList(props) {\r\n\r\n  const {\r\n    history    \r\n  } = props;\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(false);  \r\n  const [records, setRecords] = useState([]);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n  const [selectedStatus, setSelectedStatus] = useState(true);\r\n\r\n  const [searchParams, setSearchParams] = useState({...initialSearchParams});  \r\n\r\n  const loaded = useRef(false);\r\n  const dt = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (!loaded.current && history.location?.state?.searchParams) {\r\n      loaded.current = true;\r\n\r\n      const _searchParams = {...history.location.state.searchParams};\r\n      setSearchParams(_searchParams);\r\n    } else {\r\n      loadData();\r\n    }\r\n  }, [searchParams]);\r\n\r\n  const newRecord = () => {\r\n    const location = {\r\n      pathname: '/security/users/create',\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);   \r\n  }\r\n\r\n  const editRecord = (record) => {\r\n    const location = {\r\n      pathname: `/security/users/edit/${record.id}`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);\r\n  }\r\n\r\n  const deleteSelectedRecords = () => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o(s) registo(s) selecionado(s)?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/security');\r\n        const params = {\r\n          ids: selectedRecords.filter(v => !v.read_only).map(v => v.id)\r\n        }\r\n        provider.deleteMany('users', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo(s)', detail: 'Registo(s) eliminado(s) com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo(s)', detail: 'Ocorreu um erro ao eliminar o(s) registo(s)'}); \r\n        }).finally(() => {\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }\r\n  \r\n  const deleteRecord = (record) => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o registo selecionado?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/security');\r\n        const params = {\r\n          id: record.id\r\n        }      \r\n        provider.delete('users', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo', detail: 'Registo eliminado com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo', detail: 'Ocorreu um erro ao eliminar o registo'}); \r\n        }).finally(() => {\r\n          //console.log('finally');\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }  \r\n\r\n  const exportCSV = () => {\r\n    //TODO: implement export\r\n    //dt.current.exportCSV();\r\n  }\r\n\r\n  const loadData = (filters) => {\r\n    const provider = dataProvider(API_URL + '/security');\r\n\r\n    const _filter = {};\r\n    if (filters) {\r\n      Object.entries(filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    } else if (searchParams.filters) {\r\n      Object.entries(searchParams.filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    }\r\n\r\n    const params = {\r\n      pagination: { page: searchParams.page + 1, perPage: searchParams.rows},\r\n      sort: { field: searchParams.sortField, order: searchParams.sortOrder === -1 ? 'Desc' : 'Asc' },\r\n      filter: _filter\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    provider.getList('users', params).then(d => {\r\n      setSelectedRecords(null);\r\n      setRecords({ ...d, page: searchParams.page });\r\n    }).catch(e => {\r\n      toast.current.show({life: 3000, severity: 'error', summary: 'Pesquisa de Utilizadores', detail: 'Ocorreu um erro ao realizar a pesquisa'});\r\n    }).finally(() => {\r\n      setLoading(false);\r\n    });\r\n  }\r\n\r\n  const onPage = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onSort = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onFilter = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    _searchParams['first'] = 0;\r\n    setSearchParams(_searchParams);    \r\n  }\r\n\r\n  const onFilterClear = (event) => {\r\n    setSearchParams({ ...initialSearchParams});\r\n    setSelectedStatus(true);\r\n  }    \r\n\r\n  const onSelectionChange = (event) => {\r\n    setSelectedRecords(event.value.filter(v => !v.read_only));\r\n  }\r\n\r\n  const onStatusChange = (e) => {\r\n    dt.current.filter(e.value, 'active', 'equals');\r\n    setSelectedStatus(e.value);\r\n  }  \r\n\r\n  const statusBodyTemplate = (rowData) => {\r\n    if (rowData.active) {\r\n      return <i className=\"pi pi-check\" style={{fontWeight: 'bold', color: '#28a745'}}></i> \r\n    } else {\r\n      return <i className=\"pi pi-times\" style={{fontWeight: 'bold', color: '#D32F2F'}}></i>\r\n    }\r\n  }\r\n\r\n  const leftToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Novo\" icon=\"pi pi-plus\" className=\"p-button-success p-mr-2\" onClick={newRecord} />\r\n            <Button label=\"Eliminar\" icon=\"pi pi-trash\" className=\"p-button-danger\" onClick={deleteSelectedRecords} disabled={!selectedRecords || !selectedRecords.length} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Limpar\" icon=\"pi pi-times\" className=\"p-button-help p-mr-2\" onClick={onFilterClear} />\r\n            {/*<Button label=\"Export\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} />*/}\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    if (rowData.read_only) {\r\n      return (<Button icon=\"fas fa-lock\" className=\"p-button-rounded p-button-secondary\" disabled />);\r\n    } else {\r\n      return (\r\n          <React.Fragment>\r\n              <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success p-mr-2\" onClick={() => editRecord(rowData)} />\r\n              <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => deleteRecord(rowData)} />\r\n          </React.Fragment>\r\n      );\r\n    }\r\n  }\r\n\r\n  const statusFilter = <Dropdown value={selectedStatus} options={[{label: 'Sim', value: true}, {label: 'Não', value: false}]} onChange={onStatusChange} placeholder=\"\" className=\"p-column-filter\" showClear />;\r\n\r\n  return (\r\n      <React.Fragment>\r\n        <div className=\"p-col-12\"><h3>Utilizadores</h3></div>\r\n\r\n        <div className=\"p-grid p-fluid viewer-list\">\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n          <div className=\"card\">\r\n            <Toolbar className=\"p-mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n            <DataTable ref={dt} value={records ? records.data : []} lazy\r\n                selectionMode=\"checkbox\"\r\n                selection={selectedRecords} onSelectionChange={onSelectionChange}\r\n                paginator first={searchParams.first} rows={searchParams.rows} totalRecords={records.total} onPage={onPage}\r\n                onSort={onSort} sortField={searchParams.sortField} sortOrder={searchParams.sortOrder}\r\n                filters={searchParams.filters} onFilter={onFilter} loading={loading}\r\n                emptyMessage=\"Não foram encontrados registos.\" >\r\n                <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n                <Column field=\"id\" header=\"Id\" sortable filter filterPlaceholder=\"Id\" headerStyle={{ width: '6rem' }} />\r\n                <Column field=\"username\" header=\"Username\" sortable filter filterPlaceholder=\"Username\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column field=\"email\" header=\"Email\" sortable filter filterPlaceholder=\"Email\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column field=\"name\" header=\"Nome\" sortable filter filterPlaceholder=\"Nome\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column field=\"active\" header=\"Ativo\" body={statusBodyTemplate} sortable filter filterElement={statusFilter} className=\"p-text-center\" headerStyle={{ width: '9rem' }} />\r\n                <Column body={actionBodyTemplate} style={{\"textAlign\": \"center\"}} />\r\n            </DataTable>\r\n          </div>\r\n        </div>\r\n      </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, auth: state.auth, filters: state.filters }))(withRouter(UserList));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { Password } from 'primereact/password';\r\nimport { ToggleButton } from 'primereact/togglebutton';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { Calendar } from 'primereact/calendar';\r\nimport { MultiSelect } from 'primereact/multiselect';\r\nimport { ListBox } from 'primereact/listbox';\r\nimport { Message } from 'primereact/message';\r\nimport { classNames } from 'primereact/utils';\r\nimport { v4 as uuidV4 } from 'uuid'\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nconst sortRolesArray = (data) => {\r\n  if (!data) return data;\r\n\r\n  return data.sort(function(a, b) {\r\n    if (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\r\n    if (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nconst sortGroupsArray = (data) => {\r\n  if (!data) return data;\r\n\r\n  return data.sort(function(a, b) {\r\n    if (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\r\n    if (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nfunction UserForm(props) {\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [data, setData] = useState(props.data || {});\r\n\r\n  const [roles, setRoles] = useState(props?.data?.roles ? sortRolesArray([...props.data.roles]) : []);\r\n  const [availableRoles, setAvailableRoles] = useState(null);\r\n  const [selectedRoles, setSelectedRoles] = useState(null);\r\n  const [removedRoles, setRemovedRoles] = useState(null);\r\n  const [filterRolesValue, setFilterRolesValue] = useState('');\r\n\r\n  const [groups, setGroups] = useState(props?.data?.groups ? sortGroupsArray([...props.data.groups]) : []);\r\n  const [availableGroups, setAvailableGroups] = useState(null);\r\n  const [selectedGroups, setSelectedGroups] = useState(null);\r\n  const [removedGroups, setRemovedGroups] = useState(null);\r\n  const [filterGroupsValue, setFilterGroupsValue] = useState('');\r\n\r\n  const toast = useRef(null);\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {...data}\r\n  });\r\n\r\n  useEffect(() => {\r\n    const params = {\r\n      pagination: { page: 1, perPage: 1000},\r\n      sort: { field: 'name', order: 'Asc' },\r\n      filter: {}\r\n    }  \r\n\r\n    Promise.all([\r\n      dataProvider(API_URL + '/security').getList('roles', params).catch((error) => error),\r\n      dataProvider(API_URL + '/security').getList('groups', params).catch((error) => error)\r\n    ]).then((result) => {      \r\n      const roles_result = result[0];\r\n      const rids = props?.data?.roles ? props.data.roles.map(v => v.id) : [];\r\n      setAvailableRoles(sortRolesArray(roles_result.data.filter(v => !rids.includes(v.id))\r\n        .map(r => { return { id: r.id, name: r.name} })));\r\n\r\n      const groups_result = result[1];\r\n      const gids = props?.data?.groups ? props.data.groups.map(v => v.id) : [];\r\n      setAvailableGroups(sortGroupsArray(groups_result.data.filter(v => !gids.includes(v.id))\r\n        .map(g => { return { id: g.id, name: g.name} })));\r\n\r\n    }).catch((error) => {\r\n      console.log(error)\r\n    });    \r\n  }, []);\r\n\r\n  const addRoles = () => {\r\n    if (!availableRoles) return;\r\n    \r\n    const new_roles = availableRoles.filter(v => selectedRoles.includes(v.id));\r\n    const new_available_roles = availableRoles.filter(v => !selectedRoles.includes(v.id));\r\n\r\n    setRoles(sortRolesArray([...roles, ...new_roles]));\r\n    setAvailableRoles(sortRolesArray([...new_available_roles]));\r\n    setSelectedRoles(null);\r\n    setRemovedRoles(null);\r\n  }\r\n\r\n  const removeRoles = () => {\r\n    if (!removedRoles) return;\r\n    \r\n    const new_available_roles = roles.filter(v => removedRoles.includes(v.id));\r\n    const new_roles = roles.filter(v => !removedRoles.includes(v.id));\r\n\r\n    setRoles(sortRolesArray([...new_roles]));\r\n    setAvailableRoles(sortRolesArray([...availableRoles, ...new_available_roles]));\r\n    setRemovedRoles(null);\r\n    setSelectedRoles(null);\r\n  }\r\n\r\n  const addGroups = () => {\r\n    if (!availableGroups) return;\r\n    \r\n    const new_groups = availableGroups.filter(v => selectedGroups.includes(v.id));\r\n    const new_available_groups = availableGroups.filter(v => !selectedGroups.includes(v.id));\r\n\r\n    setGroups(sortGroupsArray([...groups, ...new_groups]));\r\n    setAvailableGroups(sortGroupsArray([...new_available_groups]));\r\n    setSelectedGroups(null);\r\n    setRemovedGroups(null);\r\n  }\r\n\r\n  const removeGroups = () => {\r\n    if (!removedGroups) return;\r\n    \r\n    const new_available_groups = groups.filter(v => removedGroups.includes(v.id));\r\n    const new_groups = groups.filter(v => !removedGroups.includes(v.id));\r\n\r\n    setGroups(sortGroupsArray([...new_groups]));\r\n    setAvailableGroups(sortGroupsArray([...availableGroups, ...new_available_groups]));\r\n    setRemovedGroups(null);\r\n    setSelectedGroups(null);\r\n  }\r\n\r\n  const goBack = () => {\r\n    const location = {\r\n      pathname: history.location.state.from,\r\n      state: { \r\n        searchParams: {...history.location.state.previousSearchParams}\r\n      }\r\n    }\r\n    history.replace(location);\r\n    //history.goBack();\r\n  }\r\n\r\n  const onSubmit = (formData) => {\r\n    const new_data = {\r\n      first_name: formData.first_name,\r\n      last_name: formData.last_name,\r\n      name: formData.name,\r\n      username: formData.username,\r\n      email: formData.email,\r\n      password: formData.password || null,\r\n      active: formData.active || false,\r\n      auth_token: formData.auth_token || null,\r\n      auth_token_expire: formData.auth_token_expire || null,\r\n      roles: roles ? roles.map(r => r.id) : [],\r\n      groups: groups ? groups.map(g => g.id) : []\r\n    }\r\n\r\n    setIsSaving(true);\r\n\r\n    const provider = dataProvider(API_URL + '/security');      \r\n    if (data.id) {\r\n      const params = {\r\n        id: data.id,\r\n        data: {...new_data}\r\n      }\r\n      provider.update('users', params).then(d => {       \r\n        toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});\r\n        setValue('password', '', {\r\n          shouldValidate: true,\r\n          shouldDirty: true\r\n        });\r\n      }).catch(e => {\r\n        toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});        \r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });\r\n    } else {\r\n      const params = {\r\n        data: {...new_data}\r\n      }\r\n      provider.create('users', params).then(d => {\r\n        setData({...data, id: d.data.id});\r\n        toast.current.show({life: 5000, severity: 'success', summary: 'Criar Registo', detail: 'Registo criada com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Criar Registo', detail: 'Ocorreu um erro ao criar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });       \r\n    }\r\n  };\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      if (errors[name].type === 'required') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Campo obrigatório'}</small>\r\n      } else if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">{errors[name].message || 'O número de caracteres é superior à dimensão máxima permitida'}</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Formato inválido'}</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n \r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n              type=\"button\" \r\n              label=\"Voltar\" \r\n              icon=\"pi pi-left\" \r\n              className=\"p-button-secondary p-mr-4\"\r\n              disabled={isSaving ? true : false} \r\n              onClick={goBack} />\r\n            <Button\r\n              type=\"submit\" \r\n              label=\"Gravar\"\r\n              icon={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n              disabled={isSaving ? true : false} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n      <Toast ref={toast} baseZIndex={2000} />\r\n\r\n      <div className=\"p-fluid p-formgrid p-grid\">\r\n        <div className=\"p-field p-col-12 p-md-3\">\r\n          <label htmlFor=\"first_name\">Primeiro Nome</label>\r\n          <InputText id=\"first_name\" name=\"first_name\" {...register('first_name')} autoFocus />\r\n        </div>            \r\n        <div className=\"p-field p-col-12 p-md-3\">\r\n          <label htmlFor=\"last_name\">Último Nome</label>\r\n          <InputText id=\"last_name\" name=\"last_name\" {...register('last_name')} />\r\n        </div>\r\n        <div className=\"p-field p-col-12 p-md-6\">\r\n          <label htmlFor=\"name\">Nome</label>\r\n          <InputText id=\"name\" name=\"name\" {...register('name', { required: 'Campo obrigatório.' })} className={classNames({ 'p-invalid': errors.name })} />\r\n          {getFormErrorMessage(errors, 'name')}\r\n        </div>\r\n\r\n        <div className=\"p-field p-col-12 p-md-3\">\r\n          <label htmlFor=\"username\">Username</label>\r\n          <InputText id=\"username\" name=\"username\" {...register('username', { required: 'Campo obrigatório.' })} className={classNames({ 'p-invalid': errors.username })} />\r\n          {getFormErrorMessage(errors, 'username')}\r\n        </div>\r\n        <div className=\"p-field p-col-12 p-md-4\">\r\n          <label htmlFor=\"email\">Email</label>\r\n          <InputText id=\"email\" name=\"email\" {...register('email', { required: 'Campo obrigatório.' })} className={classNames({ 'p-invalid': errors.email })} />\r\n          {getFormErrorMessage(errors, 'email')}\r\n        </div>\r\n        <div className=\"p-field p-col-12 p-md-4\">\r\n          <label htmlFor=\"password\">Password</label>\r\n          <Controller\r\n            control={control}\r\n            name=\"password\"\r\n            render={({ field }) => {\r\n              return <Password {...field} feedback={false}  onChange={(e) => field.onChange(e.target.value)} />\r\n            }} \r\n          />\r\n        </div>\r\n\r\n        <div className=\"p-field p-col-12\">\r\n          <div className=\"p-grid\">              \r\n            <div className=\"p-col-3 p-mt-2 p-mb-2\">\r\n              <label>&nbsp;</label>\r\n              <Controller\r\n                control={control}\r\n                name=\"active\"\r\n                render={({ field }) => {\r\n                  return <ToggleButton {...field} checked={field.value} onChange={(e) => field.onChange(e.target.value)} onLabel=\"Utilizador Ativo\" offLabel=\"Utilizador Não Ativo\" onIcon=\"pi pi-check\" offIcon=\"pi pi-times\" />\r\n                }} \r\n              />                    \r\n            </div>\r\n          </div>            \r\n        </div>\r\n\r\n        <div className=\"p-field p-col-12 p-md-6\">\r\n          <label htmlFor=\"auth_token\">Token de Autenticação</label>\r\n          <div className=\"p-inputgroup\">\r\n              <Button type=\"button\" label=\"Gerar\" icon=\"pi pi-check\" className=\"p-button-primary\" onClick={(e) => { setValue('auth_token', String(uuidV4())); } } />\r\n              <InputText id=\"auth_token\" name=\"auth_token\" {...register('auth_token')} placeholder=\"Token não definido\" />\r\n              <Button type=\"button\" icon=\"pi pi-times\" className=\"p-button-danger\" onClick={(e) => { setValue('auth_token', null); setValue('auth_token_expire', null); } } />                \r\n          </div>\r\n        </div>\r\n        <div className=\"p-field p-col-12 p-md-3\">\r\n          <label htmlFor=\"auth_token_expire\">Data de Validade do Token</label>\r\n          <div className=\"p-inputgroup\">\r\n              <Controller\r\n                control={control}\r\n                name=\"auth_token_expire\"\r\n                render={({ field }) => {              \r\n                  return <Calendar {...field} \r\n                    dateFormat=\"yy-mm-dd\"\r\n                    onChange={(e) => field.onChange(e.target.value)} \r\n                    showIcon showTime showSeconds />\r\n                }} \r\n              />                    \r\n              <Button type=\"button\" icon=\"pi pi-times\" className=\"p-button-danger\" onClick={(e) => setValue('auth_token_expire', null) } />\r\n          </div>\r\n        </div>          \r\n\r\n        <div className=\"p-field p-col-12 p-md-6\">\r\n          <label>Perfis</label>\r\n          <div className=\"p-card p-p-2\">\r\n            { (availableRoles && availableRoles.length > 0) && \r\n            <>\r\n            <div className=\"p-field p-col-12 p-pl-0\">\r\n              <MultiSelect value={selectedRoles} options={availableRoles} \r\n                optionLabel=\"name\" optionValue=\"id\" display=\"chip\" showClear \r\n                filter filterValue={filterRolesValue} \r\n                onFilterValueChange={(e) => setFilterRolesValue(e.value)}\r\n                onChange={(e) => setSelectedRoles(e.value)} placeholder=\"Selecionar\" />\r\n            </div>              \r\n            <div className=\"p-grid\">\r\n              <div className=\"p-col\"></div>\r\n              <div className=\"p-col\">\r\n                  <Button label=\"Adicionar\" type=\"button\" \r\n                    disabled={(!selectedRoles || selectedRoles.length === 0)}\r\n                  onClick={addRoles} />\r\n              </div>\r\n              <div className=\"p-col\"></div>\r\n            </div>\r\n            </>\r\n            }\r\n            { (roles && roles.length > 0) ?\r\n              <>        \r\n              <div className=\"p-field p-col-12 p-pl-0 p-pt-2\">\r\n                <ListBox optionLabel=\"name\" optionValue=\"id\" className=\"p-p-1\"\r\n                  options={roles} value={removedRoles}\r\n                  onChange={(e) => setRemovedRoles(e.value)} multiple />\r\n              </div>\r\n              <div className=\"p-grid\">\r\n                <div className=\"p-col\"></div>\r\n                <div className=\"p-col\">\r\n                  <Button label=\"Remover\" type=\"button\" \r\n                  disabled={(!removedRoles || removedRoles.length === 0)}\r\n                  onClick={removeRoles} />\r\n                </div>\r\n                <div className=\"p-col\"></div>\r\n              </div>\r\n              </> :\r\n              <div className=\"p-grid p-justify-center\">\r\n                <div className=\"p-col-12 p-mt-4 p-mb-2\">\r\n                  <Message severity=\"warn\" text=\"Adicione um ou mais Perfis\" />\r\n                </div>\r\n              </div>\r\n            }\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"p-field p-col-12 p-md-6\">\r\n          <label>Grupos</label>\r\n          <div className=\"p-card p-p-2\">\r\n            { (availableGroups && availableGroups.length > 0) && \r\n            <>\r\n            <div className=\"p-field p-col-12 p-pl-0\">\r\n              <MultiSelect value={selectedGroups} options={availableGroups} \r\n                optionLabel=\"name\" optionValue=\"id\" display=\"chip\" showClear \r\n                filter filterValue={filterGroupsValue} \r\n                onFilterValueChange={(e) => setFilterGroupsValue(e.value)}\r\n                onChange={(e) => setSelectedGroups(e.value)} placeholder=\"Selecionar\" />\r\n            </div>              \r\n            <div className=\"p-grid\">\r\n              <div className=\"p-col\"></div>\r\n              <div className=\"p-col\">\r\n                  <Button label=\"Adicionar\" type=\"button\" \r\n                    disabled={(!selectedGroups || selectedGroups.length === 0)}\r\n                  onClick={addGroups} />\r\n              </div>\r\n              <div className=\"p-col\"></div>\r\n            </div>\r\n            </>\r\n            }\r\n            { (groups && groups.length > 0) ?\r\n              <>        \r\n              <div className=\"p-field p-col-12 p-pl-0 p-pt-2\">\r\n                <ListBox optionLabel=\"name\" optionValue=\"id\" className=\"p-p-1\"\r\n                  options={groups} value={removedGroups}\r\n                  onChange={(e) => setRemovedGroups(e.value)} multiple />\r\n              </div>\r\n              <div className=\"p-grid\">\r\n                <div className=\"p-col\"></div>\r\n                <div className=\"p-col\">\r\n                  <Button label=\"Remover\" type=\"button\" \r\n                  disabled={(!removedGroups || removedGroups.length === 0)}\r\n                  onClick={removeGroups} />\r\n                </div>\r\n                <div className=\"p-col\"></div>\r\n              </div>\r\n              </> :\r\n              <div className=\"p-grid p-justify-center\">\r\n                <div className=\"p-col-12 p-mt-4 p-mb-2\">\r\n                  <Message severity=\"warn\" text=\"Adicione um ou mais Grupos\" />\r\n                </div>\r\n              </div>\r\n            }\r\n          </div>\r\n        </div>          \r\n\r\n      </div>\r\n\r\n      <Toolbar className=\"p-mt-4 p-mb-4\" right={rightToolbarTemplate}></Toolbar>\r\n\r\n    </form>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(UserForm));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport UserForm from './UserForm';\r\n\r\nfunction UserEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const { id } = useParams();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [record, setRecord] = useState(null);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/security');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setLoading(true);    \r\n\r\n    provider.getOne('users', params).then(d => {\r\n      const data = {...d.data}\r\n      data.auth_token_expire = data.auth_token && data.auth_token_expire ? new Date(data.auth_token_expire) : null;\r\n      setRecord(data);      \r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      console.log(e);\r\n      //toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n    { record ?      \r\n        <UserForm data={record} />\r\n      :\r\n      <div>loading...</div>\r\n    }\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(UserEdit));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect, useDispatch } from 'react-redux';\r\nimport { withRouter, Route, Link } from 'react-router-dom';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { confirmDialog } from 'primereact/confirmdialog';\r\nimport { Toast } from 'primereact/toast';\r\n\r\nimport AppContext from '../../../AppContext'\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\n\r\nconst initialSearchParams = {\r\n  filters: {},\r\n  first: 0,\r\n  rows: 20,\r\n  page: 0,\r\n  sortField: 'id',\r\n  sortOrder: 1\r\n};\r\n\r\n\r\nfunction RoleList(props) {\r\n\r\n  const {\r\n    history\r\n  } = props;\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(false);  \r\n  const [records, setRecords] = useState([]);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n\r\n  const [searchParams, setSearchParams] = useState({...initialSearchParams}); \r\n\r\n  const loaded = useRef(false);\r\n  const dt = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (!loaded.current && history.location?.state?.searchParams) {\r\n      loaded.current = true;\r\n\r\n      const _searchParams = {...history.location.state.searchParams};\r\n      setSearchParams(_searchParams);\r\n    } else {\r\n      loadData();\r\n    }\r\n  }, [searchParams]);\r\n\r\n  const newRecord = () => {\r\n    const location = {\r\n      pathname: '/security/roles/create',\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);   \r\n  }\r\n\r\n  const editRecord = (record) => {\r\n    const location = {\r\n      pathname: `/security/roles/edit/${record.id}`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);\r\n  }\r\n\r\n  const deleteSelectedRecords = () => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o(s) registo(s) selecionado(s)?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/security');\r\n        const params = {\r\n          ids: selectedRecords.filter(v => !v.read_only).map(v => v.id)\r\n        }\r\n        provider.deleteMany('users', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo(s)', detail: 'Registo(s) eliminado(s) com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo(s)', detail: 'Ocorreu um erro ao eliminar o(s) registo(s)'}); \r\n        }).finally(() => {\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }\r\n  \r\n  const deleteRecord = (record) => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o registo selecionado?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/security');\r\n        const params = {\r\n          id: record.id\r\n        }      \r\n        provider.delete('roles', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo', detail: 'Registo eliminado com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo', detail: 'Ocorreu um erro ao eliminar o registo'}); \r\n        }).finally(() => {\r\n          //console.log('finally');\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }  \r\n\r\n  const exportCSV = () => {\r\n    //TODO: implement export\r\n    //dt.current.exportCSV();\r\n  }\r\n\r\n  const loadData = (filters) => {\r\n    const provider = dataProvider(API_URL + '/security');\r\n  \r\n    const _filter = {};\r\n    if (filters) {\r\n      Object.entries(filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    } else if (searchParams.filters) {\r\n      Object.entries(searchParams.filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    }\r\n\r\n    const params = {\r\n      pagination: { page: searchParams.page + 1, perPage: searchParams.rows},\r\n      sort: { field: searchParams.sortField, order: searchParams.sortOrder == -1 ? 'Desc' : 'Asc' },\r\n      filter: _filter\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    provider.getList('roles', params).then(d => {\r\n      setSelectedRecords(null);\r\n      setRecords({ ...d, page: searchParams.page });\r\n    }).catch(e => {\r\n      toast.current.show({life: 3000, severity: 'error', summary: 'Pesquisa de Perfis', detail: 'Ocorreu um erro ao realizar a pesquisa'});\r\n    }).finally(() => {\r\n      setLoading(false);\r\n    });\r\n  }\r\n\r\n  const onPage = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onSort = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onFilter = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    _searchParams['first'] = 0;\r\n    setSearchParams(_searchParams);    \r\n  }\r\n\r\n  const onFilterClear = (event) => {\r\n    setSearchParams({ ...initialSearchParams});    \r\n  }\r\n\r\n  const onSelectionChange = (event) => {\r\n    setSelectedRecords(event.value.filter(v => !v.read_only));\r\n  }\r\n\r\n  const leftToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Novo\" icon=\"pi pi-plus\" className=\"p-button-success p-mr-2\" onClick={newRecord} />\r\n            <Button label=\"Eliminar\" icon=\"pi pi-trash\" className=\"p-button-danger\" onClick={deleteSelectedRecords} disabled={!selectedRecords || !selectedRecords.length} />\r\n        </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n      <React.Fragment>\r\n          <Button label=\"Limpar\" icon=\"pi pi-times\" className=\"p-button-help p-mr-2\" onClick={onFilterClear} />\r\n          {/*<Button label=\"Export\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} />*/}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    if (rowData.read_only) {\r\n      return (<Button icon=\"fas fa-lock\" className=\"p-button-rounded p-button-secondary\" disabled />);\r\n    } else {\r\n      return (\r\n          <React.Fragment>\r\n              <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success p-mr-2\" onClick={() => editRecord(rowData)} />\r\n              <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => deleteRecord(rowData)} />\r\n          </React.Fragment>\r\n      );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"p-col-12\"><h3>Utilizadores - Perfis</h3></div>\r\n\r\n      <div className=\"p-grid p-fluid viewer-list\">\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n          <div className=\"card\">\r\n            <Toolbar className=\"p-mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n            <DataTable ref={dt} value={records ? records.data : []} lazy\r\n                selectionMode=\"checkbox\"\r\n                selection={selectedRecords} onSelectionChange={onSelectionChange}\r\n                paginator first={searchParams.first} rows={searchParams.rows} totalRecords={records.total} onPage={onPage}\r\n                onSort={onSort} sortField={searchParams.sortField} sortOrder={searchParams.sortOrder}\r\n                filters={searchParams.filters} onFilter={onFilter} loading={loading}\r\n                emptyMessage=\"Não foram encontrados registos.\" >\r\n                <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n                <Column field=\"id\" header=\"Id\" sortable filter filterPlaceholder=\"Id\" headerStyle={{ width: '6rem' }} />\r\n                <Column field=\"name\" header=\"Nome\" sortable filter filterPlaceholder=\"Nome\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column field=\"description\" header=\"Descrição\" sortable filter filterPlaceholder=\"Descrição\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column body={actionBodyTemplate} style={{textAlign: \"center\", width: '12rem'}} />\r\n            </DataTable>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, auth: state.auth, filters: state.filters }))(withRouter(RoleList));","import React, { useContext, useState, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { useForm } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { classNames } from 'primereact/utils';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nfunction RoleForm(props) {\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [data, setData] = useState(props.data || {});\r\n\r\n  const toast = useRef(null);\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {...data}\r\n  });\r\n\r\n  const goBack = () => {\r\n    const location = {\r\n      pathname: history.location.state.from,\r\n      state: { \r\n        searchParams: {...history.location.state.previousSearchParams}\r\n      }\r\n    }\r\n    history.replace(location);\r\n    //history.goBack();\r\n  }\r\n\r\n  const onSubmit = (formData) => {\r\n    const new_data = {\r\n      name: formData.name,\r\n      description: formData.description\r\n    }\r\n\r\n    setIsSaving(true);\r\n\r\n    const provider = dataProvider(API_URL + '/security');      \r\n    if (data.id) {\r\n      const params = {\r\n        id: data.id,\r\n        data: {...new_data}\r\n      }\r\n      provider.update('roles', params).then(d => {       \r\n        toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });\r\n    } else {\r\n      const params = {\r\n        data: {...new_data}\r\n      }\r\n      provider.create('roles', params).then(d => {\r\n        setData({...data, id: d.data.id});\r\n        toast.current.show({life: 5000, severity: 'success', summary: 'Criar Registo', detail: 'Registo criada com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Criar Registo', detail: 'Ocorreu um erro ao criar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });       \r\n    }\r\n  };\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      let msg;\r\n\r\n      if (errors[name].type === 'required') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Campo obrigatório'}</small>\r\n      } else if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">{errors[name].message || 'O número de caracteres é superior à dimensão máxima permitida'}</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Formato inválido'}</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n \r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n              type=\"button\" \r\n              label=\"Voltar\" \r\n              icon=\"pi pi-left\" \r\n              className=\"p-button-secondary p-mr-4\"\r\n              disabled={isSaving ? true : false} \r\n              onClick={goBack} />\r\n            <Button\r\n              type=\"submit\" \r\n              label=\"Gravar\"\r\n              icon={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n              disabled={isSaving ? true : false} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  return (\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n\r\n          <div className=\"p-fluid p-formgrid p-grid\">      \r\n            <div className=\"p-field p-col-12 p-md-2\">\r\n              <label htmlFor=\"id\">Id</label>\r\n              <InputText id=\"id\" type=\"text\" value={data.id || ''} disabled />\r\n            </div>         \r\n\r\n            <div className=\"p-field p-col-12 p-md-10\">\r\n              <label htmlFor=\"name\">Designação</label>        \r\n              <InputText id=\"name\" name=\"name\" {...register('name', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.name })} />\r\n              {getFormErrorMessage(errors, 'name')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-12\">\r\n              <label htmlFor=\"description\">Descrição</label>        \r\n              <InputText id=\"description\" name=\"notes\" {...register('description')} autoFocus />\r\n              {getFormErrorMessage(errors, 'notes')}\r\n            </div>\r\n\r\n          </div>\r\n\r\n        <Toolbar className=\"p-mt-4 p-mb-4\" right={rightToolbarTemplate}></Toolbar>\r\n\r\n      </form>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(RoleForm));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport RoleForm from './RoleForm';\r\n\r\nfunction RoleEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const { id } = useParams();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [record, setRecord] = useState(null);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/security');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setLoading(true);    \r\n\r\n    provider.getOne('roles', params).then(d => {\r\n      const data = {...d.data}\r\n      setRecord(data);      \r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      console.log(e);\r\n      //toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n    { record ?      \r\n        <RoleForm data={record} />\r\n      :\r\n      <div>loading...</div>\r\n    }\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(RoleEdit));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { confirmDialog } from 'primereact/confirmdialog';\r\nimport { Toast } from 'primereact/toast';\r\n\r\nimport AppContext from '../../../AppContext'\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\n\r\nconst initialSearchParams = {\r\n  filters: {},\r\n  first: 0,\r\n  rows: 20,\r\n  page: 0,\r\n  sortField: 'id',\r\n  sortOrder: 1\r\n};\r\n\r\n\r\nfunction GroupList(props) {\r\n\r\n  const {\r\n    history,  \r\n  } = props;\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(false);  \r\n  const [records, setRecords] = useState([]);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n\r\n  const [searchParams, setSearchParams] = useState({...initialSearchParams}); \r\n\r\n  const loaded = useRef(false);\r\n  const dt = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (!loaded.current && history.location?.state?.searchParams) {\r\n      loaded.current = true;\r\n\r\n      const _searchParams = {...history.location.state.searchParams};\r\n      setSearchParams(_searchParams);\r\n    } else {\r\n      loadData();\r\n    }\r\n  }, [searchParams]);\r\n\r\n  const newRecord = () => {\r\n    const location = {\r\n      pathname: '/security/groups/create',\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);   \r\n  }\r\n\r\n  const editRecord = (record) => {\r\n    const location = {\r\n      pathname: `/security/groups/edit/${record.id}`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);\r\n  }\r\n\r\n  const deleteSelectedRecords = () => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o(s) registo(s) selecionado(s)?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/security');\r\n        const params = {\r\n          ids: selectedRecords.filter(v => !v.read_only).map(v => v.id)\r\n        }\r\n        provider.deleteMany('users', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo(s)', detail: 'Registo(s) eliminado(s) com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo(s)', detail: 'Ocorreu um erro ao eliminar o(s) registo(s)'}); \r\n        }).finally(() => {\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }\r\n  \r\n  const deleteRecord = (record) => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o registo selecionado?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/security');\r\n        const params = {\r\n          id: record.id\r\n        }      \r\n        provider.delete('groups', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo', detail: 'Registo eliminado com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo', detail: 'Ocorreu um erro ao eliminar o registo'}); \r\n        }).finally(() => {\r\n          //console.log('finally');\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }  \r\n\r\n  const exportCSV = () => {\r\n    //TODO: implement export\r\n    //dt.current.exportCSV();\r\n  }\r\n\r\n  const loadData = (filters) => {\r\n    const provider = dataProvider(API_URL + '/security');\r\n  \r\n    const _filter = {};\r\n    if (filters) {\r\n      Object.entries(filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    } else if (searchParams.filters) {\r\n      Object.entries(searchParams.filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    }\r\n\r\n    const params = {\r\n      pagination: { page: searchParams.page + 1, perPage: searchParams.rows},\r\n      sort: { field: searchParams.sortField, order: searchParams.sortOrder == -1 ? 'Desc' : 'Asc' },\r\n      filter: _filter\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    provider.getList('groups', params).then(d => {\r\n      setSelectedRecords(null);\r\n      setRecords({ ...d, page: searchParams.page });\r\n    }).catch(e => {\r\n      toast.current.show({life: 3000, severity: 'error', summary: 'Pesquisa de Grupos', detail: 'Ocorreu um erro ao realizar a pesquisa'});\r\n    }).finally(() => {\r\n      setLoading(false);\r\n    });\r\n  }\r\n\r\n  const onPage = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onSort = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onFilter = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    _searchParams['first'] = 0;\r\n    setSearchParams(_searchParams);    \r\n  }\r\n\r\n  const onFilterClear = (event) => {\r\n    setSearchParams({ ...initialSearchParams});    \r\n  }\r\n\r\n  const onSelectionChange = (event) => {\r\n    setSelectedRecords(event.value.filter(v => !v.read_only));\r\n  }\r\n\r\n  const leftToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Novo\" icon=\"pi pi-plus\" className=\"p-button-success p-mr-2\" onClick={newRecord} />\r\n            <Button label=\"Eliminar\" icon=\"pi pi-trash\" className=\"p-button-danger\" onClick={deleteSelectedRecords} disabled={!selectedRecords || !selectedRecords.length} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n      <React.Fragment>\r\n          <Button label=\"Limpar\" icon=\"pi pi-times\" className=\"p-button-help p-mr-2\" onClick={onFilterClear} />\r\n          {/*<Button label=\"Export\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} />*/}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    if (rowData.read_only) {\r\n      return (<Button icon=\"fas fa-lock\" className=\"p-button-rounded p-button-secondary\" disabled />);\r\n    } else {\r\n      return (\r\n          <React.Fragment>\r\n              <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success p-mr-2\" onClick={() => editRecord(rowData)} />\r\n              <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => deleteRecord(rowData)} />\r\n          </React.Fragment>\r\n      );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"p-col-12\"><h3>Utilizadores - Grupos</h3></div>\r\n\r\n      <div className=\"p-grid p-fluid viewer-list\">\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n          <div className=\"card\">\r\n            <Toolbar className=\"p-mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n            <DataTable ref={dt} value={records ? records.data : []} lazy\r\n                selectionMode=\"checkbox\"\r\n                selection={selectedRecords} onSelectionChange={onSelectionChange}\r\n                paginator first={searchParams.first} rows={searchParams.rows} totalRecords={records.total} onPage={onPage}\r\n                onSort={onSort} sortField={searchParams.sortField} sortOrder={searchParams.sortOrder}\r\n                filters={searchParams.filters} onFilter={onFilter} loading={loading}\r\n                emptyMessage=\"Não foram encontrados registos.\" >\r\n                <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n                <Column field=\"id\" header=\"Id\" sortable filter filterPlaceholder=\"Id\" headerStyle={{ width: '6rem' }} />\r\n                <Column field=\"name\" header=\"Nome\" sortable filter filterPlaceholder=\"Nome\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column field=\"description\" header=\"Descrição\" sortable filter filterPlaceholder=\"Descrição\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column body={actionBodyTemplate} style={{textAlign: \"center\", width: '12rem'}} />\r\n            </DataTable>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, auth: state.auth, filters: state.filters }))(withRouter(GroupList));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect, useDispatch } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { InputTextarea } from 'primereact/inputtextarea';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { MultiSelect } from 'primereact/multiselect';\r\nimport { ListBox } from 'primereact/listbox';\r\nimport { Message } from 'primereact/message';\r\nimport { classNames } from 'primereact/utils';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport useFormFields from '../../useFormFields';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nconst sortRolesArray = (data) => {\r\n  if (!data) return data;\r\n\r\n  return data.sort(function(a, b) {\r\n    if (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\r\n    if (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nconst sortUsersArray = (data) => {\r\n  if (!data) return data;\r\n\r\n  return data.sort(function(a, b) {\r\n    if (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\r\n    if (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nfunction GroupForm(props) {\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [data, setData] = useState(props.data || {});\r\n\r\n  const [roles, setRoles] = useState(props?.data?.roles ? sortRolesArray([...props.data.roles]) : []);\r\n  const [availableRoles, setAvailableRoles] = useState(null);\r\n  const [selectedRoles, setSelectedRoles] = useState(null);\r\n  const [removedRoles, setRemovedRoles] = useState(null);\r\n  const [filterRolesValue, setFilterRolesValue] = useState('');\r\n\r\n  const [users, setUsers] = useState(props?.data?.users ? sortUsersArray([...props.data.users]) : []);\r\n  const [availableUsers, setAvailableUsers] = useState(null);\r\n  const [selectedUsers, setSelectedUsers] = useState(null);\r\n  const [removedUsers, setRemovedUsers] = useState(null);\r\n  const [filterUsersValue, setFilterUsersValue] = useState('');\r\n\r\n  const toast = useRef(null);\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {...data}\r\n  });\r\n\r\n  useEffect(() => {\r\n    const params = {\r\n      pagination: { page: 1, perPage: 1000},\r\n      sort: { field: 'name', order: 'Asc' },\r\n      filter: {}\r\n    }  \r\n\r\n    Promise.all([\r\n      dataProvider(API_URL + '/security').getList('roles', params).catch((error) => error),\r\n      dataProvider(API_URL + '/security').getList('users', params).catch((error) => error)\r\n    ]).then((result) => {      \r\n      //console.log(result);\r\n\r\n      const roles_result = result[0];\r\n      const rids = props?.data?.roles ? props.data.roles.map(v => v.id) : [];\r\n      setAvailableRoles(sortRolesArray(roles_result.data.filter(v => !rids.includes(v.id))\r\n        .map(r => { return { id: r.id, name: r.name} })));\r\n\r\n      const users_result = result[1];\r\n      const gids = props?.data?.users ? props.data.users.map(v => v.id) : [];\r\n      setAvailableUsers(sortUsersArray(users_result.data.filter(v => !gids.includes(v.id))\r\n        .map(g => { return { id: g.id, name: g.name} })));\r\n\r\n    }).catch((error) => {\r\n      console.log(error)\r\n    });    \r\n  }, []);\r\n\r\n  const addRoles = () => {\r\n    if (!availableRoles) return;\r\n    \r\n    const new_roles = availableRoles.filter(v => selectedRoles.includes(v.id));\r\n    const new_available_roles = availableRoles.filter(v => !selectedRoles.includes(v.id));\r\n\r\n    setRoles(sortRolesArray([...roles, ...new_roles]));\r\n    setAvailableRoles(sortRolesArray([...new_available_roles]));\r\n    setSelectedRoles(null);\r\n    setRemovedRoles(null);\r\n  }\r\n\r\n  const removeRoles = () => {\r\n    if (!removedRoles) return;\r\n    \r\n    const new_available_roles = roles.filter(v => removedRoles.includes(v.id));\r\n    const new_roles = roles.filter(v => !removedRoles.includes(v.id));\r\n\r\n    setRoles(sortRolesArray([...new_roles]));\r\n    setAvailableRoles(sortRolesArray([...availableRoles, ...new_available_roles]));\r\n    setRemovedRoles(null);\r\n    setSelectedRoles(null);\r\n  }\r\n  \r\n  const addUsers = () => {\r\n    if (!availableUsers) return;\r\n    \r\n    const new_users = availableUsers.filter(v => selectedUsers.includes(v.id));\r\n    const new_available_users = availableUsers.filter(v => !selectedUsers.includes(v.id));\r\n\r\n    setUsers(sortUsersArray([...users, ...new_users]));\r\n    setAvailableUsers(sortUsersArray([...new_available_users]));\r\n    setSelectedUsers(null);\r\n    setRemovedUsers(null);\r\n  }\r\n\r\n  const removeUsers = () => {\r\n    if (!removedUsers) return;\r\n    \r\n    const new_available_users = users.filter(v => removedUsers.includes(v.id));\r\n    const new_users = users.filter(v => !removedUsers.includes(v.id));\r\n\r\n    setUsers(sortUsersArray([...new_users]));\r\n    setAvailableUsers(sortUsersArray([...availableUsers, ...new_available_users]));\r\n    setRemovedUsers(null);\r\n    setSelectedUsers(null);\r\n  }   \r\n\r\n  const goBack = () => {\r\n    const location = {\r\n      pathname: history.location.state.from,\r\n      state: { \r\n        searchParams: {...history.location.state.previousSearchParams}\r\n      }\r\n    }\r\n    history.replace(location);\r\n    //history.goBack();\r\n  }\r\n\r\n  const onSubmit = (formData) => {\r\n    const new_data = {\r\n      name: formData.name,\r\n      description: formData.description,\r\n      roles: roles ? roles.map(r => r.id) : [],\r\n      users: users ? users.map(r => r.id) : []\r\n    }\r\n\r\n    setIsSaving(true);\r\n\r\n    const provider = dataProvider(API_URL + '/security');      \r\n    if (data.id) {\r\n      const params = {\r\n        id: data.id,\r\n        data: {...new_data}\r\n      }\r\n      provider.update('groups', params).then(d => {       \r\n        toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });\r\n    } else {\r\n      const params = {\r\n        data: {...new_data}\r\n      }\r\n      provider.create('groups', params).then(d => {\r\n        setData({...data, id: d.data.id});\r\n        toast.current.show({life: 5000, severity: 'success', summary: 'Criar Registo', detail: 'Registo criada com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Criar Registo', detail: 'Ocorreu um erro ao criar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });       \r\n    }\r\n  };\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      let msg;\r\n\r\n      if (errors[name].type === 'required') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Campo obrigatório'}</small>\r\n      } else if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">{errors[name].message || 'O número de caracteres é superior à dimensão máxima permitida'}</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Formato inválido'}</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n \r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n              type=\"button\" \r\n              label=\"Voltar\" \r\n              icon=\"pi pi-left\" \r\n              className=\"p-button-secondary p-mr-4\"\r\n              disabled={isSaving ? true : false} \r\n              onClick={goBack} />\r\n            <Button\r\n              type=\"submit\" \r\n              label=\"Gravar\"\r\n              icon={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n              disabled={isSaving ? true : false} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  return (\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n\r\n          <div className=\"p-fluid p-formgrid p-grid\">      \r\n            <div className=\"p-field p-col-12 p-md-2\">\r\n              <label htmlFor=\"id\">Id</label>\r\n              <InputText id=\"id\" type=\"text\" value={data.id || ''} disabled />\r\n            </div>         \r\n\r\n            <div className=\"p-field p-col-12 p-md-10\">\r\n              <label htmlFor=\"name\">Designação</label>        \r\n              <InputText id=\"name\" name=\"name\" {...register('name', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.name })} />\r\n              {getFormErrorMessage(errors, 'name')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-12\">\r\n              <label htmlFor=\"description\">Descrição</label>        \r\n              <InputText id=\"description\" name=\"notes\" {...register('description')} autoFocus />\r\n              {getFormErrorMessage(errors, 'notes')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-6\">\r\n              <label>Perfis</label>\r\n              <div className=\"p-card p-p-2\">\r\n                { (availableRoles && availableRoles.length > 0) && \r\n                <>\r\n                <div className=\"p-field p-col-12 p-pl-0\">\r\n                  <MultiSelect value={selectedRoles} options={availableRoles} \r\n                    optionLabel=\"name\" optionValue=\"id\" display=\"chip\" showClear \r\n                    filter filterValue={filterRolesValue} \r\n                    onFilterValueChange={(e) => setFilterRolesValue(e.value)}\r\n                    onChange={(e) => setSelectedRoles(e.value)} placeholder=\"Selecionar\" />\r\n                </div>              \r\n                <div className=\"p-grid\">\r\n                  <div className=\"p-col\"></div>\r\n                  <div className=\"p-col\">\r\n                      <Button label=\"Adicionar\" type=\"button\" \r\n                        disabled={(!selectedRoles || selectedRoles.length === 0)}\r\n                      onClick={addRoles} />\r\n                  </div>\r\n                  <div className=\"p-col\"></div>\r\n                </div>\r\n                </>\r\n                }\r\n                { (roles && roles.length > 0) ?\r\n                  <>        \r\n                  <div className=\"p-field p-col-12 p-pl-0 p-pt-2\">\r\n                    <ListBox optionLabel=\"name\" optionValue=\"id\" className=\"p-p-1\"\r\n                      options={roles} value={removedRoles}\r\n                      onChange={(e) => setRemovedRoles(e.value)} multiple />\r\n                  </div>\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col\"></div>\r\n                    <div className=\"p-col\">\r\n                      <Button label=\"Remover\" type=\"button\" \r\n                      disabled={(!removedRoles || removedRoles.length === 0)}\r\n                      onClick={removeRoles} />\r\n                    </div>\r\n                    <div className=\"p-col\"></div>\r\n                  </div>\r\n                  </> :\r\n                  <div className=\"p-grid p-justify-center\">\r\n                    <div className=\"p-col-12 p-mt-4 p-mb-2\">\r\n                      <Message severity=\"warn\" text=\"Adicione um ou mais Perfis\" />\r\n                    </div>\r\n                  </div>\r\n                }\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-6\">\r\n              <label>Utilizadores</label>\r\n              <div className=\"p-card p-p-2\">\r\n                { (availableUsers && availableUsers.length > 0) && \r\n                <>\r\n                <div className=\"p-field p-col-12 p-pl-0\">\r\n                  <MultiSelect value={selectedUsers} options={availableUsers} \r\n                    optionLabel=\"name\" optionValue=\"id\" display=\"chip\" showClear \r\n                    filter filterValue={filterUsersValue} \r\n                    onFilterValueChange={(e) => setFilterUsersValue(e.value)}\r\n                    onChange={(e) => setSelectedUsers(e.value)} placeholder=\"Selecionar\" />\r\n                </div>              \r\n                <div className=\"p-grid\">\r\n                  <div className=\"p-col\"></div>\r\n                  <div className=\"p-col\">\r\n                      <Button label=\"Adicionar\" type=\"button\" \r\n                        disabled={(!selectedUsers || selectedUsers.length === 0)}\r\n                      onClick={addUsers} />\r\n                  </div>\r\n                  <div className=\"p-col\"></div>\r\n                </div>\r\n                </>\r\n                }\r\n                { (users && users.length > 0) ?\r\n                  <>        \r\n                  <div className=\"p-field p-col-12 p-pl-0 p-pt-2\">\r\n                    <ListBox optionLabel=\"name\" optionValue=\"id\" className=\"p-p-1\"\r\n                      options={users} value={removedUsers}\r\n                      onChange={(e) => setRemovedUsers(e.value)} multiple />\r\n                  </div>\r\n                  <div className=\"p-grid\">\r\n                    <div className=\"p-col\"></div>\r\n                    <div className=\"p-col\">\r\n                      <Button label=\"Remover\" type=\"button\" \r\n                      disabled={(!removedUsers || removedUsers.length === 0)}\r\n                      onClick={removeUsers} />\r\n                    </div>\r\n                    <div className=\"p-col\"></div>\r\n                  </div>\r\n                  </> :\r\n                  <div className=\"p-grid p-justify-center\">\r\n                    <div className=\"p-col-12 p-mt-4 p-mb-2\">\r\n                      <Message severity=\"warn\" text=\"Adicione um ou mais Utilizadores\" />\r\n                    </div>\r\n                  </div>\r\n                }\r\n              </div>\r\n            </div>                       \r\n\r\n          </div>\r\n\r\n\r\n        <Toolbar className=\"p-mt-4 p-mb-4\" right={rightToolbarTemplate}></Toolbar>\r\n\r\n      </form>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(GroupForm));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport GroupForm from './GroupForm';\r\n\r\nfunction GroupEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const { id } = useParams();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [record, setRecord] = useState(null);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/security');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setLoading(true);    \r\n\r\n    provider.getOne('groups', params).then(d => {\r\n      const data = {...d.data}\r\n      setRecord(data);      \r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      console.log(e);\r\n      //toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n    { record ?      \r\n        <GroupForm data={record} />\r\n      :\r\n      <div>loading...</div>\r\n    }\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(GroupEdit));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect, useDispatch } from 'react-redux';\r\nimport { withRouter, Route, Link } from 'react-router-dom';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { Chip } from 'primereact/chip';\r\nimport { Dialog } from 'primereact/dialog';\r\nimport { confirmDialog } from 'primereact/confirmdialog';\r\nimport { Toast } from 'primereact/toast';\r\n\r\nimport AppContext from '../../../AppContext'\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\n\r\nconst initialSearchParams = {\r\n  filters: {},\r\n  first: 0,\r\n  rows: 20,\r\n  page: 0,\r\n  sortField: 'id',\r\n  sortOrder: 1\r\n};\r\n\r\n\r\nfunction ParameterList(props) {\r\n\r\n  const {\r\n    history   \r\n  } = props;\r\n\r\n  const parameters_table = props.parametersTable || 'site';\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(false);  \r\n  const [records, setRecords] = useState([]);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n  const [displayFieldValue, setDisplayFieldValue] = useState(false);\r\n  const [fieldValue, setFieldValue] = useState();\r\n\r\n  const [searchParams, setSearchParams] = useState({...initialSearchParams});\r\n\r\n  const loaded = useRef(false);\r\n  const dt = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (!loaded.current && history.location?.state?.searchParams) {\r\n      loaded.current = true;\r\n\r\n      const _searchParams = {...history.location.state.searchParams};\r\n      setSearchParams(_searchParams);\r\n    } else {\r\n      loadData();\r\n    }\r\n  }, [searchParams]);\r\n\r\n  const newRecord = () => {\r\n    const location = {\r\n      pathname: `/settings/parameters/create`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);   \r\n  }\r\n\r\n  const editRecord = (record) => {\r\n    const location = {\r\n      pathname: `/settings/parameters/edit/${record.id}`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);\r\n  }\r\n\r\n  const deleteSelectedRecords = () => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o(s) registo(s) selecionado(s)?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal/settings');\r\n        const params = {\r\n          ids: selectedRecords.filter(v => !v.read_only).map(v => v.id)\r\n        }\r\n        provider.deleteMany(parameters_table, params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo(s)', detail: 'Registo(s) eliminado(s) com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo(s)', detail: 'Ocorreu um erro ao eliminar o(s) registo(s)'}); \r\n        }).finally(() => {\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });   \r\n  }\r\n  \r\n  const deleteRecord = (record) => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o registo selecionado?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal/settings');\r\n        const params = {\r\n          id: record.id\r\n        }      \r\n        provider.delete(parameters_table, params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo', detail: 'Registo eliminado com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo', detail: 'Ocorreu um erro ao eliminar o registo'}); \r\n        }).finally(() => {\r\n          //console.log('finally');\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }  \r\n\r\n  const exportCSV = () => {\r\n    //TODO: implement export\r\n    //dt.current.exportCSV();\r\n  }\r\n\r\n  const loadData = (filters) => {\r\n    const provider = dataProvider(API_URL + '/portal/settings');\r\n  \r\n    const _filter = {};\r\n    if (filters) {\r\n      Object.entries(filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    } else if (searchParams.filters) {\r\n      Object.entries(searchParams.filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    }\r\n\r\n    const params = {\r\n      pagination: { page: searchParams.page + 1, perPage: searchParams.rows},\r\n      sort: { field: searchParams.sortField, order: searchParams.sortOrder == -1 ? 'Desc' : 'Asc' },\r\n      filter: _filter\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    provider.getList(parameters_table, params).then(d => {\r\n      setSelectedRecords(null);\r\n      setRecords({ ...d, page: searchParams.page });\r\n    }).catch(e => {\r\n      toast.current.show({life: 3000, severity: 'error', summary: 'Pesquisa de Sistemas de Coordenadas', detail: 'Ocorreu um erro ao realizar a pesquisa'});\r\n    }).finally(() => {\r\n      setLoading(false);\r\n    });\r\n  }\r\n\r\n  const onPage = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onSort = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onFilter = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    _searchParams['first'] = 0;\r\n    setSearchParams(_searchParams);    \r\n  }\r\n\r\n  const onFilterClear = (event) => {\r\n    setSearchParams({ ...initialSearchParams});    \r\n  }\r\n\r\n  const onSelectionChange = (event) => {\r\n    setSelectedRecords(event.value.filter(v => !v.read_only));\r\n  }\r\n\r\n  const leftToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Novo\" icon=\"pi pi-plus\" className=\"p-button-success p-mr-2\" onClick={newRecord} />\r\n            <Button label=\"Eliminar\" icon=\"pi pi-trash\" className=\"p-button-danger\" onClick={deleteSelectedRecords} disabled={!selectedRecords || !selectedRecords.length} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n      <React.Fragment>\r\n          <Button label=\"Limpar\" icon=\"pi pi-times\" className=\"p-button-help p-mr-2\" onClick={onFilterClear} />\r\n          {/*<Button label=\"Export\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} />*/}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    if (rowData.read_only) {\r\n      return (<Button icon=\"fas fa-lock\" className=\"p-button-rounded p-button-secondary\" disabled />);\r\n    } else {\r\n      return (\r\n          <React.Fragment>\r\n              <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success p-mr-2\" onClick={() => editRecord(rowData)} />\r\n              <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => deleteRecord(rowData)} />\r\n          </React.Fragment>\r\n      );\r\n    }\r\n  }\r\n    \r\n  const valueBodyTemplate = (rowData) => {\r\n    if ((rowData.setting_value || '') === '') return null;\r\n\r\n    return <Button label=\"Ver\" className=\"p-button-link\"  onClick={() => { setFieldValue(rowData.setting_value); setDisplayFieldValue(true); }} />\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"p-col-12\"><h3>Parâmetros</h3></div>\r\n\r\n      <div className=\"p-grid p-fluid viewer-list\">\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n          <div className=\"card\">\r\n            <Toolbar className=\"p-mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n            <DataTable ref={dt} value={records ? records.data : []} lazy\r\n                selectionMode=\"checkbox\"\r\n                selection={selectedRecords} onSelectionChange={onSelectionChange}\r\n                paginator first={searchParams.first} rows={searchParams.rows} totalRecords={records.total} onPage={onPage}\r\n                onSort={onSort} sortField={searchParams.sortField} sortOrder={searchParams.sortOrder}\r\n                filters={searchParams.filters} onFilter={onFilter} loading={loading}\r\n                emptyMessage=\"Não foram encontrados registos.\" >\r\n                <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n                <Column field=\"id\" header=\"Id\" sortable filter filterPlaceholder=\"Id\" headerStyle={{ width: '6rem' }} />\r\n                <Column field=\"code\" header=\"Código\" sortable filter filterPlaceholder=\"Código\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column field=\"name\" header=\"Nome\" sortable filter filterPlaceholder=\"Nome\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column field=\"notes\" header=\"Descrição\" sortable filter filterPlaceholder=\"Descrição\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column header=\"Valor\" body={valueBodyTemplate} headerStyle={{ width: '5rem' }} />\r\n                <Column body={actionBodyTemplate} style={{\"textAlign\": \"center\"}} />\r\n            </DataTable>\r\n            <Dialog header=\"Valor\" visible={displayFieldValue} style={{ width: '50vw' }} onHide={() => setDisplayFieldValue(false)}>\r\n              <div dangerouslySetInnerHTML={{__html: fieldValue }} />\r\n            </Dialog>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, auth: state.auth, filters: state.filters }))(withRouter(ParameterList));","import React, { useContext, useState, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { useForm } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { InputTextarea } from 'primereact/inputtextarea';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { classNames } from 'primereact/utils';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nfunction ParameterForm(props) {\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const parameters_table = props.parametersTable || 'site';\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [data, setData] = useState(props.data || {});\r\n\r\n  const [codeValue, setCodeValue] = useState('');\r\n\r\n  const toast = useRef(null);\r\n\r\n  const { core } = useContext(AppContext);  \r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {...data}\r\n  });\r\n\r\n  const goBack = () => {\r\n    const location = {\r\n      pathname: history.location.state.from,\r\n      state: { \r\n        searchParams: {...history.location.state.previousSearchParams}\r\n      }\r\n    }\r\n    history.replace(location);\r\n    //history.goBack();\r\n  }\r\n\r\n  const onSubmit = (formData) => {\r\n    const new_data = {\r\n      code: formData.code,\r\n      name: formData.name,\r\n      notes: formData.notes,\r\n      setting_value: formData.setting_value\r\n    }\r\n\r\n    setIsSaving(true);\r\n\r\n    const provider = dataProvider(API_URL + '/portal/settings');      \r\n    if (data.id) {\r\n      const params = {\r\n        id: data.id,\r\n        data: {...new_data}\r\n      }\r\n      provider.update(parameters_table, params).then(d => {       \r\n        toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });\r\n    } else {\r\n      const params = {\r\n        data: {...new_data}\r\n      }\r\n      provider.create(parameters_table, params).then(d => {\r\n        setData({...data, id: d.data.id});\r\n        toast.current.show({life: 5000, severity: 'success', summary: 'Criar Registo', detail: 'Registo criada com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Criar Registo', detail: 'Ocorreu um erro ao criar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });       \r\n    }\r\n  };\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      let msg;\r\n\r\n      if (errors[name].type === 'required') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Campo obrigatório'}</small>\r\n      } else if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">{errors[name].message || 'O número de caracteres é superior à dimensão máxima permitida'}</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Formato inválido'}</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n \r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n              type=\"button\" \r\n              label=\"Voltar\" \r\n              icon=\"pi pi-left\" \r\n              className=\"p-button-secondary p-mr-4\"\r\n              disabled={isSaving ? true : false} \r\n              onClick={goBack} />\r\n            <Button\r\n              type=\"submit\" \r\n              label=\"Gravar\"\r\n              icon={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n              disabled={isSaving ? true : false} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  return (\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n\r\n          <div className=\"p-fluid p-formgrid p-grid\">      \r\n            <div className=\"p-field p-col-12 p-md-2\">\r\n              <label htmlFor=\"id\">Id</label>\r\n              <InputText id=\"id\" type=\"text\" value={data.id || ''} disabled />\r\n            </div>              \r\n\r\n            <div className=\"p-field p-col-12 p-md-2\">\r\n              <label htmlFor=\"code\">Código</label>\r\n              <InputText id=\"code\" name=\"code\" {...register('code', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.code })} />\r\n              {getFormErrorMessage(errors, 'code')}\r\n            </div>           \r\n\r\n            <div className=\"p-field p-col-12 p-md-8\">\r\n              <label htmlFor=\"name\">Designação</label>        \r\n              <InputText id=\"name\" name=\"name\" {...register('name', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.name })} />\r\n              {getFormErrorMessage(errors, 'name')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-12\">\r\n              <label htmlFor=\"notes\">Descrição</label>        \r\n              <InputText id=\"notes\" name=\"notes\" {...register('notes')} autoFocus />\r\n              {getFormErrorMessage(errors, 'notes')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12\">\r\n              <label htmlFor=\"setting_value\">Valor</label>\r\n              <InputTextarea rows={5} id=\"notes\" name=\"setting_value\" {...register('setting_value', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.setting_value })} />\r\n              {getFormErrorMessage(errors, 'setting_value')}\r\n            </div>\r\n\r\n          </div>\r\n\r\n        <Toolbar className=\"p-mt-4 p-mb-4\" right={rightToolbarTemplate}></Toolbar>\r\n\r\n      </form>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(ParameterForm));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport ParameterForm from './ParameterForm';\r\n\r\nfunction ParameterEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const parameters_table = props.parametersTable || 'site';\r\n\r\n  const { id } = useParams();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [record, setRecord] = useState(null);\r\n  const [roles, setRoles] = useState([]);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/portal/settings');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setLoading(true);    \r\n\r\n    provider.getOne(parameters_table, params).then(d => {\r\n      const data = {\r\n        id: d.data?.id, code: d.data?.code, name: d.data?.name,  description: d.data?.description, \r\n        srid: d.data?.config_json?.srid, label: d.data?.config_json?.label, defs: d.data?.config_json?.defs,\r\n        minx: d.data?.config_json?.extent ? d.data?.config_json?.extent.split(' ')[0] : null,\r\n        miny: d.data?.config_json?.extent ? d.data?.config_json?.extent.split(' ')[1] : null,\r\n        maxx: d.data?.config_json?.extent ? d.data?.config_json?.extent.split(' ')[2] : null,\r\n        maxy: d.data?.config_json?.extent ? d.data?.config_json?.extent.split(' ')[3] : null,\r\n        precision: d.data?.config_json?.precision\r\n      }\r\n      setRecord(data);      \r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      console.log(e);\r\n      //toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n    { record ?      \r\n        <ParameterForm data={record} />\r\n      :\r\n      <div>loading...</div>\r\n    }\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(ParameterEdit));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect, useDispatch } from 'react-redux';\r\nimport { withRouter, Route, Link } from 'react-router-dom';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { Chip } from 'primereact/chip';\r\nimport { Dialog } from 'primereact/dialog';\r\nimport { confirmDialog } from 'primereact/confirmdialog';\r\nimport { Toast } from 'primereact/toast';\r\n\r\nimport AppContext from '../../../AppContext'\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\n\r\nconst initialSearchParams = {\r\n  filters: {},\r\n  first: 0,\r\n  rows: 20,\r\n  page: 0,\r\n  sortField: 'id',\r\n  sortOrder: 1\r\n};\r\n\r\n\r\nfunction CoordinateSystemList(props) {\r\n\r\n  const {\r\n    history\r\n  } = props;\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(false);  \r\n  const [records, setRecords] = useState([]);\r\n  const [selectedRecords, setSelectedRecords] = useState(null);\r\n  const [displayFieldValue, setDisplayFieldValue] = useState(false);\r\n  const [fieldValue, setFieldValue] = useState();\r\n\r\n  const [searchParams, setSearchParams] = useState({...initialSearchParams});\r\n\r\n  const loaded = useRef(false);\r\n  const dt = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (!loaded.current && history.location?.state?.searchParams) {\r\n      loaded.current = true;\r\n\r\n      const _searchParams = {...history.location.state.searchParams};\r\n      setSearchParams(_searchParams);\r\n    } else {\r\n      loadData();\r\n    }\r\n  }, [searchParams]); \r\n  \r\n  const newRecord = () => {\r\n    const location = {\r\n      pathname: '/settings/coordinate_systems/create',\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);   \r\n  }\r\n\r\n  const editRecord = (record) => {\r\n    const location = {\r\n      pathname: `/settings/coordinate_systems/edit/${record.id}`,\r\n      state: { \r\n        from: history.location.pathname,\r\n        previousSearchParams: {...searchParams}\r\n      }\r\n    }\r\n    history.push(location);\r\n  }\r\n\r\n  const deleteSelectedRecords = () => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o(s) registo(s) selecionado(s)?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal/lists');\r\n        const params = {\r\n          ids: selectedRecords.filter(v => !v.read_only).map(v => v.id)\r\n        }\r\n        provider.deleteMany('coordinate_systems', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo(s)', detail: 'Registo(s) eliminado(s) com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo(s)', detail: 'Ocorreu um erro ao eliminar o(s) registo(s)'}); \r\n        }).finally(() => {\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });   \r\n  }\r\n  \r\n  const deleteRecord = (record) => {\r\n    confirmDialog({\r\n      message: ' Deseja eliminar o registo selecionado?',\r\n      header: 'Confirmação',\r\n      icon: 'pi pi-exclamation-triangle',\r\n      acceptLabel: 'Sim',\r\n      rejectLabel: 'Não',\r\n      accept: () => {\r\n        const provider = dataProvider(API_URL + '/portal/lists');\r\n        const params = {\r\n          id: record.id\r\n        }      \r\n        provider.delete('coordinate_systems', params).then(d => {\r\n          toast.current.show({life: 3000, severity: 'success', summary: 'Eliminar Registo', detail: 'Registo eliminado com sucesso'});\r\n          loadData();          \r\n        }).catch(e => {\r\n          toast.current.show({life: 3000, severity: 'error', summary: 'Eliminar Registo', detail: 'Ocorreu um erro ao eliminar o registo'}); \r\n        }).finally(() => {\r\n          //console.log('finally');\r\n        });\r\n      },\r\n      reject: () =>  { }      \r\n    });\r\n  }  \r\n\r\n  const exportCSV = () => {\r\n    //TODO: implement export\r\n    //dt.current.exportCSV();\r\n  }\r\n\r\n  const loadData = (filters) => {\r\n    const provider = dataProvider(API_URL + '/portal/lists');\r\n  \r\n    const _filter = {};\r\n    if (filters) {\r\n      Object.entries(filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    } else if (searchParams.filters) {\r\n      Object.entries(searchParams.filters).forEach(([key, item]) => {\r\n        _filter[key] = item.value;\r\n      });\r\n    }\r\n\r\n    const params = {\r\n      pagination: { page: searchParams.page + 1, perPage: searchParams.rows},\r\n      sort: { field: searchParams.sortField, order: searchParams.sortOrder == -1 ? 'Desc' : 'Asc' },\r\n      filter: _filter\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    provider.getList('coordinate_systems', params).then(d => {\r\n      setSelectedRecords(null);\r\n      setRecords({ ...d, page: searchParams.page });\r\n    }).catch(e => {\r\n      toast.current.show({life: 3000, severity: 'error', summary: 'Pesquisa de Sistemas de Coordenadas', detail: 'Ocorreu um erro ao realizar a pesquisa'});\r\n    }).finally(() => {\r\n      setLoading(false);\r\n    });\r\n  }\r\n\r\n  const onPage = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onSort = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    setSearchParams(_searchParams);\r\n  }\r\n\r\n  const onFilter = (event) => {\r\n    let _searchParams = { ...searchParams, ...event };\r\n    _searchParams['first'] = 0;\r\n    setSearchParams(_searchParams);    \r\n  }\r\n\r\n  const onFilterClear = (event) => {\r\n    setSearchParams({ ...initialSearchParams});    \r\n  }\r\n\r\n  const onSelectionChange = (event) => {\r\n    setSelectedRecords(event.value.filter(v => !v.read_only));\r\n  }  \r\n\r\n  const keywordsTemplate = (rowData) => {\r\n    return (\r\n        <React.Fragment>\r\n          { rowData.keywords && rowData.keywords.map( (item) => <Chip label={item} className=\"p-mr-2 p-mb-2\" /> ) }\r\n        </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const leftToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button label=\"Novo\" icon=\"pi pi-plus\" className=\"p-button-success p-mr-2\" onClick={newRecord} />\r\n            <Button label=\"Eliminar\" icon=\"pi pi-trash\" className=\"p-button-danger\" onClick={deleteSelectedRecords} disabled={!selectedRecords || !selectedRecords.length} />\r\n        </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n      <React.Fragment>\r\n          <Button label=\"Limpar\" icon=\"pi pi-times\" className=\"p-button-help p-mr-2\" onClick={onFilterClear} />\r\n          {/*<Button label=\"Export\" icon=\"pi pi-upload\" className=\"p-button-help\" onClick={exportCSV} />*/}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  const actionBodyTemplate = (rowData) => {\r\n    if (rowData.read_only) {\r\n      return (<Button icon=\"fas fa-lock\" className=\"p-button-rounded p-button-secondary\" disabled />);\r\n    } else {    \r\n      return (\r\n          <React.Fragment>\r\n              <Button icon=\"pi pi-pencil\" className=\"p-button-rounded p-button-success p-mr-2\" onClick={() => editRecord(rowData)} />\r\n              <Button icon=\"pi pi-trash\" className=\"p-button-rounded p-button-warning\" onClick={() => deleteRecord(rowData)} />\r\n          </React.Fragment>\r\n      );\r\n    }\r\n  }\r\n    \r\n  const configBodyTemplate = (rowData) => {\r\n    if ((rowData?.config_json?.defs || '') === '') return null;\r\n\r\n    return <Button label=\"Ver\" className=\"p-button-link\"  onClick={() => { setFieldValue(rowData?.config_json?.defs); setDisplayFieldValue(true); }} />    \r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"p-col-12\"><h3>Sistemas de Coordenadas</h3></div>\r\n\r\n      <div className=\"p-grid p-fluid viewer-list\">\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n          <div className=\"card\">\r\n            <Toolbar className=\"p-mb-4\" left={leftToolbarTemplate} right={rightToolbarTemplate}></Toolbar>\r\n\r\n            <DataTable ref={dt} value={records ? records.data : []} lazy\r\n                selectionMode=\"checkbox\"\r\n                selection={selectedRecords} onSelectionChange={onSelectionChange}\r\n                paginator first={searchParams.first} rows={searchParams.rows} totalRecords={records.total} onPage={onPage}\r\n                onSort={onSort} sortField={searchParams.sortField} sortOrder={searchParams.sortOrder}\r\n                filters={searchParams.filters} onFilter={onFilter} loading={loading}\r\n                emptyMessage=\"Não foram encontrados registos.\" >\r\n                <Column selectionMode=\"multiple\" headerStyle={{ width: '3rem' }} />\r\n                <Column field=\"id\" header=\"Id\" sortable filter filterPlaceholder=\"Id\" />\r\n                <Column field=\"code\" header=\"Código\" sortable filter filterPlaceholder=\"Código\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column field=\"name\" header=\"Nome\" sortable filter filterPlaceholder=\"Nome\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column field=\"description\" header=\"Descrição\" sortable filter filterPlaceholder=\"Descrição\" style={{\"wordBreak\": \"break-all\"}} />\r\n                <Column header=\"Definição\" body={configBodyTemplate} headerStyle={{ width: '5rem' }} />\r\n                <Column body={actionBodyTemplate} style={{\"textAlign\": \"center\"}} />\r\n            </DataTable>\r\n            <Dialog header=\"Definição\" visible={displayFieldValue} style={{ width: '50vw' }} onHide={() => setDisplayFieldValue(false)}>\r\n              <div dangerouslySetInnerHTML={{__html: fieldValue }} />\r\n            </Dialog>            \r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({ loading: state.loading, auth: state.auth, filters: state.filters }))(withRouter(CoordinateSystemList));","import React, { useContext, useState, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Toast } from 'primereact/toast';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport { Toolbar } from 'primereact/toolbar';\r\nimport { Button } from 'primereact/button';\r\nimport { Dropdown } from 'primereact/dropdown';\r\nimport { classNames } from 'primereact/utils';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nfunction CoordinateSystemForm(props) {\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const [data, setData] = useState(props.data || {});\r\n\r\n  const toast = useRef(null);\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  const { register, control, handleSubmit, watch, formState: { errors }, setValue } = useForm({\r\n    defaultValues: {...data}\r\n  });\r\n\r\n  const goBack = () => {\r\n    const location = {\r\n      pathname: history.location.state.from,\r\n      state: { \r\n        searchParams: {...history.location.state.previousSearchParams}\r\n      }\r\n    }\r\n    history.replace(location);\r\n    //history.goBack();\r\n  }\r\n\r\n  const onSubmit = (formData) => {\r\n    const new_data = {\r\n      code: formData.code,\r\n      name: formData.name,\r\n      description: formData.description,\r\n      config_json: {\r\n        code: formData.code,\r\n        defs: formData.defs,\r\n        description: formData.description,\r\n        extent: `${formData.minx} ${formData.miny} ${formData.maxx} ${formData.maxy}`,\r\n        precision: formData.precision,\r\n        srid: formData.srid,\r\n        title: formData.name,\r\n        label: formData.label\r\n      }\r\n    }\r\n\r\n    setIsSaving(true);\r\n\r\n    const provider = dataProvider(API_URL + '/portal/lists');      \r\n    if (data.id) {\r\n      const params = {\r\n        id: data.id,\r\n        data: {...new_data}\r\n      }\r\n      provider.update('coordinate_systems', params).then(d => {       \r\n        toast.current.show({life: 3000, severity: 'success', summary: 'Editar Registo', detail: 'Registo alterado com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 3000, severity: 'error', summary: 'Editar Registo', detail: 'Ocorreu um erro ao alterar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });\r\n    } else {\r\n      const params = {\r\n        data: {...new_data}\r\n      }\r\n      provider.create('coordinate_systems', params).then(d => {\r\n        setData({...data, id: d.data.id});\r\n        toast.current.show({life: 5000, severity: 'success', summary: 'Criar Registo', detail: 'Registo criada com sucesso'});\r\n      }).catch(e => {\r\n        toast.current.show({life: 5000, severity: 'error', summary: 'Criar Registo', detail: 'Ocorreu um erro ao criar o registo'});\r\n      }).finally(() => {\r\n        setIsSaving(false);\r\n      });       \r\n    }\r\n\r\n    \r\n    //setShowMessage(true);\r\n\r\n    //reset();\r\n  };\r\n\r\n  const getFormErrorMessage = (errors, name) => {\r\n    if (errors && errors[name]) {\r\n      let msg;\r\n\r\n      if (errors[name].type === 'required') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Campo obrigatório'}</small>\r\n      } else if (errors[name].type === 'maxLength') {\r\n         return <small className=\"p-error\">{errors[name].message || 'O número de caracteres é superior à dimensão máxima permitida'}</small>\r\n      } else if (errors[name].type === 'pattern') {\r\n        return <small className=\"p-error\">{errors[name].message || 'Formato inválido'}</small>\r\n      } else {\r\n        return <small className=\"p-error\">{errors[name].message}</small>\r\n      }\r\n    }      \r\n  };  \r\n \r\n  const rightToolbarTemplate = () => {\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n              type=\"button\" \r\n              label=\"Voltar\" \r\n              icon=\"pi pi-left\" \r\n              className=\"p-button-secondary p-mr-4\"\r\n              disabled={isSaving ? true : false} \r\n              onClick={goBack} />\r\n            <Button\r\n              type=\"submit\" \r\n              label=\"Gravar\"\r\n              icon={isSaving ? \"pi pi-save pi-spinner\" : \"pi pi-save\" }\r\n              disabled={isSaving ? true : false} />\r\n        </React.Fragment>\r\n    )\r\n  }\r\n\r\n  return (\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n          <Toast ref={toast} baseZIndex={2000} />\r\n\r\n          <div className=\"p-fluid p-formgrid p-grid\">      \r\n            <div className=\"p-field p-col-12 p-md-2\">\r\n              <label htmlFor=\"id\">Id</label>\r\n              <InputText id=\"id\" type=\"text\" value={data.id || ''} disabled />\r\n            </div>              \r\n\r\n            <div className=\"p-field p-col-12 p-md-2\">\r\n              <label htmlFor=\"code\">Código</label>\r\n              <InputText id=\"code\" name=\"code\" {...register('code', { required: 'Campo obrigatório.' })} autoFocus className={classNames({ 'p-invalid': errors.code })} />\r\n              {getFormErrorMessage(errors, 'code')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-2\">\r\n              <label htmlFor=\"srid\">SRID</label>\r\n              <InputText id=\"srid\" name=\"srid\" {...register('srid', { required: true, pattern: { value: /^[0-9]+$/, message: 'Formato inválido'} })}\r\n                autoFocus className={classNames({ 'p-invalid': errors.srid })} />\r\n              {getFormErrorMessage(errors, 'srid')}\r\n            </div>            \r\n\r\n            <div className=\"p-field p-col-12 p-md-6\">\r\n              <label htmlFor=\"name\">Designação</label>        \r\n              <InputText id=\"name\" name=\"name\" {...register('name', { required: 'This is required.' })} autoFocus className={classNames({ 'p-invalid': errors.name })} />\r\n              {getFormErrorMessage(errors, 'name')}\r\n            </div>\r\n            \r\n            <div className=\"p-field p-col-12 p-md-4\">\r\n              <label htmlFor=\"label\">Label</label>        \r\n              <InputText id=\"label\" name=\"label\" {...register('label')} autoFocus className={classNames({ 'p-invalid': errors.label })} />\r\n              {getFormErrorMessage(errors, 'label')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-8\">\r\n              <label htmlFor=\"description\">Descrição</label>        \r\n              <InputText id=\"description\" name=\"description\" {...register('description', { required: 'This is required.' })} autoFocus className={classNames({ 'p-invalid': errors.description })} />\r\n              {getFormErrorMessage(errors, 'description')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12\">\r\n              <label htmlFor=\"defs\">Definição</label>        \r\n              <InputText id=\"defs\" name=\"defs\" {...register('defs')} autoFocus />\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-3\">\r\n              <label htmlFor=\"minx\">Min X</label>\r\n              <InputText id=\"minx\" name=\"minx\" {...register('minx', { required: 'Campo obrigatório.', \r\n                pattern: { value: /^[+-]?((\\d+(\\.\\d*)?)|(\\.\\d+))$/, message: 'Formato inválido'},\r\n                min: -180, max: 180 } )} \r\n                autoFocus className={classNames({ 'p-invalid': errors.minx })} />\r\n              {getFormErrorMessage(errors, 'minx')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-3\">\r\n              <label htmlFor=\"miny\">Min Y</label>\r\n              <InputText id=\"miny\" name=\"minx\" {...register('miny', { required: 'Campo obrigatório.', \r\n                pattern: { value: /^[+-]?((\\d+(\\.\\d*)?)|(\\.\\d+))$/, message: 'Formato inválido'},\r\n                min: -90, max: 90 } )}\r\n                autoFocus className={classNames({ 'p-invalid': errors.miny })} />\r\n              {getFormErrorMessage(errors, 'miny')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-3\">\r\n              <label htmlFor=\"maxx\">Max X</label>        \r\n              <InputText id=\"maxx\" name=\"maxx\" {...register('maxx', { required: 'Campo obrigatório.', \r\n                pattern: { value: /^[+-]?((\\d+(\\.\\d*)?)|(\\.\\d+))$/, message: 'Formato inválido'} })} \r\n                autoFocus className={classNames({ 'p-invalid': errors.maxx })} />\r\n              {getFormErrorMessage(errors, 'maxx')}\r\n            </div>\r\n\r\n            <div className=\"p-field p-col-12 p-md-3\">\r\n              <label htmlFor=\"maxy\">Max Y</label>        \r\n              <InputText id=\"maxy\" name=\"minx\" {...register('maxy', { required: 'Campo obrigatório.', \r\n                pattern: { value: /^[+-]?((\\d+(\\.\\d*)?)|(\\.\\d+))$/, message: 'Formato inválido'} })} \r\n                autoFocus className={classNames({ 'p-invalid': errors.maxy })} />\r\n              {getFormErrorMessage(errors, 'maxy')}\r\n            </div>\r\n\r\n            {/*\r\n            <div className=\"p-field p-col-12 p-md-3\">\r\n              <label htmlFor=\"precision\">Precisão</label>        \r\n              <InputText id=\"precision\" name=\"precision\" {...register('precision', { required: true,\r\n                pattern: { value: /^[0-9]+$/, message: 'Formato inválido'} })}\r\n                autoFocus className={classNames({ 'p-invalid': errors.precision })} />\r\n              {getFormErrorMessage(errors, 'precision')}\r\n            </div>\r\n            */}\r\n\r\n            <div className=\"p-field p-col-12 p-md-3\">\r\n              <label htmlFor=\"precision\">Precisão</label>\r\n              <Controller name=\"precision\" control={control} render={(props) => (\r\n                <Dropdown  id=\"precision\" value={props.field.value} \r\n                  options={[0,1,2,3,4,5,6,7,8,9,10].map(val => {\r\n                    return {\r\n                      label: (val + ' casas decimais'),\r\n                      value: Math.pow(10, (val))\r\n                      }\r\n                  })}\r\n                  onChange={(e) => props.field.onChange(e.value)}\r\n                  showClear\r\n                  className={classNames({ 'p-invalid': errors.precision })} />                    \r\n              )} />\r\n            </div>            \r\n\r\n          </div>\r\n\r\n        <Toolbar className=\"p-mt-4 p-mb-4\" right={rightToolbarTemplate}></Toolbar>\r\n\r\n      </form>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(CoordinateSystemForm));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, useParams } from 'react-router-dom';\r\n\r\nimport AppContext from '../../../AppContext';\r\nimport dataProvider from '../../../service/DataProvider';\r\n\r\nimport CoordinateSystemForm from './CoordinateSystemForm';\r\n\r\nfunction CoordinateSystemEdit(props) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const {\r\n    history,\r\n    dispatch\r\n  } = props;\r\n\r\n  const { id } = useParams();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [record, setRecord] = useState(null);\r\n  const [roles, setRoles] = useState([]);\r\n\r\n  const toast = useRef(null);\r\n\r\n  const API_URL = core.API_URL;\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      loadData();\r\n    } else {\r\n      setRecord({});\r\n    }\r\n  }, []);\r\n\r\n  const loadData = () => {\r\n    const provider = dataProvider(API_URL + '/portal/lists');\r\n\r\n    const params = {\r\n      id: id\r\n    }\r\n\r\n    setLoading(true);    \r\n\r\n    provider.getOne('coordinate_systems', params).then(d => {\r\n      const data = {\r\n        id: d.data?.id, code: d.data?.code, name: d.data?.name,  description: d.data?.description, \r\n        srid: d.data?.config_json?.srid, label: d.data?.config_json?.label, defs: d.data?.config_json?.defs,\r\n        minx: d.data?.config_json?.extent ? d.data?.config_json?.extent.split(' ')[0] : null,\r\n        miny: d.data?.config_json?.extent ? d.data?.config_json?.extent.split(' ')[1] : null,\r\n        maxx: d.data?.config_json?.extent ? d.data?.config_json?.extent.split(' ')[2] : null,\r\n        maxy: d.data?.config_json?.extent ? d.data?.config_json?.extent.split(' ')[3] : null,\r\n        precision: d.data?.config_json?.precision\r\n      }\r\n      setRecord(data);      \r\n      setLoading(false);\r\n    }).catch(e => {\r\n      setLoading(false);\r\n      console.log(e);\r\n      //toast.current.show({life: 5000, severity: 'error', summary: 'Pesquisa de Visualizadores', detail: 'Ocorreu um erro na pesquisa de intervenções'});\r\n    });\r\n  }  \r\n\r\n  return (\r\n    <React.Fragment>\r\n    { record ?      \r\n        <CoordinateSystemForm data={record} />\r\n      :\r\n      <div>loading...</div>\r\n    }\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\nexport default connect(state => ({}))(withRouter(CoordinateSystemEdit));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect, useDispatch } from 'react-redux';\r\nimport classNames from 'classnames';\r\nimport { withRouter, Route, useHistory } from 'react-router-dom';\r\nimport { CSSTransition } from 'react-transition-group';\r\n\r\nimport { AppTopbar } from './AppTopbar';\r\nimport { AppFooter } from './AppFooter';\r\nimport { AppMenu } from './AppMenu';\r\nimport { AppProfile } from './AppProfile';\r\nimport { AppConfig } from './AppConfig';\r\n\r\n//import { Dashboard } from './Dashboard';\r\nimport Dashboard from './Dashboard';\r\n\r\nimport AccountEdit from './account/AccountEdit';\r\n\r\nimport ModuleManager from './ModuleManager';\r\n\r\nimport NotificationEdit from './notifications/NotificationEdit';\r\nimport NotificationList from './notifications/NotificationList';\r\n\r\nimport ViewerEdit from './viewers/ViewerEdit';\r\nimport ViewerList from './viewers/ViewerList';\r\n\r\nimport PrintEdit from './prints/PrintEdit';\r\nimport PrintList from './prints/PrintList';\r\nimport PrintGroupEdit from './prints/PrintGroupEdit';\r\nimport PrintGroupList from './prints/PrintGroupList';\r\nimport PrintElementEdit from './prints/PrintElementEdit';\r\nimport PrintElementList from './prints/PrintElementList';\r\n\r\nimport UserList from './security/UserList';\r\nimport UserEdit from './security/UserEdit';\r\n\r\nimport RoleList from './security/RoleList';\r\nimport RoleEdit from './security/RoleEdit';\r\n\r\nimport GroupList from './security/GroupList';\r\nimport GroupEdit from './security/GroupEdit';\r\n\r\nimport ParameterList from './settings/ParameterList';\r\nimport ParameterEdit from './settings/ParameterEdit';\r\n\r\nimport CoordinateSystemList from './settings/CoordinateSystemList';\r\nimport CoordinateSystemEdit from './settings/CoordinateSystemEdit';\r\n\r\nimport PrimeReact from 'primereact/api';\r\n\r\nimport 'primereact/resources/themes/saga-blue/theme.css';\r\nimport 'primereact/resources/primereact.min.css';\r\nimport 'primeicons/primeicons.css';\r\nimport 'primeflex/primeflex.css';\r\nimport 'prismjs/themes/prism-coy.css';\r\nimport '@fullcalendar/core/main.css';\r\nimport '@fullcalendar/daygrid/main.css';\r\nimport '@fullcalendar/timegrid/main.css';\r\nimport '../../layout/flags/flags.css';\r\nimport '../../layout/layout.scss';\r\nimport './App.scss';\r\n\r\nfunction Layout(props) {\r\n\r\n  const {\r\n    core,\r\n    history,\r\n    dispatch,\r\n    backoffice,\r\n    sidebar,\r\n    onWrapperClick,\r\n    onSidebarClick,\r\n    onToggleMenu,\r\n    onLayoutModeChange,\r\n    onLayoutColorModeChange\r\n  } = props;\r\n\r\n  const { CLIENT_URL } = core;\r\n\r\n  const [inputStyle, setInputStyle] = useState('outlined');\r\n  const [ripple, setRipple] = useState(false);\r\n\r\n  const entityName = process.env.REACT_APP_ENTITY_NAME || 'Direção-Geral do Território';\r\n\r\n  //const logo = layoutColorMode === 'dark' ? 'assets/layout/images/logo-white.svg' : 'assets/layout/images/logo.svg';\r\n  const logo = backoffice.layoutColorMode === 'dark' ? \r\n    CLIENT_URL + 'assets/images/logo-light.png':\r\n    CLIENT_URL + 'assets/images/logo.png';\r\n\r\n  /*\r\n  const wrapperClass = classNames('layout-wrapper', {\r\n      'layout-overlay': layoutMode === 'overlay',\r\n      'layout-static': layoutMode === 'static',\r\n      'layout-static-sidebar-inactive': staticMenuInactive && layoutMode === 'static',\r\n      'layout-overlay-sidebar-active': overlayMenuActive && layoutMode === 'overlay',\r\n      'layout-mobile-sidebar-active': mobileMenuActive,\r\n      'p-input-filled': inputStyle === 'filled',\r\n      'p-ripple-disabled': ripple === false\r\n  });\r\n  const sidebarClassName = classNames('layout-sidebar', {\r\n      'layout-sidebar-dark': layoutColorMode === 'dark',\r\n      'layout-sidebar-light': layoutColorMode === 'light'\r\n  });\r\n  */\r\n  const wrapperClass = classNames('layout-wrapper', {\r\n    'layout-overlay': backoffice.layoutMode === 'overlay',\r\n    'layout-static': backoffice.layoutMode === 'static',\r\n    'layout-static-sidebar-inactive': backoffice.staticMenuInactive && backoffice.layoutMode === 'static',\r\n    'layout-overlay-sidebar-active': backoffice.overlayMenuActive && backoffice.layoutMode === 'overlay',\r\n    'layout-mobile-sidebar-active': backoffice.mobileMenuActive,\r\n    'p-input-filled': inputStyle === 'filled',\r\n    'p-ripple-disabled': ripple === false    \r\n  });\r\n\r\n  const sidebarClassName = classNames(\"layout-sidebar\", {\r\n    'layout-sidebar-dark': backoffice.layoutColorMode === 'dark',\r\n    'layout-sidebar-light': backoffice.layoutColorMode === 'light'\r\n  });\r\n\r\n  /*-----------------------------------------------------*/\r\n\r\n  const isDesktop = () => {\r\n      return window.innerWidth > 1024;\r\n  }\r\n\r\n  const isSidebarVisible = () => {\r\n      if (isDesktop()) {\r\n          //if (layoutMode === 'static')\r\n          if (backoffice.layoutMode === 'static')\r\n              //return !staticMenuInactive;\r\n              return !backoffice.staticMenuInactive\r\n          //else if (layoutMode === 'overlay')\r\n          else if (backoffice.layoutMode === 'overlay')\r\n              //return overlayMenuActive;\r\n              return backoffice.overlayMenuActive\r\n          else\r\n              return true;\r\n      }\r\n\r\n      return true;\r\n  }\r\n\r\n  const onMenuItemClick = (event) => {\r\n      if (!event.item.items) {\r\n          //setOverlayMenuActive(false);\r\n          //setMobileMenuActive(false);\r\n      }\r\n  }\r\n\r\n  const onInputStyleChange = (inputStyle) => {\r\n      setInputStyle(inputStyle);\r\n  }\r\n\r\n  const onRipple = (e) => {\r\n      PrimeReact.ripple = e.value;\r\n      setRipple(e.value)\r\n  }\r\n\r\n  let menu = [];\r\n  if (backoffice && backoffice.config_json && backoffice.config_json.menu) {\r\n      menu = backoffice.config_json.menu;\r\n  }\r\n\r\n  return (\r\n\r\n    <div className={wrapperClass} onClick={onWrapperClick}>\r\n        <AppTopbar onToggleMenu={onToggleMenu} />\r\n\r\n        <CSSTransition classNames=\"layout-sidebar\" timeout={{ enter: 200, exit: 200 }} in={isSidebarVisible()} unmountOnExit>\r\n            <div ref={sidebar} className={sidebarClassName} onClick={onSidebarClick}>\r\n                <div className=\"layout-logo\" style={{cursor: 'pointer'}} onClick={() => history.push('/')}>\r\n                    <img alt=\"Logo\" src={logo} />\r\n                </div>\r\n                <AppProfile core={props.core} dispatch={props.dispatch} auth={props.auth} />\r\n                <AppMenu model={menu} onMenuItemClick={onMenuItemClick} />\r\n            </div>\r\n        </CSSTransition>\r\n\r\n        {/*<AppConfig rippleEffect={ripple} onRippleEffect={onRipple} inputStyle={inputStyle} onInputStyleChange={onInputStyleChange}\r\n            layoutMode={backoffice.layoutMode} onLayoutModeChange={onLayoutModeChange} layoutColorMode={backoffice.layoutColorMode} onColorModeChange={onLayoutColorModeChange} />*/}\r\n\r\n        <div className=\"layout-main\">\r\n\r\n            <Route path=\"/account\" component={AccountEdit} />\r\n\r\n            <Route path=\"/notifications/edit/:id\" component={NotificationEdit} />\r\n            <Route path=\"/notifications/list\" render={(props) => (\r\n                <NotificationList {...props} />\r\n            )} />\r\n\r\n            <Route path=\"/\" exact component={Dashboard} />\r\n            <Route path=\"/dashboard\" exact component={Dashboard} />\r\n\r\n            <Route path=\"/viewers/create\" component={ViewerEdit} />\r\n            <Route path=\"/viewers/edit/:id\" component={ViewerEdit} />\r\n            <Route path=\"/viewers/list\" render={(props) => (\r\n                <ViewerList {...props} />\r\n            )} />\r\n\r\n            <Route path=\"/prints/create\" component={PrintEdit} />\r\n            <Route path=\"/prints/edit/:id\" component={PrintEdit} />\r\n            <Route path=\"/prints/list\" render={(props) => (\r\n                <PrintList {...props}  />\r\n            )} />\r\n            <Route path=\"/prints/groups/create\" component={PrintGroupEdit} />\r\n            <Route path=\"/prints/groups/edit/:id\" component={PrintGroupEdit} />         \r\n            <Route path=\"/prints/groups/list\" render={(props) => (\r\n                <PrintGroupList {...props}  />\r\n            )} />             \r\n            <Route path=\"/prints/elements/create\" component={PrintElementEdit} />\r\n            <Route path=\"/prints/elements/edit/:id\" component={PrintElementEdit} />            \r\n            <Route path=\"/prints/elements/list\" render={(props) => (\r\n                <PrintElementList {...props} />\r\n            )} />                      \r\n\r\n            <Route path=\"/modules/:id\" render={(props) => { return (\r\n                <ModuleManager {...props} core={core} module={props.match.params.id} />\r\n            )}} />          \r\n\r\n            <Route path=\"/security/users/create\" component={UserEdit}  />\r\n            <Route path=\"/security/users/edit/:id\" component={UserEdit} />             \r\n            <Route path=\"/security/users/list\" render={(props) => (\r\n                <UserList {...props} />\r\n            )} />\r\n            <Route path=\"/security/roles/create\" component={RoleEdit}  />\r\n            <Route path=\"/security/roles/edit/:id\" component={RoleEdit} />                \r\n            <Route path=\"/security/roles/list\" render={(props) => (\r\n                <RoleList {...props} />\r\n            )} />\r\n            <Route path=\"/security/groups/create\" component={GroupEdit}  />\r\n            <Route path=\"/security/groups/edit/:id\" component={GroupEdit} />                \r\n            <Route path=\"/security/groups/list\" render={(props) => (\r\n                <GroupList {...props} />\r\n            )} />             \r\n            <Route path=\"/settings/parameters/create\" component={ParameterEdit}  />\r\n            <Route path=\"/settings/parameters/edit/:id\" component={ParameterEdit} />            \r\n            <Route path=\"/settings/parameters/list\" render={(props) => (\r\n                <ParameterList {...props} parametersTable='site' />\r\n            )} />             \r\n            <Route path=\"/settings/coordinate_systems/create\" component={CoordinateSystemEdit}  />\r\n            <Route path=\"/settings/coordinate_systems/edit/:id\" component={CoordinateSystemEdit} />\r\n            <Route path=\"/settings/coordinate_systems/list\" render={(props) => (\r\n                <CoordinateSystemList {...props} />\r\n            )} />            \r\n        </div>\r\n\r\n        <AppFooter />\r\n\r\n    </div>\r\n\r\n  );\r\n\r\n}\r\n\r\nexport default Layout;","import React, { useRef, useState, useEffect } from 'react'\r\nimport LayoutComponent from '../components/Layout'\r\nimport { connect } from 'react-redux'\r\nimport { withRouter, Route, useHistory } from 'react-router-dom';\r\n\r\nfunction Layout(props) {\r\n\r\n  const { history, backoffice, layout_toggle_menu, layout_wrapper_click, layout_set_mode, layout_set_colormode } = props;\r\n  let sidebar = useRef(null);\r\n  let menuClick = useRef(false);\r\n\r\n  const addClass = (element, className) => {\r\n    if (element.classList)\r\n        element.classList.add(className);\r\n    else\r\n        element.className += ' ' + className;\r\n  }\r\n\r\n  const removeClass = (element, className) => {\r\n    if (element.classList)\r\n        element.classList.remove(className);\r\n    else\r\n        element.className = element.className.replace(new RegExp('(^|\\\\b)' + className.split(' ').join('|') + '(\\\\b|$)', 'gi'), ' ');\r\n  }\r\n\r\n  const isDesktop = () => {\r\n      return window.innerWidth > 1024;\r\n  }\r\n\r\n  const onWrapperClick = (event) => {\r\n      /*\r\n      if (!menuClick.current) {\r\n          setOverlayMenuActive(false);\r\n          setMobileMenuActive(false);\r\n      }\r\n      menuClick.current = false;\r\n      */\r\n    if (!menuClick.current) layout_wrapper_click();\r\n    menuClick.current = false;      \r\n  }\r\n\r\n  const onSidebarClick = () => {\r\n    menuClick.current = true;\r\n  }\r\n\r\n  const onToggleMenu = (event) => {\r\n    /*\r\n    menuClick.current = true;\r\n\r\n    if (isDesktop()) {\r\n        if (layoutMode === 'overlay') {\r\n            setOverlayMenuActive(prevState => !prevState);\r\n        }\r\n        else if (layoutMode === 'static') {\r\n            setStaticMenuInactive(prevState => !prevState);\r\n        }\r\n    }\r\n    else {\r\n        setMobileMenuActive(prevState => !prevState);\r\n    }\r\n    event.preventDefault();\r\n    */\r\n    event.preventDefault();\r\n    menuClick.current = true;\r\n    layout_toggle_menu(isDesktop());      \r\n  }\r\n\r\n  const onLayoutModeChange = (mode) => {\r\n      layout_set_mode(mode);\r\n  }\r\n\r\n  const onLayoutColorModeChange = (mode) => {\r\n      layout_set_colormode(mode);\r\n  }  \r\n\r\n  return (\r\n    <LayoutComponent\r\n      { ...props }\r\n      sidebar={sidebar}\r\n      onWrapperClick={onWrapperClick}\r\n      onSidebarClick={onSidebarClick}\r\n      onToggleMenu={onToggleMenu}\r\n      onLayoutModeChange={onLayoutModeChange}\r\n      onLayoutColorModeChange={onLayoutColorModeChange}\r\n    />\r\n  )\r\n}\r\n\r\nexport default connect(state => ({ backoffice: state.backoffice, auth: state.auth }))(withRouter(Layout));","import React, { useContext, useState, useEffect, useRef } from 'react';\r\nimport { connect, useDispatch } from 'react-redux';\r\nimport Layout from './Layout';\r\n//import { HashRouter,  BrowserRouter as Router, Route, useHistory } from 'react-router-dom';\r\nimport { withRouter, Route, useHistory } from 'react-router-dom';\r\nimport AppContext from '../../AppContext';\r\n\r\n/**\r\n * Backoffice layout container\r\n * @param {Object} props \r\n */\r\nfunction Backoffice(props) {\r\n\r\n  // Get router props\r\n  const { url } = props.match;\r\n  const { id } = props.match.params;\r\n\r\n  const { history, dispatch, loading, backoffice, config } = props;\r\n  //const history = useHistory();\r\n\r\n  // Enable redux actions\r\n  //const dispatch = useDispatch();\r\n  const { core } = useContext(AppContext);\r\n  const { backoffice_load, layout_wrapper_click, layout_toggle_menu, layout_set_mode, \r\n    layout_set_colormode } = core.actions;   \r\n\r\n  // Get config\r\n  React.useEffect(() => {\r\n    dispatch(backoffice_load(core, history, true));\r\n  }, []);\r\n\r\n  // TODO: improve loading UI\r\n  if (loading) return null;\r\n\r\n  return (\r\n    <Layout\r\n      history={history}\r\n      core={core}\r\n      backoffice={backoffice}\r\n      layout_wrapper_click={e => dispatch(layout_wrapper_click())}\r\n      layout_toggle_menu={isDesktop => dispatch(layout_toggle_menu(isDesktop))}\r\n      layout_set_mode={layoutMode => dispatch(layout_set_mode(layoutMode))}\r\n      layout_set_colormode={layoutColorMode => dispatch(layout_set_colormode(layoutColorMode))}\r\n    />\r\n  );\r\n}\r\n\r\nexport default connect(state => ({ backoffice: state.backoffice }))(withRouter(Backoffice));","import React from 'react'\r\nimport { Button } from 'primereact/button';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nfunction Page404({ history }) {\r\n  return (\r\n    <div className=\"p-d-flex p-jc-center\" style={{ height: '100%' }}>\r\n      <div className=\"p-as-center\" style={{ backgroundColor: 'white', padding: '6rem' }}>\r\n        <h1>Ops...</h1>\r\n        <p>O visualizador pedido não existe.</p>\r\n        <p>Clique para voltar a página inicial</p>\r\n        <p>\r\n          <Button label=\"Página Inicial\" onClick={e => history.push({ pathname: \"/\" })}></Button>\r\n        </p>\r\n      </div>\r\n  </div>\r\n  )\r\n}\r\n\r\nexport default withRouter(Page404);","import React from 'react'\r\nimport { Button } from 'primereact/button';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nfunction Page401({ history }) {\r\n  return (\r\n    <div className=\"p-d-flex p-jc-center\" style={{ height: '100%' }}>\r\n      <div className=\"p-as-center\" style={{ backgroundColor: 'white', padding: '6rem' }}>\r\n        <h1>Ops...</h1>\r\n        <p>Não está autorizado a aceder ao visualizador pedido.</p>\r\n        <p>Clique para voltar a página inicial ou clique para efetuar login</p>\r\n        <p>\r\n          <Button label=\"Página Inicial\" onClick={e => history.push({ pathname: \"/\" })}></Button>{' '}\r\n          <Button label=\"Entrar\" onClick={e => history.push({ pathname: \"/login\" })}></Button>\r\n        </p>\r\n      </div>\r\n  </div>\r\n  )\r\n}\r\n\r\nexport default withRouter(Page401);","import React, { useContext, useState } from 'react'\r\nimport Cookies from 'universal-cookie'\r\nimport { InputText } from 'primereact/inputtext'\r\nimport { Password } from 'primereact/password'\r\nimport { Button } from 'primereact/button'\r\nimport { connect, useDispatch } from 'react-redux'\r\nimport AppContext from '../../AppContext'\r\nimport { Message } from 'primereact/message'\r\n\r\nconst cookies = new Cookies();\r\n\r\nfunction LoginWidget({ auth, history, redirect }) {\r\n\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  \r\n  // Enable redux actions\r\n  const dispatch = useDispatch();\r\n  const { core } = useContext(AppContext);\r\n  const { login_post, logout } = core.actions;\r\n\r\n  const cookieAuthName = core.COOKIE_AUTH_NAME;\r\n\r\n  const cookieData = cookies.get(cookieAuthName);\r\n  \r\n  // Render user\r\n  if (cookieData) {\r\n    const { username } = cookieData;\r\n    return (\r\n      <div>\r\n        <p>Olá { username }.</p>\r\n        <p>\r\n          Clique para \r\n          <Button\r\n            className=\"p-button-link\" onClick={e => dispatch(logout())}\r\n            label=\"terminar sessão\"\r\n          />.\r\n        </p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  function submit(e) {\r\n    e.preventDefault();\r\n    dispatch(login_post({ username, password }, history, redirect))\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={e => submit()}>\r\n\r\n      <div className=\"p-fluid\">\r\n\r\n        <div className=\"p-field p-grid\">\r\n          <label className=\"p-col-12 p-md-4\">Nome de Utilizador / E-mail</label>\r\n          <div className=\"p-col-12 p-md-8\">\r\n            <InputText\r\n              value={username}\r\n              placeholder=\"Nome de Utilizador\"\r\n              onChange={e => setUsername(e.target.value)}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"p-field p-grid\">\r\n          <label className=\"p-col-12 p-md-4\">Palavra-passe</label>\r\n          <div className=\"p-col-12 p-md-8\">\r\n            <Password\r\n              value={password}\r\n              placeholder=\"Palavra-passe\"\r\n              feedback={false}\r\n              onChange={e => setPassword(e.target.value)}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n\r\n      <div className=\"p-dialog-myfooter\">\r\n        <Button \r\n          color='green'\r\n          icon={ auth.loading ? \"pi pi-spin pi-spinner\": \"pi pi-check\" }\r\n          label=\"Entrar\" \r\n          onClick={submit}\r\n          disabled={auth.loading}\r\n        />\r\n      </div>\r\n      \r\n      { auth.http_error && !auth.response &&\r\n        <Message style={{ width: '100%' }} severity=\"error\" text=\"Serviço Indisponível\"></Message>\r\n      }\r\n\r\n      { auth.response && !!auth.response && !!auth.response.message && \r\n        <Message style={{ width: '100%' }} severity=\"error\" text=\"Nome de Utilizador ou Palavra-passe inválido\"></Message>\r\n      }\r\n\r\n    </form>\r\n  )\r\n}\r\n\r\nexport default connect(state => ({ auth: state.auth }))(LoginWidget)","import React, { useContext } from 'react'\r\nimport { withRouter } from 'react-router-dom';\r\nimport LoginWidget from './LoginWidget';\r\nimport AppContext from '../../AppContext';\r\n\r\nfunction PageLogin(props) {\r\n  const { search } = props.location;\r\n  const foundRedirect = /redirect=(.*)/i.exec(search);\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const { CLIENT_URL } = core;\r\n\r\n  // Render page\r\n  const logo = CLIENT_URL + 'assets/images/logo.png';\r\n  return (\r\n    <div id=\"login-page\" className=\"p-d-flex p-jc-center\" style={{ height: '100%' }}>\r\n      <div className=\"p-as-center\" style={{ backgroundColor: 'white', padding: '6rem' }}>\r\n        \r\n        <div className=\"login-logo\">\r\n          <img alt=\"Logo\" src={logo} />  \r\n        </div>\r\n        \r\n        <LoginWidget\r\n          history={props.history}\r\n          redirect={foundRedirect ? foundRedirect[1] : null }\r\n        />\r\n\r\n      </div>\r\n  </div>\r\n  )\r\n}\r\n\r\nexport default withRouter(PageLogin);","import { useEffect } from 'react';\r\nimport { useLocation, withRouter } from 'react-router-dom';\r\n\r\nconst ScrollToTop = (props) => {\r\n\r\n    let location = useLocation();\r\n\r\n    useEffect(() => {\r\n        window.scrollTo(0, 0)\r\n    }, [location]);\r\n\r\n    return props.children;\r\n}\r\n\r\nexport default withRouter(ScrollToTop);","import React, { useContext }  from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport AppContext from '../../AppContext';\r\n\r\nfunction SplashScreen({ history }) {\r\n\r\n  const { core } = useContext(AppContext);\r\n\r\n  const { CLIENT_URL } = core;\r\n\r\n  // Render page\r\n  const logo = CLIENT_URL + 'assets/images/logo-splash.png'\r\n  return (\r\n    <div className=\"p-d-flex p-jc-center\" style={{ height: '100%' }}>\r\n      <div className=\"p-as-center\" style={{ backgroundColor: 'white', padding: '6rem' }}>\r\n\r\n        <div className=\"login-logo\">\r\n          <img alt=\"Logo\" src={logo} />  \r\n        </div>\r\n\r\n        <p>Bem-vindo!</p>\r\n        <p>Para continuar, por favor aceite a nossa política de privacidade.</p>\r\n      </div>\r\n  </div>\r\n  )\r\n}\r\n\r\nexport default withRouter(SplashScreen);","import React, { useState } from 'react';\r\nimport SplashScreen from './SplashScreen';\r\nimport { withCookies } from 'react-cookie';\r\nimport CookieConsent from \"react-cookie-consent\";\r\nimport Cookies from 'universal-cookie';\r\n\r\nconst cookieName = process.env.REACT_APP_COOKIE_NAME || 'websig_dgt_rgpd';\r\nconst cookieValue = process.env.REACT_APP_COOKIE_VALUE || '2';\r\nconst cookiePath = process.env.REACT_APP_COOKIE_PATH || '/';\r\nconst cookieExpiresDays = parseInt(process.env.REACT_APP_COOKIE_EXPIRES_DAYS || '150', 10);\r\n\r\nfunction RGPD({ cookies, children }) {\r\n\r\n  const [cookiergpd, setCookiergpd] = useState(cookies.get(cookieName));\r\n\r\n  function accept() {\r\n    setCookiergpd(cookieValue);\r\n\r\n    // Manually save cookie if using http access\r\n    if (window.location.protocol === 'http:') {\r\n      let expireDate = new Date();\r\n      expireDate.setDate(expireDate.getDate() + parseInt(cookieExpiresDays));\r\n      const cookies = new Cookies();\r\n      cookies.set(cookieName, cookieValue, { path: cookiePath, expires: expireDate, path: cookiePath,\r\n        secure: false, httpOnly: false });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n\r\n      { cookiergpd !== cookieValue && (\r\n        <CookieConsent\r\n          location=\"bottom\"\r\n          buttonText=\"Aceito\"\r\n          cookieName={cookieName}\r\n          cookieValue={cookieValue}\r\n          style={{ background: \"#2B373B\" }}\r\n          buttonStyle={{ color: \"#4e503b\", fontSize: \"13px\" }}\r\n          expires={cookieExpiresDays}\r\n          onAccept={accept}\r\n          extraCookieOptions={{ path: cookiePath }}\r\n          debug={true}\r\n          cookieSecurity={false}\r\n        >\r\n          Este website usa cookies para melhorar a experiência do utilizador\r\n        </CookieConsent>\r\n      ) }\r\n      \r\n      { cookiergpd ? children : <SplashScreen /> }\r\n    </React.Fragment> \r\n  );\r\n} \r\n\r\nexport default withCookies(RGPD);","import React from 'react';\r\nimport Backoffice from './Backoffice';\r\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\r\nimport { Provider } from 'react-redux';\r\nimport Page404 from '../components/Page404';\r\nimport Page401 from '../components/Page401';\r\nimport AppContext, { core } from '../../AppContext';\r\nimport PageLogin from '../components/PageLogin';\r\nimport ScrollToTop from '../components/ScrollToTop';\r\nimport RGPD from '../components/RGPD';\r\nimport { getBackofficeBaseUrl } from '../utils';\r\nimport '../components/index.css';\r\n\r\nconst App = () => {\r\n\r\n    const base_url = getBackofficeBaseUrl();\r\n\r\n    return (\r\n        <React.StrictMode>\r\n            <AppContext.Provider value={{ core }}>\r\n                <Provider store={core.store}>           \r\n                    <Router basename={base_url}>\r\n                        <ScrollToTop>                        \r\n                            <RGPD>\r\n                                <Switch>\r\n                                    <Route path=\"/login\" children={<PageLogin />} />\r\n                                    <Route path=\"/not-found\" children={<Page404 />} />\r\n                                    <Route path=\"/not-allowed\" children={<Page401 />} />\r\n                                    <Route path=\"/\" children={<Backoffice />} />\r\n                                </Switch>\r\n                            </RGPD>\r\n                        </ScrollToTop>\r\n                    </Router>\r\n                </Provider>\r\n            </AppContext.Provider>\r\n        </React.StrictMode>\r\n    );\r\n\r\n}\r\n\r\nexport default App;    ","import 'react-app-polyfill/ie11';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport '@fortawesome/fontawesome-free/css/all.min.css';\nimport App from './core/containers/App';\n//import * as serviceWorker from './serviceWorker';\n//import reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n    <App></App>,\n    document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\n//serviceWorker.unregister();\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n//reportWebVitals();\n"],"sourceRoot":""}